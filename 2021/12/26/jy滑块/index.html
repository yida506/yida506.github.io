



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="菜b的爬虫记录" href="http://yida506.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="菜b的爬虫记录" href="http://yida506.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="菜b的爬虫记录" href="http://yida506.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  

<link rel="canonical" href="http://yida506.github.io/2021/12/26/jy%E6%BB%91%E5%9D%97/">



  <title>
jy滑块 - 验证码专题 |
Yume Shoka = 菜b的爬虫记录</title>
<meta name="generator" content="Hexo 5.4.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">jy滑块
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2021-12-26 13:40:25">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2021-12-26T13:40:25+08:00">2021-12-26</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Yume Shoka</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giph4lm9i7j20zk0m84qp.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipet8c1a2j20zk0m8kct.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipeybxm1pj20zk0m8niv.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicitht3xtj20zk0m8k5v.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipewr8iypj20zk0m8b29.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicliwyw55j20zk0m8hdt.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E9%AA%8C%E8%AF%81%E7%A0%81%E4%B8%93%E9%A2%98/" itemprop="item" rel="index" title="In 验证码专题"><span itemprop="name">验证码专题</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="http://yida506.github.io/2021/12/26/jy%E6%BB%91%E5%9D%97/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="Mr2">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="菜b的爬虫记录">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h3 id="极验滑块："><a href="#极验滑块：" class="headerlink" title="极验滑块："></a>极验滑块：</h3><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZ2VldGVzdC5jb20vZGVtby9zbGlkZS1iaW5kLmh0bWw=">https://www.geetest.com/demo/slide-bind.html</span></p>
<h4 id="登录参数w值"><a href="#登录参数w值" class="headerlink" title="登录参数w值"></a>登录参数w值</h4><p>F12，点击登录，弹出滑块界面，出现滑块图和背景图，拖动滑块，会发送请求：</p>
<p>参数如下:gt\challenge\w\callback(其余的貌似不为加密)</p>
<p>明显，在该请求中生成了这些参数。</p>
<p>跟值，找到生成参数的位置。</p>
<pre><code class="lang-javascript"> u = r[$_CAGEe(750)]()
                  , l = V[$_CAGEe(342)](gt[$_CAGEe(209)](o), r[$_CAGEe(742)]())
                  , h = m[$_CAGEe(733)](l)
                  , f = &#123;
                    &quot;\u0067\u0074&quot;: i[$_CAGEe(147)],
                    &quot;\u0063\u0068\u0061\u006c\u006c\u0065\u006e\u0067\u0065&quot;: i[$_CAGDp(154)],
                    &quot;\u006c\u0061\u006e\u0067&quot;: o[$_CAGDp(119)],
                    &quot;\u0024\u005f\u0042\u0042\u0046&quot;: r[$_CAGEe(623)],
                    &quot;\u0063\u006c\u0069\u0065\u006e\u0074\u005f\u0074\u0079\u0070\u0065&quot;: r[$_CAGEe(648)],
                    &quot;\u0077&quot;: h + u
                &#125;;
</code></pre>
<p> “\u0077”：为所需的w值。</p>
<p>下面就需要去寻找其生成逻辑，可以直观的看到，其是由h,u拼接而成的。</p>
<p>接下来就需要分析u、l、h的逻辑即可。</p>
<blockquote>
<p>首先明确一个观点，这里一定有一个值为定值，因为滑块拖动的轨迹是一定的</p>
</blockquote>
<h5 id="u值"><a href="#u值" class="headerlink" title="u值"></a>u值</h5><pre><code class="lang-javascript"> u = r[$_CAGEe(750)]()
</code></pre>
<p>u运行了一个函数，未传参数进去、直接自执行。经过测试，发现其不为定值。</p>
<p>内部逻辑：</p>
<pre><code class="lang-javascript"> function(t) &#123;
                var $_CBEDU = lTloj.$_CX
                  , $_CBECg = [&#39;$_CBEGr&#39;].concat($_CBEDU)
                  , $_CBEEc = $_CBECg[1];
                $_CBECg.shift();
                var $_CBEFV = $_CBECg[0];
     //前面属于初始化的步骤
                var e = new X()[$_CBEEc(342)](this[$_CBEEc(742)](t));
                while (!e || 256 !== e[$_CBEEc(182)])
                    e = new X()[$_CBEDU(342)](this[$_CBEDU(742)](!0));
                return e;
            &#125;
$_CBEEc(342) = &#39;encrypt&#39;;

this[$_CBEEc(742)] = (Ot = rt(),
            function(t) &#123;
                var $_CBDIs = lTloj.$_CX
                  , $_CBDHp = [&#39;$_CBEBa&#39;].concat($_CBDIs)
                  , $_CBDJA = $_CBDHp[1];
                $_CBDHp.shift();
                var $_CBEAd = $_CBDHp[0];
                return !0 === t &amp;&amp; (Ot = rt()),
                Ot;
            &#125;
            )


var rt = function() &#123;
            //初始化操作
            var $_BFBDL = lTloj.$_CX
              , $_BFBCi = [&#39;$_BFBGO&#39;].concat($_BFBDL)
              , $_BFBEt = $_BFBCi[1];
            $_BFBCi.shift();
            var $_BFBFk = $_BFBCi[0];

            function t() &#123;
                var $_DBFAh = lTloj.$_DP()[0][4];
                for (; $_DBFAh !== lTloj.$_DP()[2][3]; ) &#123;
                    switch ($_DBFAh) &#123;
                    case lTloj.$_DP()[0][4]:
                        return (65536 * (1 + Math[$_BFBDL(75)]()) | 0)[$_BFBDL(396)](16)[$_BFBDL(476)](1);
                        break;
                    &#125;
                &#125;
            &#125;
            return function() &#123;

                var $_BFBIl = lTloj.$_CX
                  , $_BFBHs = [&#39;$_BFCBY&#39;].concat($_BFBIl)
                  , $_BFBJq = $_BFBHs[1];
                $_BFBHs.shift();
                var $_BFCAQ = $_BFBHs[0];


                return t() + t() + t() + t();
            &#125;
            ;
        &#125;();

t = (65536 * (1 + Math[&#39;random&#39;]()) | 0)[&#39;toString&#39;](16)[&#39;substring&#39;](1)
</code></pre>
<p>首先运行了rt函数，接着看rt函数内部，内部包含两次初始化操作，貌似没啥用。我们可以看到其中真实的返回值为4个t()函数运行之和，那么接着我们只需要分析t函数即可，</p>
<p>本质上t其实是先通过random了一个随机数，然后位运算，在经过toString、substring将其转化为一个4位字符、接着4次拼接，就生成了16位随机字符。</p>
<p>接下来，就就可以还原成如下形式：</p>
<pre><code class="lang-javascript">var decode_u = function()&#123;return (65536 * (1 + Math[&#39;random&#39;]()) | 0)[&#39;toString&#39;](16)[&#39;substring&#39;](1)&#125;;
var u_decode = decode_u() + decode_u() + decode_u() + decode_u();
</code></pre>
<p>接下来再看e的整体部分</p>
<pre><code class="lang-javascript">//$_CBEEc(342) = &#39;encrypt&#39;;
var e = new X()[$_CBEEc(342)](this[$_CBEEc(742)](t));
 while (!e || 256 !== e[$_CBEEc(182)])
                    e = new X()[$_CBEDU(342)](this[$_CBEDU(742)](!0));
 return e;

//还原e
var e = new X()[&#39;encrypt&#39;](u_decode);
</code></pre>
<p>while那部分e貌似经过调试也不经过那里，因此可以不用管，将e简单的还原，明显，我们只需要知道这个X()是啥不就行了吗，从字面意思上来看，就是对随机的u_decode的一个加密操作，跟进去：</p>
<pre><code class="lang-javascript">function E() &#123;
                var $_DBDBL = lTloj.$_DP()[2][4];
                for (; $_DBDBL !== lTloj.$_DP()[2][3]; ) &#123;
                    switch ($_DBDBL) &#123;
                    case lTloj.$_DP()[0][4]:
                        this[$_HHJn(310)] = null,
                        this[$_HHJn(319)] = 0,
                        this[$_HHIO(392)] = null,
                        this[$_HHIO(365)] = null,
                        this[$_HHJn(352)] = null,
                        this[$_HHJn(358)] = null,
                        this[$_HHIO(395)] = null,
                        this[$_HHIO(329)] = null;
                        //$_HHIO(349) = &#39;setpublic&#39;
                        this[$_HHIO(349)]($_HHJn(370), $_HHIO(354));
                        $_DBDBL = lTloj.$_DP()[2][3];
                        break;
                    &#125;
                &#125;
            &#125;
// E[&#39;prototype&#39;][&#39;setpublic&#39;]
E[$_HHJn(261)][$_HHIO(349)] = function ut(t, e) &#123;
                var $_JIId = lTloj.$_CX
                  , $_JIHf = [&#39;$_JJBk&#39;].concat($_JIId)
                  , $_JIJy = $_JIHf[1];
                $_JIHf.shift();
                var $_JJAX = $_JIHf[0];
                null != t &amp;&amp; null != e &amp;&amp; 0 &lt; t[$_JIJy(182)] &amp;&amp; 0 &lt; e[$_JIId(182)] ? (this[$_JIId(310)] = function n(t, e) &#123;
                    var $_JJDX = lTloj.$_CX
                      , $_JJCE = [&#39;$_JJGq&#39;].concat($_JJDX)
                      , $_JJEo = $_JJCE[1];
                    $_JJCE.shift();
                    var $_JJFy = $_JJCE[0];
                    return new y(t,e);
                &#125;(t, 16),
                this[$_JIJy(319)] = parseInt(e, 16)) : console &amp;&amp; console[$_JIJy(6)] &amp;&amp; console[$_JIId(6)]($_JIId(348));
            &#125;



// E[&#39;prototype&#39;][&#39;encrypt&#39;]
E[$_HHIO(261)][$_HHJn(342)] = function lt(t) &#123;
                var $_JJI_ = lTloj.$_CX
                  , $_JJHt = [&#39;$_BAABI&#39;].concat($_JJI_)
                  , $_JJJB = $_JJHt[1];
                $_JJHt.shift();
                var $_BAAAC = $_JJHt[0];
                var e = function a(t, e) &#123;
                    var $_BAADI = lTloj.$_CX
                      , $_BAACi = [&#39;$_BAAGL&#39;].concat($_BAADI)
                      , $_BAAEP = $_BAACi[1];
                    $_BAACi.shift();
                    var $_BAAFA = $_BAACi[0];
                    if (e &lt; t[$_BAAEP(182)] + 11)
                        return console &amp;&amp; console[$_BAADI(6)] &amp;&amp; console[$_BAADI(6)]($_BAADI(312)),
                        null;
                    var n = []
                      , r = t[$_BAADI(182)] - 1;
                    while (0 &lt;= r &amp;&amp; 0 &lt; e) &#123;
                        var i = t[$_BAADI(137)](r--);
                        i &lt; 128 ? n[--e] = i : 127 &lt; i &amp;&amp; i &lt; 2048 ? (n[--e] = 63 &amp; i | 128,
                        n[--e] = i &gt;&gt; 6 | 192) : (n[--e] = 63 &amp; i | 128,
                        n[--e] = i &gt;&gt; 6 &amp; 63 | 128,
                        n[--e] = i &gt;&gt; 12 | 224);
                    &#125;
                    n[--e] = 0;
                    var o = new l()
                      , s = [];
                    while (2 &lt; e) &#123;
                        s[0] = 0;
                        while (0 == s[0])
                            o[$_BAADI(276)](s);
                        n[--e] = s[0];
                    &#125;
                    return n[--e] = 2,
                    n[--e] = 0,
                    new y(n);
                &#125;(t, this[$_JJJB(310)][$_JJI_(353)]() + 7 &gt;&gt; 3);
                if (null == e)
                    return null;
                var n = this[$_JJJB(388)](e);
                if (null == n)
                    return null;
                var r = n[$_JJJB(396)](16);
                return 0 == (1 &amp; r[$_JJJB(182)]) ? r : $_JJJB(44) + r;
            &#125;
</code></pre>
<p>总的来说，对于u值的生成有如下几步：</p>
<ol>
<li>首先new 一个X对象，其中X指向E()。</li>
<li>在new的时候，首先获取两个定参数，然后根据两个定参数设置一个public。</li>
<li>接着调用原型链上的encrypt方法，同时传入了一个16位的随机数。</li>
<li>最后生成256位结果。</li>
</ol>
<h5 id="l值"><a href="#l值" class="headerlink" title="l值"></a>l值</h5><pre><code class="lang-javascript">l = V[&quot;encrypt&quot;](gt[&quot;stringify&quot;](o), r[&quot;$_CBFG&quot;]()),
//手动还原
r[&quot;$_CBFG&quot;]() 
//这个会生成一个值,每次刷新都不一样，伪动态，同时跟进去分析发现,这个值其实返回的就是一个一开始初始化的值，逻辑就是u值的Ot,可改写为u_decode。
//gt[&quot;stringify&quot;](o)这一部分会返回一个对象，
</code></pre>
<p>通过对比可以发现o，传入了一系列参数，这也是导致两次运行结果不一致的主要原因，其中最后生成的rp也是一个不一致的参数。</p>
<p>那么我们主要分析点就是o是如何生成的。</p>
<pre><code class="lang-javascript">r = this,
i = r[&quot;$_CIY&quot;],
o = &#123;
          &quot;lang&quot;: i[&quot;lang&quot;] || &quot;zh-cn&quot;,
          &quot;userresponse&quot;: H(t, i[&quot;challenge&quot;]),
          &quot;passtime&quot;: n,
          &quot;imgload&quot;: r[&quot;$_BJHF&quot;],
          &quot;aa&quot;: e,
          &quot;ep&quot;: r[&quot;$_CBD_&quot;]()
        &#125;;
</code></pre>
<p>在这部分中，我们可以看到，使用了n、e、t这三个传进来的参数，貌似看起来和鼠标轨迹有关。</p>
<pre><code class="lang-javascript"> &quot;$_CGHV&quot;: function (t, e) &#123;
        var n = this,
            r = n[&quot;$_BAHt&quot;],
            i = n[&quot;$_BBGR&quot;],
            o = n[&quot;$_CIY&quot;],
            s = n[&quot;$&quot;];

        try &#123;
          if (i[&quot;$_HA_&quot;]() !== $t) return;
          if (n[&quot;$_CHHW&quot;] &amp;&amp; &quot;pointerup&quot; != t[&quot;type&quot;]) return;
          v(function () &#123;
            o[&quot;link&quot;] &amp;&amp; s(&quot;.link&quot;)[&quot;$_CBV&quot;](&#123;
              &quot;target&quot;: &quot;_blank&quot;,
              &quot;href&quot;: o[&quot;link&quot;]
            &#125;);
          &#125;, 0), t[&quot;$_BGDK&quot;](), i[&quot;$_GJD&quot;](&quot;lock&quot;);
        //u生成的位置
          var a = n[&quot;$_CFDP&quot;],
              _ = e ? n[&quot;lastPoint&quot;][&quot;x&quot;] : t[&quot;$_BGBX&quot;]() / a - n[&quot;$_CHJg&quot;],
              c = e ? n[&quot;lastPoint&quot;][&quot;y&quot;] : n[&quot;$_CIAc&quot;] - t[&quot;$_BGCq&quot;]() / a;

          n[&quot;$_CECK&quot;] = $_HP() - n[&quot;$_CHIF&quot;], n[&quot;$_CIBw&quot;][&quot;$_BBBF&quot;]([Math[&quot;round&quot;](_), Math[&quot;round&quot;](c), n[&quot;$_CECK&quot;]]);
          var u = parseInt(_),
              l = n[&quot;$_CIBw&quot;][&quot;$_BBCA&quot;](n[&quot;$_CIBw&quot;][&quot;$_GEy&quot;](), n[&quot;$_CIY&quot;][&quot;c&quot;], n[&quot;$_CIY&quot;][&quot;s&quot;]);
          r[&quot;$_CBCM&quot;](u, l, n[&quot;$_CECK&quot;]), n[&quot;$_CFGp&quot;][&quot;$_EFJ&quot;]();
        &#125; catch (t) &#123;
          r[&quot;$_DAK&quot;](t);
        &#125;
</code></pre>
<p>在这里n、e、t分别对应u、l、n[“$_CECK”]，通过调试可以发现这三个估计分别对应距离、轨迹、时间。</p>
<h6 id="小u"><a href="#小u" class="headerlink" title="小u:"></a>小u:</h6><p>这里的小u向上看，由于传进来的e为undefined，所以这里的流程只走向了后面一部分，同时，通过对滑块添加pointermove事件发现，这里的t[“$_BGBX”]为滑块停止的位置，在经过反复调试后，貌似a是个可以写死的东西，最后一项为初始位置，基本上该部分就是计算了一下偏移路径。</p>
<h6 id="小l："><a href="#小l：" class="headerlink" title="小l："></a>小l：</h6><p>根据分析可知，该部分由一个函数传入了三个参数构成，后面两个参数为服务器返回，第一个参数为一个三维数组，第一维为一个x轴偏移，第二个为y轴偏移，第三个为时间戳偏移。</p>
<h6 id="n-“-CECK”"><a href="#n-“-CECK”" class="headerlink" title="n[“$_CECK”]:"></a>n[“$_CECK”]:</h6><p>这项就是个时间戳之差，用结束时间戳减去开始的时间戳。</p>
<h6 id="V-“encrypt”"><a href="#V-“encrypt”" class="headerlink" title="V[“encrypt”]"></a>V[“encrypt”]</h6><p>这部分可以直接导出。</p>
<h5 id="h值"><a href="#h值" class="headerlink" title="h值"></a>h值</h5><pre><code class="lang-javascript">h = m[&quot;$_GFm&quot;](l);
&quot;$_GFm&quot;: function (t) &#123;
        var e = this[&quot;$_GDR&quot;](t);
        return e[&quot;res&quot;] + e[&quot;end&quot;];
&#125;,
</code></pre>
<p>这部分也可直接导出。</p>
<h5 id="AST解混淆"><a href="#AST解混淆" class="headerlink" title="AST解混淆"></a>AST解混淆</h5><p>观察代码，我们可以发现，存在大量混淆，增加了阅读难度，所以首先使用AST解混淆。</p>
<p>将代码放入在线网站解析，发现分为6块。</p>
<ol>
<li>ExpressionStatement    </li>
<li>ExpressionStatement</li>
<li>ExpressionStatement</li>
<li>ExpressionStatement</li>
<li>FunctionDeclaration</li>
<li>ExpressionStatement</li>
</ol>
<blockquote>
<p>其中前四部分可以看作解密函数，第五部分可以看做一个类似声明对象的过程。与之前解的OB混淆原理不太一样，这里面采用了大量的重赋值操作。</p>
</blockquote>
<pre><code class="lang-javascript"> var $_DBIV = lTloj.$_CX
, $_DBHX = [&#39;$_DCBv&#39;].concat($_DBIV)
, $_DBJB = $_DBHX[1];
$_DBHX.shift();
var $_DCAU = $_DBHX[0];
</code></pre>
<p>我们可以看到，其显示通过一个变量修饰器，将一个解密函数赋值过来，然后通过数组拼合的方式生成了一个新数组，再通过数组取值的操作，将其中的值取出来，接着对数组首元素进行去除，在取值。</p>
<p>简单来讲，就是把解密函数赋值过去，数组一开始携带的参数貌似没什么用。</p>
<h6 id="STEP1-ASCII码还原"><a href="#STEP1-ASCII码还原" class="headerlink" title="STEP1 ASCII码还原:"></a>STEP1 ASCII码还原:</h6><p>ASCII码还原，增加可读性，没啥好讲的。</p>
<h6 id="STEP2-解密函数部分还原"><a href="#STEP2-解密函数部分还原" class="headerlink" title="STEP2 解密函数部分还原:"></a>STEP2 解密函数部分还原:</h6><p>由于在后面中，存在变量声明调用解密函数的过程，这里为了方便先直接进行一部分替换。</p>
<p>通过分析我们可以知道，第三个和第四个解密函数，才为真正的解密函数，因为在后续的代码中，很大一部分都是通过该部分才进行了操作，那么我们只需要遍历MemberExpression节点，同时限制其父节点为声明表达式即可将遍历条件限定在前几个，然后通过遍历作用域，将有变量赋值的部分替换。</p>
<pre><code class="lang-javascript">/* 
a.b = function()&#123;return val&#125;;
var c = a.b;
转化为
a.b = function()&#123;return val&#125;;
var c = function()&#123;return val&#125;;
*/
const visitor1 =  &#123;
     MemberExpression(path)&#123;
        const &#123;object,property&#125; = path.node;
        const &#123;scope&#125; = path;
        var func_name = object.name,pro_name = property.name;
        //只遍历声明式的部分,防止反复调用
        if(!types.isAssignmentExpression(path.parent)) return;
        if(func_name !== func_all) return;
        path.scope.traverse(path.scope.block, &#123;
            MemberExpression(_path)&#123;
                if(_path.node.object.name === func_name &amp;&amp; _path.node.property.name === property.name)&#123;
                    //对于变量赋值
                    if(types.isVariableDeclarator(_path.parent))&#123;
                        _path.replaceInline(path.parent.right);
                    &#125;;
                &#125;
            &#125;
        &#125;);
    &#125;
&#125;;
</code></pre>
<blockquote>
<p>这一步主要是为后一步生成数组做铺垫。</p>
</blockquote>
<h6 id="STEP3-解密函数内存写入"><a href="#STEP3-解密函数内存写入" class="headerlink" title="STEP3 解密函数内存写入:"></a>STEP3 解密函数内存写入:</h6><p>紧接着我们将前5部分全部压入内存中，这样的好处就是后面在有调用的部分处，可以直接通过eval结合解密函数运行出值，直接用于替换。</p>
<pre><code class="lang-javascript">//解密函数对象昵称
let descrypt_strfun_js = &#39;&#39;;
for(let i=0;i&lt;=4;i++)&#123;
    //加入代码
    descrypt_strfun_js += generator(ast_code.program.body[i], &#123;compact:true&#125;).code
    delete ast_code.program.body[i]
&#125;
// 运行数组
eval(descrypt_strfun_js);
</code></pre>
<h6 id="STEP4-赋值表达式替换"><a href="#STEP4-赋值表达式替换" class="headerlink" title="STEP4 赋值表达式替换:"></a>STEP4 赋值表达式替换:</h6><p>由于后续的针对数组变化的插件需要能将数组写入内存中，而concat部分又包含了数组的调用，所以我们要将该部分还原成其原型。</p>
<pre><code class="lang-javascript">/* 
var b = function()&#123;return arguments&#125;;
var a = [&#39;as&#39;].concat(b)
还原后
var a = [&#39;as&#39;].concat(function()&#123;return arguments&#125;)
*/
const var_visitor  = &#123;
    //查找赋值表达式
    VariableDeclarator(path) &#123;
        const &#123;id, init&#125; = path.node;
        var binding = path.scope.getBinding(id.name);
        references = binding.referencePaths;
        if(!types.isFunctionExpression(init) || init.body.body.length !== 1) return;
        for(reference of references)&#123;
            if(reference.parentPath.toString().indexOf(&#39;concat&#39;) &gt; -1)&#123;
                reference.replaceInline(init);
            &#125;
        &#125;;
    &#125;
&#125;;
</code></pre>
<h6 id="STEP-5-数组还原-临时变量还原："><a href="#STEP-5-数组还原-临时变量还原：" class="headerlink" title="STEP 5 数组还原 + 临时变量还原："></a>STEP 5 数组还原 + 临时变量还原：</h6><p>该部分就是对先前提到的数组进行的还原，临时变量其实指代的也是解密函数。</p>
<pre><code class="lang-javascript">//变量替换
const arr_change_visitor = &#123;
    //数组替换
    VariableDeclarator(path) &#123;
        const &#123;id, init&#125; = path.node;
        var func_name = id.name;
        var binding = path.scope.getBinding(func_name);
        var referpaths = binding.referencePaths;
        //如果变量没引用,则返回
        if (referpaths.length === 0) return;
        //保证变量的init部分值唯一，数字、字符类型直接替换,函数定义也可直接替换，前提是引用部分为单引用，若为函数调用，可考虑直接计算值。
        //单独针对这种情况,不考虑单纯的数组。
        if (types.isCallExpression(init) &amp;&amp; types.isArrayExpression(init.callee.object)) &#123;
            //将数组中的内容直接写入内存
            if(init.callee.property.name !== &#39;concat&#39;) return;
            var old_arr = init.callee.object.elements.concat(init.arguments[0]);
            global[func_name] = old_arr;
            // 遍历作用域,获取修改值的地址
            binding.scope.traverse(binding.scope.block, &#123;
                MemberExpression(_path) &#123;
                    //后面可能还要确保只修改一次的情况
                    // console.log(_path.toString());
                    if(_path.node.object.name !== func_name) return;
                    if (_path.node.property.value &gt;= 0) &#123;
                        let index_value = _path.node.property.value;
                        _path.replaceInline(global[func_name][index_value]);
                    &#125;;
                    //若包含shift操作
                    if (_path.node.property &amp;&amp; _path.node.property.name === &#39;shift&#39;) &#123;
                        global[func_name].shift()
                    &#125;
                &#125;
            &#125;);
            path.remove();
        &#125;
    &#125;
&#125;;

//这部分主要是通过将还原后的部分写入内存，在遍历，接着对包含shift()的代码删除，由于该部分的解密体为函数，所以遍历的是CallExpression节点。
const var_write = &#123;
    VariableDeclarator(path)&#123;
        const &#123;id,init&#125; = path.node;
        var binding = path.scope.getBinding(id.name);
        references = binding.referencePaths;
        if(!types.isFunctionExpression(init) || init.body.body.length !== 1) return;
        eval(path.toString());
        path.scope.traverse(path.scope.block,&#123;
            CallExpression(_path) &#123;
                if(_path.node.callee.name === id.name)&#123;
                 _path.replaceInline(types.valueToNode(eval(_path.toString())));
            &#125;;
        &#125;
        &#125;);
        //遍历替换结束,删除原节点
        path.remove();
        &#125;,
    MemberExpression(path)&#123;
        const &#123;object,property&#125; = path.node;
        if(property.name !== &#39;shift&#39;) return;
        path.parentPath.remove();
    &#125;

&#125;;
</code></pre>
<h6 id="STEP-6-解密函数批量还原"><a href="#STEP-6-解密函数批量还原" class="headerlink" title="STEP 6 解密函数批量还原"></a>STEP 6 解密函数批量还原</h6><p>到了这一步，将解密函数全部运行替换即可。</p>
<pre><code class="lang-javascript">var visitor_sec = &#123;
    //遍历call节点,将内存中的函数直接计算
    CallExpression(path)&#123;
        const &#123;callee,arguments&#125; = path.node;
        //如果于内存中存在
        if(callee.object &amp;&amp; global[callee.object.name] &amp;&amp; global[callee.object.name][callee.property.name])&#123;
            if(arguments.length&gt;0)&#123;
            path.replaceInline(types.valueToNode(eval(path.toString())));
            &#125;
            else if(arguments.length === 0)&#123;
                //由于该处的数组是个无限递归，推测该部分应该只是一个用于比较的逻辑，即判断数组下标即可。
                if(types.isMemberExpression(path.parent) &amp;&amp;types.isMemberExpression(path.parentPath.parent))&#123;
                    // var args1 = path.parent.property.value,args2 = path.parentPath.parent.prototype.value;
                    //console.log(path.parentPath.parentPath.toString());
                    //path.replaceInline(types.valueToNode(eval(path.parentPath.parentPath.toString())))
                &#125;

            &#125;
        &#125;
    &#125;
&#125;
</code></pre>
<h6 id="STEP-7-控制流平坦化："><a href="#STEP-7-控制流平坦化：" class="headerlink" title="STEP 7 控制流平坦化："></a>STEP 7 控制流平坦化：</h6><p>通过上述步骤,已经将代码还原到了一个可以阅读的程度了，但是在整体的代码中还包含着一个及其特殊的部分。</p>
<pre><code class="lang-javascript">function $_BFf(t) &#123;
      var $_DAIEJ = lTloj.$_DP()[0][4];

      for (; $_DAIEJ !== lTloj.$_DP()[2][3];) &#123;
        switch ($_DAIEJ) &#123;
          case lTloj.$_DP()[2][4]:
            return &#123;
              &quot;.popup_ghost&quot;: &#123;&#125;,
              &quot;.popup_box&quot;: &#123;
                &quot;.popup_header&quot;: &#123;
                  &quot;span.popup_tip&quot;: &#123;&#125;,
                  &quot;span.popup_close&quot;: &#123;&#125;
                &#125;,
                &quot;.popup_wrap&quot;: t
              &#125;
            &#125;;
            break;
        &#125;
      &#125;
    &#125;
</code></pre>
<p>由于lTloj.$_DP()这个解密函数解出来是一个无限套娃的玩意，同时，我们可以看到，其在代码流程中好像除了做判断，就没啥用了，也就是说，对于上述函数的流程中，我们只需要关注 case中的那一部分即可，因为for循环貌似给整体加上了个无限循环，但是有return的话，就直接跳出去了。</p>
<blockquote>
<p>其实还原到这一步了，代码的可读性已经很大程度提高了，其检测了什么环境已经一目了然，接下来就是去补环境了。</p>
</blockquote>
<h5 id="canvas"><a href="#canvas" class="headerlink" title="canvas"></a>canvas</h5><p>canvas为画布，在过验证码的过程中，我们发现服务器没返回图片，而是返回了两张webp格式的散乱图，也就是说，在代码中一定存在操作，使得返回的散乱图拼合成一个完整的图片，那么我们首先要做的就是找到其生成参数的位置。</p>
<blockquote>
<p>在该例中图片的格式为312*160</p>
</blockquote>
<h6 id="STEP1-观察图片生成原理"><a href="#STEP1-观察图片生成原理" class="headerlink" title="STEP1 观察图片生成原理:"></a>STEP1 观察图片生成原理:</h6><p>在事件断点中打上canvas断点，调试，发现该位置貌似是生成参数的位置，观察l发现，其width = 10、height = 80，我们将其webp格式的图片打开可以发现，其是将图片划分为了两层，也就是说，这里的操作实际上是对一个52块的图片进行一个拼合，而且这里也只循环了52次，接下来只需要搞清楚里面在干什么就能对整体进行还原了。</p>
<pre><code class="lang-javascript">   for (var a = r / 2, _ = 0; _ &lt; 52; _ += 1) &#123;
                           //这里应该是确定图片位置
                        var c = Ut[_] % 26 * 12 + 1
                          , u = 25 &lt; Ut[_] ? a : 0
                          , l = o[$_CJET(69)](c, u, 10, a);
                           //这里是拼图的过程
                        s[$_CJET(66)](l, _ % 26 * 10, 25 &lt; _ ? a : 0);
                    &#125;
</code></pre>
<p>目前思路是，先拼上面的26张，在拼下面的26张，这里的l是将分割的图片一个个展示在画布上，c是x轴坐标，u是y轴坐标，a为y轴高度。</p>
<p>也就是说我们只需要将图片分割后，一快快的按顺序拼起来即可。</p>
<blockquote>
<p>这里每一小块的大小为12 <em> 80 然后在展示的时候只展示了 10 </em> 80的大小，最后拼成一张 260 * 160的图片，其中展示的顺序与传入的那个数组一样，数组中的值为其对应的位置，左上角为0，然后26代表从左下角开始。</p>
</blockquote>
<pre><code class="lang-python">//a 为传入的大数组
new_img = Image.new(&#39;RGB&#39;, (260, 160))
for idx in range(len(a)):
    #获取当前位置的真实图的区域
    x = _Ge[idx] % 26 * 12 + 1
    y = h_sep if a[idx] &gt; 25 else 0
    #图像裁剪
    img_cut = _img.crop((x, y, x + w_sep, y + h_sep))
       new_x = idx % 26 * 10
    new_y = h_sep if idx &gt; 25 else 0
    #将真实图回填
    new_img.paste(img_cut, (new_x, new_y))
</code></pre>
<h6 id="STEP2-缺口识别："><a href="#STEP2-缺口识别：" class="headerlink" title="STEP2 缺口识别："></a>STEP2 缺口识别：</h6><p>原理上是通过检测二值化的边界，与滑块图进行比对(代码来源网上)。</p>
<pre><code class="lang-python">def show(name):
    &#39;&#39;&#39;展示圈出来的位置&#39;&#39;&#39;
    cv2.imshow(&#39;Show&#39;, name)
    cv2.waitKey(0)
    cv2.destroyAllWindows()


def _tran_canny(image):
    &quot;&quot;&quot;消除噪声&quot;&quot;&quot;
    image = cv2.GaussianBlur(image, (3, 3), 0)
    return cv2.Canny(image, 50, 150)


def detect_displacement(img_slider_path, image_background_path):
    &quot;&quot;&quot;detect displacement
        params: img_slider_path 滑块图片
        parmas: image_background_path 带缺口的滑块图片
    &quot;&quot;&quot;
    # # 参数0是灰度模式
    image = cv2.imread(img_slider_path, 0)
    template = cv2.imread(image_background_path, 0)

    # 寻找最佳匹配
    res = cv2.matchTemplate(_tran_canny(image), _tran_canny(template), cv2.TM_CCOEFF_NORMED)
    # 最小值，最大值，并得到最小值, 最大值的索引
    min_val, max_val, min_loc, max_loc = cv2.minMaxLoc(res)
    top_left = max_loc[0]  # 横坐标
    # 展示圈出来的区域
    x, y = max_loc  # 获取x,y位置坐标

    w, h = image.shape[::-1]  # 宽高
    cv2.rectangle(template, (x, y), (x + w, y + h), (255, 0, 0), 2)
    show(template)
    return top_left


top_left = detect_displacement(&quot;b.png&quot;, &quot;a.jpg&quot;)
</code></pre>
<h6 id="STEP3-轨迹模拟："><a href="#STEP3-轨迹模拟：" class="headerlink" title="STEP3 轨迹模拟："></a>STEP3 轨迹模拟：</h6><p>通过随机数，模拟轨迹。</p>
<pre><code class="lang-python">def get_random_arr(num):
    &#39;&#39;&#39;
    :param num: 图片的路径差
    :return: 三维数组,x轴,y轴,时间戳
    &#39;&#39;&#39;
    x_arr = [-50]
    y_arr = [-10]
    time_arr = [0]
    i = 0
    temp_x = 0
    temp_y = 0
    temp_time = 0
    while (num-i &gt; 0):
        temp_x += random.randint(1,5)
        temp_y += 0
        temp_time += random.randint(20,50)
        x_arr.append(temp_x)
        y_arr.append(temp_y)
        time_arr.append(temp_time)
        i += temp_x
    result = [[x_arr[i],y_arr[i],time_arr[i]] for i in range(len(x_arr))]
    return result
</code></pre>
<h4 id="初始化页面w值"><a href="#初始化页面w值" class="headerlink" title="初始化页面w值"></a>初始化页面w值</h4><h5 id="加密逻辑"><a href="#加密逻辑" class="headerlink" title="加密逻辑"></a>加密逻辑</h5><p>咋分析页面的时候，我们发现，整体的流程如下：</p>
<p>首先访问页面，初始化，生成一个随机数，随机数生成gt、challage两个参数，然后通过fullpage.js生成w值，接着传入w、gt、challage获取一串json(包含初始化以及返回的验证码图片)，接着拖动滑块在在在slider.js中获取轨迹参数w，最终通过校验。</p>
<p>页面初始化的逻辑只有l值不同，因为它传进去的不是轨迹，而是一系列参数。</p>
<h5 id="参数分析"><a href="#参数分析" class="headerlink" title="参数分析"></a>参数分析</h5><p>逻辑与上面类似。</p>
<h4 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h4>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2022-01-22 00:10:43" itemprop="dateModified" datetime="2022-01-22T00:10:43+08:00">2022-01-22</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> Donate</button>
  <p>Give me a cup of [coffee]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="Mr2 WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="Mr2 Alipay">
        <p>Alipay</p>
      </div>
      
      <div>
        <img data-src="/images/paypal.png" alt="Mr2 PayPal">
        <p>PayPal</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>Post author:  </strong>Mr2 <i class="ic i-at"><em>@</em></i>菜b的爬虫记录
  </li>
  <li class="link">
    <strong>Post link: </strong>
    <a href="http://yida506.github.io/2021/12/26/jy%E6%BB%91%E5%9D%97/" title="jy滑块">http://yida506.github.io/2021/12/26/jy滑块/</a>
  </li>
  <li class="license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2021/12/18/%E8%A1%A5%E7%8E%AF%E5%A2%83/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclfw2t96j20zk0m8x6p.jpg" title="补环境">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> JS逆向</span>
  <h3>补环境</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2021/12/28/%E5%8F%8D%E8%B0%83%E8%AF%95/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipevarprfj20zk0m8npd.jpg" title="反调试">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> JS逆向</span>
  <h3>反调试</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%EF%BC%9A"><span class="toc-number">1.</span> <span class="toc-text">极验滑块：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E5%8F%82%E6%95%B0w%E5%80%BC"><span class="toc-number">1.1.</span> <span class="toc-text">登录参数w值</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#u%E5%80%BC"><span class="toc-number">1.1.1.</span> <span class="toc-text">u值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#l%E5%80%BC"><span class="toc-number">1.1.2.</span> <span class="toc-text">l值</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B0%8Fu"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">小u:</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B0%8Fl%EF%BC%9A"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">小l：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#n-%E2%80%9C-CECK%E2%80%9D"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">n[“$_CECK”]:</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#V-%E2%80%9Cencrypt%E2%80%9D"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">V[“encrypt”]</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#h%E5%80%BC"><span class="toc-number">1.1.3.</span> <span class="toc-text">h值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#AST%E8%A7%A3%E6%B7%B7%E6%B7%86"><span class="toc-number">1.1.4.</span> <span class="toc-text">AST解混淆</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#STEP1-ASCII%E7%A0%81%E8%BF%98%E5%8E%9F"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">STEP1 ASCII码还原:</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#STEP2-%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0%E9%83%A8%E5%88%86%E8%BF%98%E5%8E%9F"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">STEP2 解密函数部分还原:</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#STEP3-%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0%E5%86%85%E5%AD%98%E5%86%99%E5%85%A5"><span class="toc-number">1.1.4.3.</span> <span class="toc-text">STEP3 解密函数内存写入:</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#STEP4-%E8%B5%8B%E5%80%BC%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%9B%BF%E6%8D%A2"><span class="toc-number">1.1.4.4.</span> <span class="toc-text">STEP4 赋值表达式替换:</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#STEP-5-%E6%95%B0%E7%BB%84%E8%BF%98%E5%8E%9F-%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F%E8%BF%98%E5%8E%9F%EF%BC%9A"><span class="toc-number">1.1.4.5.</span> <span class="toc-text">STEP 5 数组还原 + 临时变量还原：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#STEP-6-%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0%E6%89%B9%E9%87%8F%E8%BF%98%E5%8E%9F"><span class="toc-number">1.1.4.6.</span> <span class="toc-text">STEP 6 解密函数批量还原</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#STEP-7-%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96%EF%BC%9A"><span class="toc-number">1.1.4.7.</span> <span class="toc-text">STEP 7 控制流平坦化：</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#canvas"><span class="toc-number">1.1.5.</span> <span class="toc-text">canvas</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#STEP1-%E8%A7%82%E5%AF%9F%E5%9B%BE%E7%89%87%E7%94%9F%E6%88%90%E5%8E%9F%E7%90%86"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">STEP1 观察图片生成原理:</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#STEP2-%E7%BC%BA%E5%8F%A3%E8%AF%86%E5%88%AB%EF%BC%9A"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">STEP2 缺口识别：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#STEP3-%E8%BD%A8%E8%BF%B9%E6%A8%A1%E6%8B%9F%EF%BC%9A"><span class="toc-number">1.1.5.3.</span> <span class="toc-text">STEP3 轨迹模拟：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B5%E9%9D%A2w%E5%80%BC"><span class="toc-number">1.2.</span> <span class="toc-text">初始化页面w值</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E9%80%BB%E8%BE%91"><span class="toc-number">1.2.1.</span> <span class="toc-text">加密逻辑</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E5%88%86%E6%9E%90"><span class="toc-number">1.2.2.</span> <span class="toc-text">参数分析</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">1.3.</span> <span class="toc-text">补充</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
        <ul>
          <li class="active"><a href="/2021/12/26/jy%E6%BB%91%E5%9D%97/" rel="bookmark" title="jy滑块">jy滑块</a></li><li><a href="/2022/01/09/%E9%AA%8C%E8%AF%81%E7%A0%81/" rel="bookmark" title="验证码">验证码</a></li><li><a href="/2022/01/22/sm%E6%BB%91%E5%9D%97/" rel="bookmark" title="sm滑块">sm滑块</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="Mr2"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">Mr2</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">41</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">20</span>
        <span class="name">categories</span>
      </a>
    </div>
</nav>

<div class="social">
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>

</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2021/12/18/%E8%A1%A5%E7%8E%AF%E5%A2%83/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2021/12/28/%E5%8F%8D%E8%B0%83%E8%AF%95/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>Random Posts</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/app%E5%9F%BA%E7%A1%80/" title="In app基础">app基础</a>
</div>

    <span><a href="/2022/04/23/Android%E5%9F%BA%E7%A1%80/" title="Android基础">Android基础</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/ast/" title="In ast">ast</a>
</div>

    <span><a href="/2021/11/28/ast/" title="AST语法树">AST语法树</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%A1%86%E6%9E%B6/" title="In 框架">框架</a>
</div>

    <span><a href="/2022/02/02/Framework/" title="Framework">Framework</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" title="In 机器学习">机器学习</a>
</div>

    <span><a href="/2022/03/04/HMM/" title="HMM">HMM</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/" title="In 社会工程学">社会工程学</a>
</div>

    <span><a href="/2022/07/03/socialengineer/" title="socialengineer">socialengineer</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/python%E5%BC%80%E5%8F%91/" title="In python开发">python开发</a>
</div>

    <span><a href="/2022/01/18/python%E5%BC%80%E5%8F%91/" title="python开发">python开发</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/ast/" title="In ast">ast</a>
</div>

    <span><a href="/2021/12/29/ast%E8%BF%9B%E9%98%B6/" title="ast进阶">ast进阶</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/JS%E9%80%86%E5%90%91/" title="In JS逆向">JS逆向</a>
</div>

    <span><a href="/2022/01/03/%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC/" title="事件监听">事件监听</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/ast/" title="In ast">ast</a>
</div>

    <span><a href="/2022/02/20/ti%E8%BF%98%E5%8E%9F2/" title="ti还原2">ti还原2</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" title="In 机器学习">机器学习</a>
</div>

    <span><a href="/2022/02/27/%E5%85%B3%E8%81%94%E6%8C%96%E6%8E%98/" title="关联挖掘">关联挖掘</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>Recent Comments</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2022</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Mr2 @ Yume Shoka</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2021/12/26/jy滑块/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    copyright: 'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
