{
    "version": "https://jsonfeed.org/version/1",
    "title": "菜b的爬虫记录",
    "description": "",
    "home_page_url": "http://yida506.github.io",
    "items": [
        {
            "id": "http://yida506.github.io/2022/08/28/dy-app/",
            "url": "http://yida506.github.io/2022/08/28/dy-app/",
            "title": "dy_app",
            "date_published": "2022-08-28T13:37:31.000Z",
            "content_html": "<h4 id=\"抖音app\"><a class=\"anchor\" href=\"#抖音app\">#</a> 抖音 app</h4>\n<h5 id=\"抓包\"><a class=\"anchor\" href=\"#抓包\">#</a> 抓包</h5>\n<p>​\t\t抖音 app 采取了 quic 的协议，常规的方法无法抓到包，本质上是使用了开源的 boringssl，走了一个叫 quic 的协议，直接 hook 掉 so 里面的内容，即可。</p>\n<h5 id=\"接口分析\"><a class=\"anchor\" href=\"#接口分析\">#</a> 接口分析</h5>\n<p>​\t\t这里抓取的是搜索接口</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>url <span class=\"token operator\">=</span> <span class=\"token string\">\"https://search100-search-quic-lf.amemv.com/aweme/v1/general/search/stream/\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>params <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token string\">\"iid\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1368207845240094\"</span><span class=\"token punctuation\">,</span>   <span class=\"token operator\">//</span> 设备相关？</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token string\">\"device_id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"893218821787319\"</span><span class=\"token punctuation\">,</span>  <span class=\"token operator\">//</span> 设备<span class=\"token builtin\">id</span> 这个应该是唯一的</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token string\">\"ac\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"wifi\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token string\">\"channel\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sem_shenma_dy_ls088\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token string\">\"aid\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1128\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token string\">\"app_name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"aweme\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token string\">\"version_code\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"190800\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token string\">\"version_name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"19.8.0\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token string\">\"device_platform\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"android\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token string\">\"os\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"android\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token string\">\"ssmix\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token string\">\"device_type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Pixel 2 XL\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token string\">\"device_brand\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"google\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token string\">\"language\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"zh\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token string\">\"os_api\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"29\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token string\">\"os_version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"10\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token string\">\"openudid\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1de8bb03f51c66e1\"</span><span class=\"token punctuation\">,</span>   <span class=\"token operator\">//</span> 设备相关？</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token string\">\"manifest_version_code\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"190801\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token string\">\"resolution\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1440*2712\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token string\">\"dpi\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"560\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token string\">\"update_version_code\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"19809900\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token string\">\"_rticket\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1661693429375\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token string\">\"package\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"com.ss.android.ugc.aweme\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token string\">\"cpu_support64\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token string\">\"host_abi\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"armeabi-v7a\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token string\">\"is_guest_mode\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token string\">\"app_type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"normal\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token string\">\"minor_status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token string\">\"appTheme\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"light\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token string\">\"need_personal_recommend\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token string\">\"is_android_pad\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token string\">\"ts\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1661693459\"</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token string\">\"cdid\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"d92a35dd-1a8d-4a23-bb33-2b4cbce670c9\"</span>  <span class=\"token operator\">//</span> 设备相关？</pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>其中看到了貌似跟设备相关的信息，暂时还啥都不知道</p>\n</blockquote>\n<h5 id=\"设备注册\"><a class=\"anchor\" href=\"#设备注册\">#</a> 设备注册</h5>\n<p>​\t\t抓包拿到设备注册的接口</p>\n<p>​\t\t<img data-src=\"dy-app/image-20220829110628014.png\" alt=\"image-20220829110628014\"></p>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/08/23/sekiro/",
            "url": "http://yida506.github.io/2022/08/23/sekiro/",
            "title": "sekiro",
            "date_published": "2022-08-23T12:33:46.000Z",
            "content_html": "<h4 id=\"部署\"><a class=\"anchor\" href=\"#部署\">#</a> 部署</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>docker run --restart<span class=\"token operator\">=</span>always --name sekiro-server -p <span class=\"token number\">5600</span>:5600 -p <span class=\"token number\">5601</span>:5601 -p <span class=\"token number\">5602</span>:5602 -p <span class=\"token number\">5603</span>:5603 -d registry.cn-beijing.aliyuncs.com/virjar/sekiro-server:latest</pre></td></tr></table></figure><blockquote>\n<p>linux 服务器 已经部署过 docker</p>\n</blockquote>\n<h4 id=\"调用\"><a class=\"anchor\" href=\"#调用\">#</a> 调用</h4>\n<p>​\t\t在 gradle 中加入如下命令</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>implementation <span class=\"token string\">'com.virjar.sekiro.business:sekiro-business-api:1.4'</span></pre></td></tr></table></figure><blockquote>\n<p>补充： 需要在 mainifest 添加网络访问权限</p>\n</blockquote>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>uses-permission</span>  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.permission.INTERNET<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr></table></figure><blockquote>\n<p>用模板生成的话 要把这个  <code>api 'com.virjar:sekiro-api:1.0.3'</code>  注释掉</p>\n</blockquote>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/08/22/App%E5%8F%82%E6%95%B0%E5%AE%9A%E4%BD%8D/",
            "url": "http://yida506.github.io/2022/08/22/App%E5%8F%82%E6%95%B0%E5%AE%9A%E4%BD%8D/",
            "title": "App参数定位",
            "date_published": "2022-08-22T13:17:11.000Z",
            "content_html": "<h3 id=\"参数定位\"><a href=\"#参数定位\" class=\"headerlink\" title=\"参数定位\"></a>参数定位</h3><p>​        对于一个app来讲，我们往往要获得的是其加密参数，一般来讲，都是通过对网络请求抓包，然后分析参数逻辑，确定加密位置，但是，这样有一个弊端，假使存在了针对抓包的对抗(sslping等)，就会增加定位参数的逻辑成本，基于此，本文提供了另一种思路用于定位参数逻辑。</p>\n<h5 id=\"Intent\"><a href=\"#Intent\" class=\"headerlink\" title=\"Intent\"></a>Intent</h5><p>​        一般来讲，页面跳转都存在序列化-&gt;反序列化的逻辑。</p>\n<pre><code class=\"lang-java\">btnTwo.setOnClickListener(new View.OnClickListener()&#123;\n            @Override\n            public void onClick(View v) &#123;\n                Intent intent = new Intent(MainActivity.this, SecondActivity.class);\n                // 创建一个Bundle对象封装数据\n                Bundle data = new Bundle();\n                data.putInt(&quot;age&quot;,18);\n                data.putString(&quot;name&quot;, &quot;Jack&quot;);\n                intent.putExtra(&quot;data&quot;, data);\n                startActivity(intent);\n            &#125;\n        &#125;);\n// 第二个页面\nBundle data = getIntent().getBundleExtra(&quot;data&quot;);\nint id = data.getInt(&quot;age&quot;);\n</code></pre>\n<p>​        这里的逻辑是给按钮绑定点击事件，然后，<code>startActivity</code>就是页面跳转的逻辑，然后就把第一页的数据传到了第二页。</p>\n<pre><code class=\"lang-javascript\">// 打印调用堆栈\nfunction printStack() &#123;\n    Java.perform(function () &#123;\n        var Exception = Java.use(&quot;java.lang.Exception&quot;);\n        var ins = Exception.$new(&quot;Exception&quot;);\n        var straces = ins.getStackTrace();\n        if (straces != undefined &amp;&amp; straces != null) &#123;\n            var strace = straces.toString();\n            var replaceStr = strace.replace(/,/g, &quot;\\r\\n&quot;);\n            console.log(&quot;=============================Stack strat=======================&quot;);\n            console.log(replaceStr);\n            console.log(&quot;=============================Stack end=======================\\r\\n&quot;);\n            Exception.$dispose();\n        &#125;\n    &#125;);\n&#125;\n\n\n// hook intent\nfunction hookintent() &#123;\n    Java.perform(function()&#123;\n        let Intent = Java.use(&quot;android.content.Intent&quot;);\n        // 要注意这里的重载类型\n        Intent.putExtra.overload(&#39;java.lang.String&#39;, &#39;android.os.Bundle&#39;).implementation = function(a, b)&#123;\n            console.log(&quot;hook intent&quot;)\n            printStack()\n            return this.putExtra(a, b);\n        &#125;;\n\n    &#125;)\n&#125;;\n</code></pre>\n<h5 id=\"TextView\"><a href=\"#TextView\" class=\"headerlink\" title=\"TextView\"></a>TextView</h5><p>​        第二种就是Hook Android 原生组件，因为，数据如何传输，最终还是会渲染到页面上，这样只需要，hook对应的组件，打印调用堆栈，就能定位到入口。</p>\n<pre><code class=\"lang-javascript\">// hook setText\nfunction hooksetText()&#123;\n    Java.perform(function()&#123;\n        let TextView = Java.use(&quot;android.widget.TextView&quot;);\n        var stringClzz = Java.use(&#39;java.lang.String&#39;);\n        TextView.setText.overload(&#39;java.lang.CharSequence&#39;).implementation = function(a)&#123;\n            console.log(&quot;hook text View&quot;)\n            var obj1= Java.cast(a, stringClzz); // 类型转化\n            console.log(obj1);\n            if( obj1.indexOf(&quot;test&quot;) &gt; -1) &#123;\n                printStack();\n            &#125;;\n            return this.setText(a);\n        &#125;;\n\n    &#125;);\n&#125;;\n</code></pre>\n<blockquote>\n<p>缺点就是，只能应对原生组件</p>\n</blockquote>\n<h5 id=\"Dialog\"><a href=\"#Dialog\" class=\"headerlink\" title=\"Dialog\"></a>Dialog</h5><p>​        第三种，就是hook弹窗。</p>\n<pre><code class=\"lang-javascript\">function hookdialog()&#123;\n    Java.perform(function()&#123;\n        let Builder = Java.use(&quot;androidx.appcompat.app.AlertDialog$Builder&quot;);\n        var stringClzz = Java.use(&#39;java.lang.String&#39;);\n        console.log(&#39;hook dialog&#39;);\n        Builder.setMessage.overload(&#39;java.lang.CharSequence&#39;).implementation = function(a)&#123;\n            console.log(&quot;hook dialog1&quot;);\n            var obj1= Java.cast(a, stringClzz); // 类型转化\n            console.log(obj1);\n            printStack()\n            return this.setMessage(a);\n        &#125;;\n\n    &#125;);\n&#125;;\n</code></pre>\n",
            "tags": [
                "app进阶"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/08/08/unidbg%E8%A1%A5%E7%8E%AF%E5%A2%83/",
            "url": "http://yida506.github.io/2022/08/08/unidbg%E8%A1%A5%E7%8E%AF%E5%A2%83/",
            "title": "unidbg补环境",
            "date_published": "2022-08-08T04:45:27.000Z",
            "content_html": "<h4 id=\"补环境\"><a class=\"anchor\" href=\"#补环境\">#</a> 补环境</h4>\n<h5 id=\"运行流程\"><a class=\"anchor\" href=\"#运行流程\">#</a> 运行流程</h5>\n<p>对于 unidbg 来讲，整体的运行流程如下：</p>\n<p><strong>构造方法:</strong></p>\n<ul>\n<li>构建模拟器实例</li>\n<li>创建虚拟机</li>\n<li>加载 so</li>\n<li>调用 jni_onload (针对构造方法)</li>\n</ul>\n<p><strong>mian：</strong></p>\n<ul>\n<li>初始化类实例</li>\n<li>调用方法，计算参数</li>\n</ul>\n<p>这样一来，主要的逻辑就在所编写的对应方法中，这样一来，我们只需要针对不同的 native 方法编写对应的逻辑，调用即可。但随之而来了一些问题，比如，依赖了其他的 so 文件，对于使用了 java 层的方法，在 unidbg 中没有实现，在 native 类中调用了其他的静态方法等等。</p>\n<p>对于这些问题，我们就需要手动的补出对应的环境，解决对应的问题。</p>\n<h5 id=\"类型介绍\"><a class=\"anchor\" href=\"#类型介绍\">#</a> 类型介绍</h5>\n<h6 id=\"string\"><a class=\"anchor\" href=\"#string\">#</a> String</h6>\n<p>在 java 中对于字符串类型啥的，都直接通过 String str 声明，但是在 Unidbg 中有所不同</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">new</span> <span class=\"token class-name\">StringObject</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">,</span> <span class=\"token string\">\"12345\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>跟进去看</p>\n<p><img data-src=\"http://pic.ddddhm.cn/unidbg%E8%A1%A5%E7%8E%AF%E5%A2%83/image-20220808150043257.png\" alt=\"image-20220808150043257\"></p>\n<p>然后这里也其实就相当于</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">DvmObject</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">.</span><span class=\"token function\">resolveClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"java/lang/string\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h6 id=\"byte\"><a class=\"anchor\" href=\"#byte\">#</a> Byte []</h6>\n<p>与 String 类似</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> input <span class=\"token operator\">=</span> <span class=\"token string\">\"123\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> inputByte <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StandardCharsets</span><span class=\"token punctuation\">.</span>UTF_8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">ByteArray</span> inputByteArray <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ByteArray</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">,</span>inputByte<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h6 id=\"content上下文\"><a class=\"anchor\" href=\"#content上下文\">#</a> Content (上下文)</h6>\n<p>content 类由于 unidbg 中未实现，所以需要手动实现一下</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">DvmObject</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> context <span class=\"token operator\">=</span> vm<span class=\"token punctuation\">.</span><span class=\"token function\">resolveClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"android/content/Context\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">newObject</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 这里的 newObject 其实就是相当于给 DvmObject 了个 value 原理还是和上述类似  </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">DvmObject</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">newObject</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DvmObject</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>这里给 null 主要是因为，这玩意一般是用于计算签名参数，所以给任何值都无所谓，只要在 so 计算签名的时候 patch 掉就行。</p>\n</blockquote>\n<h5 id=\"补环境-2\"><a class=\"anchor\" href=\"#补环境-2\">#</a> 补环境</h5>\n<p>在补环境之前，先把日志打开，这样就可以看到运行流程中的</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>log4j<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Level</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>log4j<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Logger</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token class-name\">Logger</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLogger</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DalvikVM</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setLevel</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Level</span><span class=\"token punctuation\">.</span>DEBUG<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token class-name\">Logger</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLogger</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BaseVM</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setLevel</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Level</span><span class=\"token punctuation\">.</span>DEBUG<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>接下来介绍两种类型的补法：</p>\n<ul>\n<li>普通函数</li>\n</ul>\n<figure class=\"highlight log\"><figcaption data-lang=\"log\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">java.lang.UnsupportedOperationException:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>android<span class=\"token operator\">/</span>app<span class=\"token operator\">/</span>ActivityThread<span class=\"token operator\">-</span><span class=\"token operator\">></span>sPackageManager<span class=\"token operator\">:</span>Landroid<span class=\"token operator\">/</span>content<span class=\"token operator\">/</span>pm<span class=\"token operator\">/</span>IPackageManager<span class=\"token operator\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tat com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span>linux<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>dvm<span class=\"token punctuation\">.</span>AbstractJni<span class=\"token punctuation\">.</span>getStaticObjectField<span class=\"token operator\">(</span>AbstractJni<span class=\"token punctuation\">.</span>java<span class=\"token operator\">:</span><span class=\"token number\">103</span><span class=\"token operator\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">/</span><span class=\"token operator\">/</span> 意思是 在运行getStaticObjectField方法时，签名为android<span class=\"token operator\">/</span>app<span class=\"token operator\">/</span>ActivityThread<span class=\"token operator\">-</span><span class=\"token operator\">></span>sPackageManager<span class=\"token operator\">:</span>Landroid<span class=\"token operator\">/</span>content<span class=\"token operator\">/</span>pm<span class=\"token operator\">/</span>IPackageManager 不存在</pre></td></tr></table></figure><ul>\n<li>动态函数</li>\n</ul>\n<p><img data-src=\"http://pic.ddddhm.cn/unidbg%E8%A1%A5%E7%8E%AF%E5%A2%83/image-20220808173958950.png\" alt=\"image-20220808173958950\"></p>\n<p>这种的就需要借助 jnitrace</p>\n<p>直接  <code>pip install jnitrace</code></p>\n",
            "tags": [
                "unidbg"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/08/07/%E6%B1%87%E7%BC%96%E5%9F%BA%E7%A1%80/",
            "url": "http://yida506.github.io/2022/08/07/%E6%B1%87%E7%BC%96%E5%9F%BA%E7%A1%80/",
            "title": "汇编基础",
            "date_published": "2022-08-07T09:27:41.000Z",
            "content_html": "<blockquote>\n<p>以下内容均为个人理解</p>\n</blockquote>\n<h3 id=\"编译原理\"><a class=\"anchor\" href=\"#编译原理\">#</a> 编译原理</h3>\n<p>​\t\t以我们现在常使用的编程语言来讲 (python，java 等) 都隶属于高级语言，要让计算机理解，必须要转化为二进制，毕竟，计算机的本质其实是集成电路，对于电路来讲，通路只有开和关两种区别。</p>\n<p>​\t\t一般来讲，程序往往会先被翻译为汇编语言，然后在转化为二进制数据，汇编语言的产生，主要是为了解决二进制数据艰涩难懂的问题，以及编程的困难性。同时，汇编语言作为一个桥梁，所有的高级语言都是基于此演变而来的，所以，各种语言在本质上都是一样的。</p>\n<h4 id=\"编译过程\"><a class=\"anchor\" href=\"#编译过程\">#</a> 编译过程</h4>\n<p>​\t\t这个过程其实就是，先对代码遍历，然后句法分析，词法分析，语义分析转化为一个语法树 (ast)，然后在翻译为汇编吧。</p>\n<p>​\t\t然后，汇编这个东西的语法貌似是个三元式子 <code>MOV R0,R1</code> ，第一个指代的是汇编指令 (这个主要是为了方便看)，后面的一般是寄存器或具体的运算子啥的。</p>\n<blockquote>\n<p>寄存器：个人对这个的理解，大致上就是，存数据啥的地方吧，</p>\n</blockquote>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/08/07/weibo%E5%9B%BD%E9%99%85%E7%89%88/",
            "url": "http://yida506.github.io/2022/08/07/weibo%E5%9B%BD%E9%99%85%E7%89%88/",
            "title": "weibo国际版",
            "date_published": "2022-08-07T08:31:29.000Z",
            "content_html": "<h3 id=\"微博国际版app逆向\"><a class=\"anchor\" href=\"#微博国际版app逆向\">#</a> 微博国际版 app 逆向</h3>\n<ul>\n<li>登录参数</li>\n</ul>\n<h4 id=\"抓包\"><a class=\"anchor\" href=\"#抓包\">#</a> 抓包</h4>\n<p>直接用 charles 抓包，可以看到，登录接口主要是 i,s,p 这三个参数携带了加密信息，</p>\n<p><img data-src=\"http://pic.ddddhm.cn/weibo%E5%9B%BD%E9%99%85%E7%89%88/image-20220807163418474.png\" alt=\"image-20220807163418474\"></p>\n<h4 id=\"静态分析\"><a class=\"anchor\" href=\"#静态分析\">#</a> 静态分析</h4>\n<p>直接用 jadx 打开，直接在 <code>loginmainactivity</code>  中找，最终可以定位到 <code>WeiboSecurityUtils</code> ，这里的 caculateS 就是计算 S 参数的 native 方法。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/weibo%E5%9B%BD%E9%99%85%E7%89%88/image-20220807164251105.png\" alt=\"image-20220807164251105\"></p>\n<p>接下来直接用 ida 打开</p>\n<p><img data-src=\"http://pic.ddddhm.cn/weibo%E5%9B%BD%E9%99%85%E7%89%88/image-20220807165257022.png\" alt=\"image-20220807165257022\"></p>\n<p>搜 java 找得到，明显是静态注册</p>\n<p><img data-src=\"http://pic.ddddhm.cn/weibo%E5%9B%BD%E9%99%85%E7%89%88/image-20220807165939380.png\" alt=\"image-20220807165939380\"></p>\n<p>大致看一下，除了 sub_1C60 这个函数通过 Content 校验了签名外，貌似也没哈特别的逻辑了</p>\n<h4 id=\"unidbg\"><a class=\"anchor\" href=\"#unidbg\">#</a> Unidbg</h4>\n<p>在捋清楚上述的思路后，接下来就只需要做两件事，patch (过掉) sub_1C60 的逻辑，主动调用生成参数</p>\n<p>1C60 的偏移地址可以在 View 界面找到</p>\n<p><img data-src=\"http://pic.ddddhm.cn/weibo%E5%9B%BD%E9%99%85%E7%89%88/image-20220807172939604.png\" alt=\"image-20220807172939604\"></p>\n<p>然后可以采用 hook 的方式，将这里的 FF F7 EB FE 更换为指令 mov ro,1</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">patchVerify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">int</span> patchCode <span class=\"token operator\">=</span> <span class=\"token number\">0x4FF00100</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//mov r0,1 对应的操作码</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        emulator<span class=\"token punctuation\">.</span><span class=\"token function\">getMemory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">pointer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">module</span><span class=\"token punctuation\">.</span>base <span class=\"token operator\">+</span> <span class=\"token number\">0x1E86</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>patchCode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>此外，也可以采用 unidbg 自带的 hook 命令</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Pointer</span> pointer <span class=\"token operator\">=</span> <span class=\"token class-name\">UnidbgPointer</span><span class=\"token punctuation\">.</span><span class=\"token function\">pointer</span><span class=\"token punctuation\">(</span>emulator<span class=\"token punctuation\">,</span> <span class=\"token keyword\">module</span><span class=\"token punctuation\">.</span>base <span class=\"token operator\">+</span> <span class=\"token number\">0x1E86</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">assert</span> pointer <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> code <span class=\"token operator\">=</span> pointer<span class=\"token punctuation\">.</span><span class=\"token function\">getByteArray</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token class-name\">Arrays</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#123;</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">)</span><span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">)</span> <span class=\"token number\">0xF7</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">)</span> <span class=\"token number\">0xEB</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">)</span> <span class=\"token number\">0xFE</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// BL sub_1C60</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalStateException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Inspector</span><span class=\"token punctuation\">.</span><span class=\"token function\">inspectString</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">,</span> <span class=\"token string\">\"patch32 code=\"</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">Arrays</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Keystone</span> keystone <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Keystone</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">KeystoneArchitecture<span class=\"token punctuation\">.</span>Arm</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">KeystoneMode<span class=\"token punctuation\">.</span>ArmThumb</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token class-name\">KeystoneEncoded</span> encoded <span class=\"token operator\">=</span> keystone<span class=\"token punctuation\">.</span><span class=\"token function\">assemble</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mov r0,1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> patch <span class=\"token operator\">=</span> encoded<span class=\"token punctuation\">.</span><span class=\"token function\">getMachineCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>patch<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!=</span> code<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalStateException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Inspector</span><span class=\"token punctuation\">.</span><span class=\"token function\">inspectString</span><span class=\"token punctuation\">(</span>patch<span class=\"token punctuation\">,</span> <span class=\"token string\">\"patch32 length=\"</span> <span class=\"token operator\">+</span> patch<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            pointer<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> patch<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> patch<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>最后正常调用即可</p>\n<h4 id=\"参考\"><a class=\"anchor\" href=\"#参考\">#</a> 参考</h4>\n",
            "tags": [
                "unidbg"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/08/04/meitu/",
            "url": "http://yida506.github.io/2022/08/04/meitu/",
            "title": "meitu",
            "date_published": "2022-08-04T10:23:26.000Z",
            "content_html": "<h3 id=\"美图秀秀\"><a class=\"anchor\" href=\"#美图秀秀\">#</a> 美图秀秀</h3>\n<p>直接用 charles 抓包，加密参数就应该是这个 sig</p>\n<p><img data-src=\"http://pic.ddddhm.cn/meitu/image-20220804190817096.png\" alt=\"image-20220804190817096\"></p>\n<p>直接搜 sig 返回太多参数，不利于分析，搜 sigVersion</p>\n<p><img data-src=\"http://pic.ddddhm.cn/meitu/image-20220804191944318.png\" alt=\"image-20220804191944318\"></p>\n<p>看到这里有 generator 的字段，猜测跟生成有关，进一步点进去看，发现最后调用了个 native 方法</p>\n<p>hook 一下，看里面都是些什么东西</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    hook java </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    frida -U -l hook.js com.mt.mtxx.mtxx</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>*/</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">hookso</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    Java<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hook start'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">var</span> SigEntity <span class=\"token operator\">=</span> Java<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.meitu.secret.SigEntity\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t<span class=\"token comment\">// 对应 string, byte [] ,string, object</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        SigEntity<span class=\"token punctuation\">.</span>generatorSig<span class=\"token punctuation\">.</span><span class=\"token function\">overload</span><span class=\"token punctuation\">(</span><span class=\"token string\">'java.lang.String'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'[Ljava.lang.String;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'java.lang.String'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'java.lang.Object'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">implementation</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SigEntity.generatorSig.a: '</span><span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SigEntity.generatorSig.b: '</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SigEntity.generatorSig.c: '</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SigEntity.generatorSig.d: '</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">var</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">generatorSig</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SigEntity.generatorSig.res: '</span><span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">.</span>sig<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token function\">setImmediate</span><span class=\"token punctuation\">(</span>hookso<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"http://pic.ddddhm.cn/meitu/image-20220804212317793.png\" alt=\"image-20220804212317793\"></p>\n<p>参数解释</p>\n<ul>\n<li>a: 可以写死</li>\n<li>b: 时间戳，日期，ip，设备信息等</li>\n<li>c: 固定字符串</li>\n<li>d: 固定信息 (应该是决定数据来源的)</li>\n</ul>\n<blockquote>\n<p>通过观察，这个结果很像 md5，接下来就进去 so 中看逻辑</p>\n</blockquote>\n<p><img data-src=\"http://pic.ddddhm.cn/meitu/image-20220804213410042.png\" alt=\"image-20220804213410042\"></p>\n<p>这里有点骚的是，它把 so 包名隐藏了一下</p>\n<p><img data-src=\"http://pic.ddddhm.cn/meitu/image-20220804215414627.png\" alt=\"image-20220804215414627\"></p>\n<p>这里有个 generatorSIG，点进去看，发现有 md5</p>\n<p><img data-src=\"http://pic.ddddhm.cn/meitu/image-20220804215445419.png\" alt=\"image-20220804215445419\"></p>\n<blockquote>\n<p>估计大差不差是 md5 加密了，也可以上 frid</p>\n</blockquote>\n<h4 id=\"unidbg\"><a class=\"anchor\" href=\"#unidbg\">#</a> unidbg</h4>\n<p>直接先跑一下模板</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>xiayu<span class=\"token punctuation\">.</span>meituxiuxiu</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AndroidEmulator</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Emulator</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Module</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span>debugger<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">BreakPointCallback</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span>debugger<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Debugger</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span>debugger<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DebuggerType</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span>linux<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AndroidEmulatorBuilder</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span>linux<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AndroidResolver</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span>linux<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>dvm<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span>linux<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>dvm<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ArrayObject</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span>linux<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>dvm<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ByteArray</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>unidbg<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Memory</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">unicorn<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ArmConst</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">File</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>security<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageDigest</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GetSig_v9080Test</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AbstractJni</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">AndroidEmulator</span> emulator<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Module</span> <span class=\"token keyword\">module</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">VM</span> vm<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> apkPath <span class=\"token operator\">=</span> <span class=\"token string\">\"F:\\\\unidbg\\\\unidbg-android\\\\src\\\\test\\\\java\\\\com\\\\mtxx\\\\meitu.apk\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> soPath2 <span class=\"token operator\">=</span> <span class=\"token string\">\"F:\\\\unidbg\\\\unidbg-android\\\\src\\\\test\\\\java\\\\com\\\\mtxx\\\\librelease_sig.so\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token class-name\">GetSig_v9080Test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        emulator <span class=\"token operator\">=</span> <span class=\"token class-name\">AndroidEmulatorBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">for32Bit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token keyword\">final</span> <span class=\"token class-name\">Memory</span> memory <span class=\"token operator\">=</span> emulator<span class=\"token punctuation\">.</span><span class=\"token function\">getMemory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        memory<span class=\"token punctuation\">.</span><span class=\"token function\">setLibraryResolver</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">AndroidResolver</span><span class=\"token punctuation\">(</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        vm <span class=\"token operator\">=</span> emulator<span class=\"token punctuation\">.</span><span class=\"token function\">createDalvikVM</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>apkPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        vm<span class=\"token punctuation\">.</span><span class=\"token function\">setVerbose</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        vm<span class=\"token punctuation\">.</span><span class=\"token function\">setJni</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token class-name\">DalvikModule</span> dm2 <span class=\"token operator\">=</span> vm<span class=\"token punctuation\">.</span><span class=\"token function\">loadLibrary</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>soPath2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        dm2<span class=\"token punctuation\">.</span><span class=\"token function\">callJNI_OnLoad</span><span class=\"token punctuation\">(</span>emulator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">module</span> <span class=\"token operator\">=</span> dm2<span class=\"token punctuation\">.</span><span class=\"token function\">getModule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token class-name\">GetSig_v9080Test</span> getSig <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GetSig_v9080Test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        getSig<span class=\"token punctuation\">.</span><span class=\"token function\">destroy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">destroy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            emulator<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>发现抛出缺少 so 文件的错误。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/meitu/image-20220805134939256.png\" alt=\"image-20220805134939256\"></p>\n<p>直接在构造函数中补上另一个 so</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">DalvikModule</span> dm1 <span class=\"token operator\">=</span> vm<span class=\"token punctuation\">.</span><span class=\"token function\">loadLibrary</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>soPath1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> dm1<span class=\"token punctuation\">.</span><span class=\"token function\">callJNI_OnLoad</span><span class=\"token punctuation\">(</span>emulator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token class-name\">DalvikModule</span> dm2 <span class=\"token operator\">=</span> vm<span class=\"token punctuation\">.</span><span class=\"token function\">loadLibrary</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>soPath2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre> dm2<span class=\"token punctuation\">.</span><span class=\"token function\">callJNI_OnLoad</span><span class=\"token punctuation\">(</span>emulator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token keyword\">module</span> <span class=\"token operator\">=</span> dm2<span class=\"token punctuation\">.</span><span class=\"token function\">getModule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>接下来直接调用 call 方法</p>\n<p><img data-src=\"http://pic.ddddhm.cn/meitu/image-20220807212448966.png\" alt=\"image-20220807212448966\"></p>\n<p>点进去，发现其实是少了很多</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">DvmObject</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getStaticObjectField</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BaseVM</span> vm<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DvmClass</span> dvmClass<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> signature<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>signature<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"android/app/ActivityThread->sPackageManager:Landroid/content/pm/IPackageManager;\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token keyword\">return</span> vm<span class=\"token punctuation\">.</span><span class=\"token function\">resolveClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"android/content/pm/IPackageManager\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">newObject</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">getStaticObjectField</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">,</span> dvmClass<span class=\"token punctuation\">,</span> signature<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>直接方法里加入上述代码，接着运行，又抛出错误，从堆栈中看</p>\n<p><img data-src=\"http://pic.ddddhm.cn/meitu/image-20220807212842407.png\" alt=\"image-20220807212842407\"></p>\n<p>这里发现，他是这个 dvmClass 类缺少 getSuperclass 方法所导致，点进去</p>\n<p><img data-src=\"http://pic.ddddhm.cn/meitu/image-20220807213020044.png\" alt=\"image-20220807213020044\"></p>\n<p>可以看到，这里其实是初始化的时候缺少的 (vm.resolveClass</p>\n<p><img data-src=\"http://pic.ddddhm.cn/meitu/image-20220807215451155.png\" alt=\"image-20220807215451155\"></p>\n<p>这里看到，对于传递多个参数，那么这个 superClass 就对应的是 interfaceClasses 中第 0 个</p>\n<p>然后根据调用顺序，这里 <code>GetSuperClass</code>  出问题，归根到底，是上面的 <code>GetStaticObjectField</code>  调用，导致的原生 superClass 不存在所引出的问题，其实也就是我们上一步补的返回值出了点问题。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">return</span> vm<span class=\"token punctuation\">.</span><span class=\"token function\">resolveClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"android/content/pm/IPackageManager\"</span><span class=\"token punctuation\">,</span>   vm<span class=\"token punctuation\">.</span><span class=\"token function\">resolveClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Landroid/content/pm/IPackageManager\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">newObject</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>接下来运行，发现报了个 UnsupportedOperationException 的异常</p>\n",
            "tags": [
                "unidbg"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/08/04/yrxdemo2/",
            "url": "http://yida506.github.io/2022/08/04/yrxdemo2/",
            "title": "yrxdemo2",
            "date_published": "2022-08-04T00:10:21.000Z",
            "content_html": "<h4 id=\"第二题-简单so\"><a class=\"anchor\" href=\"#第二题-简单so\">#</a> 第二题 简单 so</h4>\n<p>还是直接搜索找到如下位置</p>\n<p><img data-src=\"http://pic.ddddhm.cn/yrxdemo2/image-20220810102449541.png\" alt=\"image-20220810102449541\"></p>\n<p>编写 frida 脚本，hook 一下这个 encodeToString 是啥</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Java<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"so start:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">var</span> ByteString <span class=\"token operator\">=</span> Java<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.android.okhttp.okio.ByteString\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">var</span> NativeLib <span class=\"token operator\">=</span> Java<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'com.yuanrenxue.challenge.two.NativeLib'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">var</span> Base64 <span class=\"token operator\">=</span> Java<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'android.util.Base64'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        NativeLib<span class=\"token punctuation\">.</span>encrypt<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">implementation</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SigEntity.generatorSig.a: '</span><span class=\"token punctuation\">,</span> ByteString<span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">utf8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SigEntity.generatorSig.b: '</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token keyword\">let</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'result:'</span><span class=\"token punctuation\">,</span>  ByteString<span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            Base64<span class=\"token punctuation\">.</span>encodeToString<span class=\"token punctuation\">.</span><span class=\"token function\">overload</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[B'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'int'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">implementation</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">val1<span class=\"token punctuation\">,</span> val2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token comment\">// console.log(val1);</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token comment\">// console.log(val2);</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token keyword\">let</span> result1 <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">encodeToString</span><span class=\"token punctuation\">(</span>val1<span class=\"token punctuation\">,</span> val2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token keyword\">return</span> result1</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"http://pic.ddddhm.cn/yrxdemo2/image-20220810145803770.png\" alt=\"image-20220810145803770\"></p>\n<p>很明显，这个就是我们想要的结果了，然后就跟进去 NativeLib.encrypt，发现是个 native 方法</p>\n<p>大致翻译一下：</p>\n<p>使用 native 方法加密，第一个参数是由页数冒号时间戳组成的 byte 数组第二个参数就是时间戳</p>\n<p><img data-src=\"http://pic.ddddhm.cn/yrxdemo2/image-20220804082551141.png\" alt=\"image-20220804082551141\"></p>\n<p>很明显，加密函数对应的 so 文件如图所示，直接用 ida 打开</p>\n<p><img data-src=\"http://pic.ddddhm.cn/yrxdemo2/image-20220804082634800.png\" alt=\"image-20220804082634800\"></p>\n<p>点进去 发现逻辑有点复杂，就不考虑继续分析 so 了</p>\n",
            "tags": [
                "YRX"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/08/03/yrxdemo1/",
            "url": "http://yida506.github.io/2022/08/03/yrxdemo1/",
            "title": "yrxdemo1",
            "date_published": "2022-08-03T03:30:33.000Z",
            "content_html": "<h3 id=\"第一题-java层加密\"><a class=\"anchor\" href=\"#第一题-java层加密\">#</a> 第一题 java 层加密</h3>\n<p><strong>packagename:</strong> com.yuanrenxue.challenge</p>\n<p>搜索题目一，定位到如下位置</p>\n<p><img data-src=\"http://pic.ddddhm.cn/yrxdemo1/image-20220803114427625.png\" alt=\"image-20220803114427625\"></p>\n<p>使用 r0capture 抓包</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># attach 模式</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>python r0capture<span class=\"token punctuation\">.</span>py <span class=\"token operator\">-</span>U com<span class=\"token punctuation\">.</span>yuanrenxue<span class=\"token punctuation\">.</span>challenge <span class=\"token operator\">-</span>v <span class=\"token operator\">-</span>p iqiyi<span class=\"token punctuation\">.</span>pcap</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># spawn 模式</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>python r0capture<span class=\"token punctuation\">.</span>py <span class=\"token operator\">-</span>U <span class=\"token operator\">-</span>f com<span class=\"token punctuation\">.</span>yuanrenxue<span class=\"token punctuation\">.</span>challenge <span class=\"token operator\">-</span>v</pre></td></tr></table></figure><p>抓完后用 wireshark 打开 pcap 文件，发现，这里就是发送数据的地方， source 为 192.168.0.100 发送的了请求，携带了 page、sign、t 三个参数</p>\n<p><img data-src=\"http://pic.ddddhm.cn/yrxdemo1/image-20220803144525277.png\" alt=\"image-20220803144525277\"></p>\n<p>发送参数</p>\n<p><img data-src=\"http://pic.ddddhm.cn/yrxdemo1/image-20220803144418271.png\" alt=\"image-20220803144418271\"></p>\n<p>返回数据</p>\n<p><img data-src=\"http://pic.ddddhm.cn/yrxdemo1/image-20220803144632863.png\" alt=\"image-20220803144632863\"></p>\n<p>通过参数的值，我们很容易就能猜测到，page 就是页面，t 就是时间戳，sign 就是加密参数，接下来就跟进 jadx 中分析具体逻辑</p>\n<p><img data-src=\"http://pic.ddddhm.cn/yrxdemo1/image-20220803144936909.png\" alt=\"image-20220803144936909\"></p>\n<p>在这里很容易看到，page 和时间戳的生成逻辑，即这个 OooO2 就是对应的 sign 参数，点进去发现涉及到了个复杂的算法，相当于将 page 和时间戳拼接到了个 StringBuider 中，然后在转化为 byte 数组，经过这一系列加密，拿到了最后的加密结果。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/yrxdemo1/image-20220803145223487.png\" alt=\"image-20220803145223487\"></p>\n<p>用将加密算法放入 idea 中，写一个 demo，最后拿到对应的参数</p>\n<p><img data-src=\"http://pic.ddddhm.cn/yrxdemo1/image-20220803154213156.png\" alt=\"image-20220803154213156\"></p>\n<h4 id=\"okhttp3使用\"><a class=\"anchor\" href=\"#okhttp3使用\">#</a> okhttp3 使用</h4>\n<p>在 xml 中加入依赖</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependencies</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.squareup.okhttp3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>okhttp<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>3.8.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    \t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.google.code.gson<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>gson<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>2.8.9<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependencies</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><blockquote>\n<p>下面哪个是 gson 用于解析 json 的</p>\n</blockquote>\n<p>然后编写如下代码</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 需要单独建一个类用于将 gson 解析的字符串与其对应，然后用。访问</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">YrxData</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> status<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> state<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Datalist</span><span class=\"token punctuation\">></span></span> data<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Datalist</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token class-name\">String</span> value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"采集\"><a class=\"anchor\" href=\"#采集\">#</a> 采集</h5>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getSign</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> page<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> currentTimeMillis<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token class-name\">StringBuilder</span> sb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StringBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        sb<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"page=\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        sb<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        sb<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>currentTimeMillis<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">String</span> sign <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Oooo000</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">OooO</span><span class=\"token punctuation\">(</span>sb<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StandardCharsets</span><span class=\"token punctuation\">.</span>UTF_8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> sign<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token class-name\">Integer</span> result <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">OkHttpClient</span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OkHttpClient<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token class-name\">String</span> url1 <span class=\"token operator\">=</span> <span class=\"token string\">\"https://www.python-spider.com/api/app1\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> page <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> page <span class=\"token operator\">&lt;=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> page<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">long</span> currentTimeMillis <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token class-name\">String</span> sign <span class=\"token operator\">=</span> <span class=\"token function\">getSign</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">,</span>currentTimeMillis<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token class-name\">RequestBody</span> body <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FormBody<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"page\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sign\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>sign<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"t\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>currentTimeMillis<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token class-name\">Request</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Request<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>url1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                    <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Response</span> response <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">newCall</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token class-name\">String</span> resStr <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">body</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">string</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>page <span class=\"token operator\">+</span><span class=\"token string\">\" ===> \"</span><span class=\"token operator\">+</span> resStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                <span class=\"token class-name\">Gson</span> gson <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Gson</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token class-name\">YrxData</span> yrxdata <span class=\"token operator\">=</span> gson<span class=\"token punctuation\">.</span><span class=\"token function\">fromJson</span><span class=\"token punctuation\">(</span>resStr<span class=\"token punctuation\">,</span><span class=\"token class-name\">YrxData</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                    <span class=\"token class-name\">Integer</span> nowvalue <span class=\"token operator\">=</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>yrxdata<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>nowvalue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                    result <span class=\"token operator\">+=</span> nowvalue<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t<span class=\"token comment\">// 结果 5137931</span></pre></td></tr></table></figure>",
            "tags": [
                "YRX"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/08/03/easyso/",
            "url": "http://yida506.github.io/2022/08/03/easyso/",
            "title": "easyso",
            "date_published": "2022-08-03T02:47:01.000Z",
            "content_html": "<h3 id=\"easyso\"><a class=\"anchor\" href=\"#easyso\">#</a> Easyso</h3>\n<p>直接 jadx 打开，很明显是通过 CheckString 这个方法进行的判断。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/easyso/image-20220803105345599.png\" alt=\"image-20220803105345599\"></p>\n<p>然后打开 so</p>\n<p><img data-src=\"http://pic.ddddhm.cn/easyso/image-20220803105900353.png\" alt=\"image-20220803105900353\"></p>\n<p>大意是通过比较 v6 和这个字符串，如果相等就返回 true</p>\n<p>跟进 j_TestDec 查看逻辑</p>\n<p><img data-src=\"http://pic.ddddhm.cn/easyso/image-20220803111254528.png\" alt=\"image-20220803111254528\"></p>\n<p>大致上其实是对一个长度为 32 的字符做了这样一个操作，直接用 py 逆向还原</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>longstr <span class=\"token operator\">=</span> <span class=\"token string\">\"f72c5a36569418a20907b55be5bf95ad\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>result <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    result <span class=\"token operator\">=</span> result <span class=\"token operator\">+</span> longstr<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> longstr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> result<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "CTF"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/08/02/mobilectf2/",
            "url": "http://yida506.github.io/2022/08/02/mobilectf2/",
            "title": "mobilectf2",
            "date_published": "2022-08-02T13:21:28.000Z",
            "content_html": "<h3 id=\"ctf第二题\"><a class=\"anchor\" href=\"#ctf第二题\">#</a> CTF 第二题</h3>\n<p>模拟登录</p>\n<p>packagename:com.tencent.testvuln</p>\n<h4 id=\"静态分析\"><a class=\"anchor\" href=\"#静态分析\">#</a> 静态分析</h4>\n<p>直接打开 mainactivity 看到，这里点击了登录按钮后，直接通过序列化 (intent) 传到了下一个页面</p>\n<p><img data-src=\"http://pic.ddddhm.cn/mobilectf2/image-20220802212523959.png\" alt=\"image-20220802212523959\"></p>\n<p>点进去发现，其实就是对输入的这两个玩意做了个加密</p>\n<p><img data-src=\"http://pic.ddddhm.cn/mobilectf2/image-20220802212656609.png\" alt=\"image-20220802212656609\"></p>\n<p>跟进去发现是 native 方法</p>\n<p><img data-src=\"http://pic.ddddhm.cn/mobilectf2/image-20220802213646813.png\" alt=\"image-20220802213646813\"></p>\n<p>找到对应的方法，可以看到，这里估计就是采用了 aes 的加密</p>\n<p>编写 aes 脚本</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#coding:utf-8</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> base64</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Cipher <span class=\"token keyword\">import</span> AES</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># VEIzd/V2UPYNdn/bxH3Xig==</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 9YuQ2dk8CSaCe7DTAmaqAA==</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>cipher <span class=\"token operator\">=</span> base64<span class=\"token punctuation\">.</span>b64decode<span class=\"token punctuation\">(</span><span class=\"token string\">'VEIzd/V2UPYNdn/bxH3Xig=='</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>cipher2 <span class=\"token operator\">=</span> base64<span class=\"token punctuation\">.</span>b64decode<span class=\"token punctuation\">(</span><span class=\"token string\">'9YuQ2dk8CSaCe7DTAmaqAA=='</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>key <span class=\"token operator\">=</span> <span class=\"token string\">b'thisisatestkey=='</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>aes <span class=\"token operator\">=</span> AES<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> AES<span class=\"token punctuation\">.</span>MODE_ECB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>msg <span class=\"token operator\">=</span> aes<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>cipher<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>msg2 <span class=\"token operator\">=</span> aes<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>cipher2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>msg2<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># aimagetencent\u0003\u0003\u0003</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># Cas3_0f_A_CAK3\u0002</span></pre></td></tr></table></figure><p>然后直接用这个提交，发现错误，估计存在啥不清楚的地方，再看题目名称，app 漏洞第二题，直接搜索 Encrpto, 发现 FileDataActivity 中有个解密操作，然后用 aes 脚本测试，拿到结果，提交成功。</p>\n",
            "tags": [
                "CTF"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/08/02/mobilectf/",
            "url": "http://yida506.github.io/2022/08/02/mobilectf/",
            "title": "mobilectf",
            "date_published": "2022-08-02T07:59:10.000Z",
            "content_html": "<h3 id=\"ctf移动端\"><a class=\"anchor\" href=\"#ctf移动端\">#</a> CTF 移动端</h3>\n<h4 id=\"第一题-illusion\"><a class=\"anchor\" href=\"#第一题-illusion\">#</a> 第一题 Illusion</h4>\n<p>jadx 打开</p>\n<p><img data-src=\"http://pic.ddddhm.cn/mobilectf/image-20220802160426972.png\" alt=\"image-20220802160426972\"></p>\n<p>发现就是对输入的进行了一个判断，用到的是 native 方法</p>\n<p>用 ida 打开 so，然后修改下变量名</p>\n<p><img data-src=\"http://pic.ddddhm.cn/mobilectf/image-20220802161701172.png\" alt=\"image-20220802161701172\"></p>\n<p>这里的 aE 就对应的下面这个长字符串</p>\n<p><img data-src=\"http://pic.ddddhm.cn/mobilectf/image-20220802161639961.png\" alt=\"image-20220802161639961\"></p>\n<p>然后这串代码的大致意思其实就是判断计算的这个 Buffer 中的每一个值是不是和 enc 中的相等，如果相等那就返回 correct，接下来就需要进一步查看 sub_10C0 的逻辑，因为这里的 a2 恒为 93，那么直接进入 sub_1028 查看对应逻辑</p>\n<p><img data-src=\"http://pic.ddddhm.cn/mobilectf/image-20220802162458311.png\" alt=\"image-20220802162458311\"></p>\n<p>直接把 sub_10C0 代码 copy 下来测试</p>\n<p><img data-src=\"http://pic.ddddhm.cn/mobilectf/image-20220802164705080.png\" alt=\"image-20220802164705080\"></p>\n<p>发现主要逻辑与 a1,a2 的大小有关，如果 a1 小于 a2 就为 0，同时观察函数名可以猜测应该和除有关，接着测试几个，发现这个其实就是整数除法。</p>\n<p>回到 so 开始位置还原逻辑</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 对应的 for 循环内部的操作</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>a <span class=\"token operator\">+</span> b <span class=\"token operator\">-</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">93</span> <span class=\"token operator\">>></span> <span class=\"token number\">32</span> <span class=\"token operator\">+</span> <span class=\"token number\">32</span> <span class=\"token operator\">=</span> c </pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>c <span class=\"token operator\">-</span> <span class=\"token number\">32</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">+</span> b <span class=\"token operator\">-</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">93</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>c <span class=\"token operator\">+</span> <span class=\"token number\">32</span> <span class=\"token operator\">-</span> b <span class=\"token operator\">=</span> a <span class=\"token punctuation\">[</span>分情况<span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p><img data-src=\"http://pic.ddddhm.cn/mobilectf/image-20220802202342663.png\" alt=\"image-20220802202342663\"></p>\n<ul>\n<li>\n<p>ord 返回字符的 unicode 编码</p>\n</li>\n<li>\n<p>chr 将 unicode 编码转化为字符</p>\n</li>\n</ul>\n<p>直接不采用分情况的写法会拿到如下 ascii 码表，其中包含负数，我们知道一个负数 / 93 然后在 &gt;&gt; 32 是会得到 0 的，同时，如果一个数大于 32 , 那么 对其进行 &gt;&gt;32 的操作，其实是不会变的，所以就需要分离出小于 32 的情况。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>key <span class=\"token operator\">=</span> <span class=\"token string\">'(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>enc <span class=\"token operator\">=</span> <span class=\"token string\">\"Ku@'G_V9v(yGS\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">32</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span>j <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>enc<span class=\"token punctuation\">,</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span> flag<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>       flag<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token number\">93</span><span class=\"token operator\">+</span>flag<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      flag<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># CISCN&#123;GJ5728&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>这里有个小 bug，就是 key 这里的值，用 Ida 打开直接看发现是上述那个 32 位的字符串</p>\n</blockquote>\n",
            "tags": [
                "CTF"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/07/31/Native/",
            "url": "http://yida506.github.io/2022/07/31/Native/",
            "title": "Native",
            "date_published": "2022-07-31T01:50:43.000Z",
            "content_html": "<h4 id=\"native基础\"><a class=\"anchor\" href=\"#native基础\">#</a> Native 基础</h4>\n<p>一般来讲，在 Android 开发中，除了使用 Java 语言开发并编译为 dex 文件然后由 ART 虚拟机执行的方式外，和 web 端的 wasm 一样，移动端也纯在套用 c<ins> 代码进行开并编译执行的方式 (通过 java Native Interface 可以调用 C/C</ins> 函数)。</p>\n<p><strong>优点:</strong></p>\n<ul>\n<li>性能</li>\n<li>安全</li>\n</ul>\n<h4 id=\"ndk开发流程\"><a class=\"anchor\" href=\"#ndk开发流程\">#</a> NDK 开发流程</h4>\n<h5 id=\"静态注册\"><a class=\"anchor\" href=\"#静态注册\">#</a> 静态注册</h5>\n<p>直接 android Studio 新建一个 C++demo</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Native/image-20220731102519921.png\" alt=\"image-20220731102519921\"></p>\n<p>可以看到这里相比于普通的 java 开发，多了一个 cpp 文件，然后这里应该是返回了一个字符</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Native/image-20220731102716523.png\" alt=\"image-20220731102716523\"></p>\n<p>然后在 mainactivity 中，可以看到，这里实际上就是将 native 中的字符渲染到 TextViewz 组件中</p>\n<p>打包为 APK 后，用 jadx 打开</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Native/image-20220731103653417.png\" alt=\"image-20220731103653417\"></p>\n<p>源码几乎和本地的没啥区别，接着用 ida 打开对应的 so 文件</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Native/image-20220731105504825.png\" alt=\"image-20220731105504825\"></p>\n<p>用 objection 查看</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Native/image-20220731154452579.png\" alt=\"image-20220731154452579\"></p>\n<p>这里指代的是对应的基地址，由于基地址每次都是变化的，所以我们需要要拿到对应的相对地址</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>方法地址</mtext><mo>=</mo><mtext>基地址</mtext><mo>+</mo><mtext>偏移地址</mtext></mrow><annotation encoding=\"application/x-tex\">方法地址=基地址+偏移地址\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">方</span><span class=\"mord cjk_fallback\">法</span><span class=\"mord cjk_fallback\">地</span><span class=\"mord cjk_fallback\">址</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord cjk_fallback\">基</span><span class=\"mord cjk_fallback\">地</span><span class=\"mord cjk_fallback\">址</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">偏</span><span class=\"mord cjk_fallback\">移</span><span class=\"mord cjk_fallback\">地</span><span class=\"mord cjk_fallback\">址</span></span></span></span></span></p>\n<blockquote>\n<p>偏移地址直接从 ida 拿就好了，</p>\n</blockquote>\n<h5 id=\"导出函数名hook\"><a class=\"anchor\" href=\"#导出函数名hook\">#</a> 导出函数名 hook</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">hook_native</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">var</span> addr <span class=\"token operator\">=</span> Module<span class=\"token punctuation\">.</span><span class=\"token function\">getExportByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"libnativeappdemo.so\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Java_com_example_nativeappdemo_MainActivity_stringFromJNI\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    Interceptor<span class=\"token punctuation\">.</span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token function-variable function\">onEnter</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jnienv pointer =>'</span><span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jobj pointer =>'</span><span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token function-variable function\">onLeave</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">retval</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'retval is =>'</span><span class=\"token punctuation\">,</span> Java<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span><span class=\"token function\">getEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getStringUtfChars</span><span class=\"token punctuation\">(</span>retval<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">readCString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'---------'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">setImmediate</span><span class=\"token punctuation\">(</span>hook_native<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"http://pic.ddddhm.cn/Native/image-20220731224137172.png\" alt=\"image-20220731224137172\"></p>\n<h5 id=\"函数地址hook\"><a class=\"anchor\" href=\"#函数地址hook\">#</a> 函数地址 hook</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Java<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"so start:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">var</span> address <span class=\"token operator\">=</span> Module<span class=\"token punctuation\">.</span><span class=\"token function\">findBaseAddress</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"libnativeappdemo.so\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>地址<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"func address:\"</span><span class=\"token punctuation\">,</span> address<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    Interceptor<span class=\"token punctuation\">.</span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span>address<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token function-variable function\">onEnter</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"params1\"</span><span class=\"token punctuation\">,</span> Memory<span class=\"token punctuation\">.</span><span class=\"token function\">readCString</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token function-variable function\">onLeave</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">retval</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"here???\"</span><span class=\"token punctuation\">,</span> retval<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote>\n<p>这里的地址可以直接用 ida 查看，对于 32 位的需要 + 1</p>\n</blockquote>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/07/28/jg%E6%96%B0%E9%97%BB/",
            "url": "http://yida506.github.io/2022/07/28/jg%E6%96%B0%E9%97%BB/",
            "title": "jg新闻",
            "date_published": "2022-07-28T10:03:36.000Z",
            "content_html": "<h4 id=\"app\"><a class=\"anchor\" href=\"#app\">#</a> APP</h4>\n<p>选用 <strong>com.hoge.android.app.hljapp_3.8.7_20220615.apk</strong> 这一版本的 app</p>\n<h5 id=\"root检测\"><a class=\"anchor\" href=\"#root检测\">#</a> root 检测</h5>\n<p>打开发现有 root 检测</p>\n<p><img data-src=\"http://pic.ddddhm.cn/jg%E6%96%B0%E9%97%BB/image-20220728181132781.png\" alt=\"image-20220728181132781\"></p>\n<p>直接采用 objection 在启动阶段过掉检测</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>objection -g appname explore --startup-command <span class=\"token string\">\"android root disable\"</span></pre></td></tr></table></figure><blockquote>\n<p>这里主要是将 root 后端文件特征抹掉</p>\n</blockquote>\n<p>注入后就可以正常进入 app 了</p>\n<p><img data-src=\"http://pic.ddddhm.cn/jg%E6%96%B0%E9%97%BB/image-20220728184938632.png\" alt=\"image-20220728184938632\"></p>\n<h5 id=\"app抓包\"><a class=\"anchor\" href=\"#app抓包\">#</a> app 抓包</h5>\n<p>使用 postern 抓包后，获取如下接口内容，发现主要的加密参数可能为如下两个:</p>\n<p><img data-src=\"http://pic.ddddhm.cn/jg%E6%96%B0%E9%97%BB/image-20220729095038572.png\" alt=\"image-20220729095038572\"></p>\n<h5 id=\"静态分析\"><a class=\"anchor\" href=\"#静态分析\">#</a> 静态分析</h5>\n<h6 id=\"脱壳\"><a class=\"anchor\" href=\"#脱壳\">#</a> 脱壳</h6>\n<p>直接用 jadx 打开，发现应该是 360 的壳</p>\n<p><img data-src=\"http://pic.ddddhm.cn/jg%E6%96%B0%E9%97%BB/image-20220729095513391.png\" alt=\"image-20220729095513391\"></p>\n<p>直接用 frida_dexdump 脱壳.</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip3 <span class=\"token function\">install</span> frida-dexdump</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 脱壳</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>frida-dexdump -FU</pre></td></tr></table></figure><p><img data-src=\"http://pic.ddddhm.cn/jg%E6%96%B0%E9%97%BB/image-20220729100252532.png\" alt=\"image-20220729100252532\"></p>\n<blockquote>\n<p>本质上应该是直接把 dex 文件导出来</p>\n</blockquote>\n<h6 id=\"jadx分析\"><a class=\"anchor\" href=\"#jadx分析\">#</a> jadx 分析</h6>\n<p>然后把 dex 文件拖到 jadx 中搜索参数，很明显这里估计就是对应的参数加密的位置</p>\n<p><img data-src=\"http://pic.ddddhm.cn/jg%E6%96%B0%E9%97%BB/image-20220729191816673.png\" alt=\"image-20220729191816673\"></p>\n<p>很明显，这里的 account 应该是个随机数，接下来跟进 getSign 中看</p>\n<p><img data-src=\"http://pic.ddddhm.cn/jg%E6%96%B0%E9%97%BB/image-20220729193630021.png\" alt=\"image-20220729193630021\"></p>\n<p>跟到最里面发现它其实是一个 interface 的实现，直接搜索，发现它是 native 方法</p>\n<p><img data-src=\"http://pic.ddddhm.cn/jg%E6%96%B0%E9%97%BB/image-20220729193736930.png\" alt=\"image-20220729193736930\"></p>\n<h6 id=\"ida分析\"><a class=\"anchor\" href=\"#ida分析\">#</a> ida 分析</h6>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS13dGYtaXEwZjM4aXFzYWUwcWkxY24wOGQzNWEuc28=\">直接打开对应的 wtf.so</span>，然后搜索 java 进到对应的 get_Sign 方法中</p>\n<p><img data-src=\"http://pic.ddddhm.cn/jg%E6%96%B0%E9%97%BB/image-20220730160805506.png\" alt=\"image-20220730160805506\"></p>\n<p>然后直接 hook so 即可</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"so start:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">var</span> address <span class=\"token operator\">=</span> Module<span class=\"token punctuation\">.</span><span class=\"token function\">findBaseAddress</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"libnativeappdemo.so\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x154</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"func address:\"</span><span class=\"token punctuation\">,</span> address<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Interceptor<span class=\"token punctuation\">.</span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span>address<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function-variable function\">onEnter</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"params1\"</span><span class=\"token punctuation\">,</span> Memory<span class=\"token punctuation\">.</span><span class=\"token function\">readCString</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function-variable function\">onLeave</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">retval</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"here???\"</span><span class=\"token punctuation\">,</span> retval<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/07/27/android%E8%84%B1%E5%A3%B3/",
            "url": "http://yida506.github.io/2022/07/27/android%E8%84%B1%E5%A3%B3/",
            "title": "android脱壳",
            "date_published": "2022-07-27T03:14:58.000Z",
            "content_html": "<h4 id=\"壳的概念\"><a class=\"anchor\" href=\"#壳的概念\">#</a> 壳的概念</h4>\n<p>目前 app 壳按照类型，可大致分为三代：</p>\n<ul>\n<li>整体壳</li>\n<li>函数抽取壳</li>\n<li>VMP、Dex2C</li>\n</ul>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/07/03/socialengineer/",
            "url": "http://yida506.github.io/2022/07/03/socialengineer/",
            "title": "socialengineer",
            "date_published": "2022-07-03T12:05:39.000Z",
            "content_html": "<h3 id=\"介绍\"><a class=\"anchor\" href=\"#介绍\">#</a> 介绍</h3>\n<p>影响信息安全的因素分为两部分，人为因素，以及技术因素，技术因素由于不断的进行迭代，现存的漏洞往往难以发现，但是人的因素往往处于短板，以攻击者的角度来讲，能拿到结果的方法才是好方法，因此，只要存在短板，信息安全必然存在泄露的可能。</p>\n<blockquote>\n<p>一方面，只有专注于技术的人才会有网络安全的意识，这类人在公司中往往只是一少部分，同时对于任意的公司来说，往往离不开协同分工，同时由于 &quot;组件化&quot; 的工作，导致，大部分人只关注自己事情，对其他人所作的了解甚少，这样就存在了信息差。</p>\n</blockquote>\n<h3 id=\"思路\"><a class=\"anchor\" href=\"#思路\">#</a> 思路</h3>\n<p>对于社工攻击大致分为如下几个阶段：</p>\n<ul>\n<li>建立信任感</li>\n<li>询问 (判断人的预警线，进而判断接下来的动作)</li>\n<li>采用虚假问题隐藏自己的意图</li>\n</ul>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/07/01/docker/",
            "url": "http://yida506.github.io/2022/07/01/docker/",
            "title": "docker",
            "date_published": "2022-07-01T15:06:24.000Z",
            "content_html": "<h3 id=\"docker\"><a class=\"anchor\" href=\"#docker\">#</a> Docker</h3>\n<h4 id=\"docker-windows-desktop-安装\"><a class=\"anchor\" href=\"#docker-windows-desktop-安装\">#</a> Docker windows desktop 安装</h4>\n<p>下载最新版，安装对应的 linux 镜像</p>\n<h4 id=\"docker-desktop-目录修改\"><a class=\"anchor\" href=\"#docker-desktop-目录修改\">#</a> Docker desktop 目录修改</h4>\n<blockquote>\n<p>先创建一个文件夹叫 docker</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>script</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 导出 docker-desktop</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>wsl --export docker-desktop <span class=\"token string\">\"D:<span class=\"token entity\" title=\"\\\\\">\\\\</span>docker<span class=\"token entity\" title=\"\\\\\">\\\\</span>docker-desktop.tar\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 注销 docker-desktop</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre> wsl --unregister docker-desktop</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 导入 docker-desktop</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>wsl --import docker-desktop <span class=\"token string\">\"D:<span class=\"token entity\" title=\"\\\\\">\\\\</span>docker<span class=\"token entity\" title=\"\\\\\">\\\\</span>wsl\"</span> <span class=\"token string\">\"D:<span class=\"token entity\" title=\"\\\\\">\\\\</span>docker<span class=\"token entity\" title=\"\\\\\">\\\\</span>docker-desktop.tar\"</span> --version <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 导出 docker-desktop-data</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>wsl --export docker-desktop-data <span class=\"token string\">\"D:<span class=\"token entity\" title=\"\\\\\">\\\\</span>docker<span class=\"token entity\" title=\"\\\\\">\\\\</span>docker-desktop-data.tar\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># 注销 docker-desktop-data</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> wsl --unregister docker-desktop-data</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># 导入 docker-desktop</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>wsl --import docker-desktop-data <span class=\"token string\">\"D:<span class=\"token entity\" title=\"\\\\\">\\\\</span>docker<span class=\"token entity\" title=\"\\\\\">\\\\</span>wsl\"</span> <span class=\"token string\">\"D:<span class=\"token entity\" title=\"\\\\\">\\\\</span>docker<span class=\"token entity\" title=\"\\\\\">\\\\</span>docker-desktop-data.tar\"</span> --version <span class=\"token number\">2</span></pre></td></tr></table></figure><h3 id=\"docker-部署demo\"><a class=\"anchor\" href=\"#docker-部署demo\">#</a> docker 部署 demo</h3>\n<h4 id=\"python-项目打包\"><a class=\"anchor\" href=\"#python-项目打包\">#</a> python 项目打包</h4>\n<h5 id=\"rquirements生成\"><a class=\"anchor\" href=\"#rquirements生成\">#</a> rquirements 生成</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 安装</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>python3 -m pip <span class=\"token function\">install</span> pipreqs</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 在当前目录生成</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>pipreqs <span class=\"token builtin class-name\">.</span> --encoding<span class=\"token operator\">=</span>utf8 --force</pre></td></tr></table></figure><h4 id=\"dockerfile生成\"><a class=\"anchor\" href=\"#dockerfile生成\">#</a> dockerfile 生成</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">touch</span> Dockerfile.dockerfile</pre></td></tr></table></figure><p>然后在里面写入</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># syntax=docker/dockerfile:1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>FROM python:3.8-slim-buster</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>WORKDIR /app</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>COPY requirements.txt requirements.txt</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>RUN pip3 <span class=\"token function\">install</span> -r requirements.txt</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>COPY <span class=\"token builtin class-name\">.</span> <span class=\"token builtin class-name\">.</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>CMD <span class=\"token punctuation\">[</span> <span class=\"token string\">\"python3\"</span>, <span class=\"token string\">\"-m\"</span> , <span class=\"token string\">\"flask\"</span>, <span class=\"token string\">\"run\"</span>, <span class=\"token string\">\"--host=0.0.0.0\"</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>然后运行</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>script</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>docker build --tag python-docker <span class=\"token builtin class-name\">.</span></pre></td></tr></table></figure><h3 id=\"vue项目打包-按照官网的搞\"><a class=\"anchor\" href=\"#vue项目打包-按照官网的搞\">#</a> vue 项目打包 (按照官网的搞)</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>script</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 打包本地 vue 项目 会生成一个 dist 文件夹</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">npm</span> run build</pre></td></tr></table></figure><blockquote>\n<p>新建一个目录 存放 disk 文件夹，在该文件夹下创建 Dockerfile 文件以及 nginx.conf<br>\nDockerfile:</p>\n</blockquote>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>user  nginx;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>worker_processes  1;</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>error_log  /var/log/nginx/error.log warn;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>pid        /var/run/nginx.pid;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>events &#123;</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  worker_connections  1024;</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>&#125;</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>http &#123;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  include       /etc/nginx/mime.types;</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  default_type  application/octet-stream;</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                    '$status $body_bytes_sent \"$http_referer\" '</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                    '\"$http_user_agent\" \"$http_x_forwarded_for\"';</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  access_log  /var/log/nginx/access.log  main;</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  sendfile        on;</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  keepalive_timeout  65;</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  server &#123;</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    listen       80;</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    server_name  localhost;</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    location / &#123;</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      root   /vue-docker;</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      index  index.html;</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      try_files $uri $uri/ /index.html;</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    &#125;</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    error_page   500 502 503 504  /50x.html;</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    location = /50x.html &#123;</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      root   /usr/share/nginx/html;</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    &#125;</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  &#125;</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>&#125;</pre></td></tr></table></figure><p>nginx.conf</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>FROM nginx</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>EXPOSE 80</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>COPY /dist /usr/share/nginx/html</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>ENTRYPOINT nginx -g \"daemon off;\"</pre></td></tr></table></figure><p>然后直接运行</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>script</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#-t 指定一个镜像的名字，譬如 nginx-image，注意最后的‘.’不能省略</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>docker build -t nginx-image <span class=\"token builtin class-name\">.</span></pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>script</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># -p ：配置端口映射，格式是外部访问端口：容器内端口</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># -d ：后台运行  </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># --name : 给容器取名</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># docker run -p 8089:80 -d --name [容器名字][镜像名字]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>docker run -p <span class=\"token number\">8099</span>:80 -d --name vue-project nginx-image</pre></td></tr></table></figure><h3 id=\"容器推送\"><a class=\"anchor\" href=\"#容器推送\">#</a> 容器推送</h3>\n<h5 id=\"本地打包为tar-然后直接上传\"><a class=\"anchor\" href=\"#本地打包为tar-然后直接上传\">#</a> 本地打包为 tar 然后直接上传</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>script</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 本地端</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>docker save -o centos.tar centos</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 服务器端</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>docker load -i  centos.tar</pre></td></tr></table></figure><h4 id=\"运行\"><a class=\"anchor\" href=\"#运行\">#</a> 运行</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>script</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 最后一个指代的是包名</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>docker run -d -p <span class=\"token number\">5000</span>:5000 --name rest-server python-docker</pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/06/15/Akamai/",
            "url": "http://yida506.github.io/2022/06/15/Akamai/",
            "title": "韩国航司akamai1.75",
            "date_published": "2022-06-15T13:52:39.000Z",
            "content_html": "<h4 id=\"韩国航司\"><a class=\"anchor\" href=\"#韩国航司\">#</a> 韩国航司</h4>\n<p>网站： <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZmx5YXNpYW5hLmNvbS9DL0NOL0tPL2luZGV4\">https://www.flyasiana.com/C/CN/KO/index</span></p>\n<h4 id=\"访问流程\"><a class=\"anchor\" href=\"#访问流程\">#</a> 访问流程</h4>\n<p>​\t\t访问 index 页 (200)，然后 set-cookie -&gt;post 请求传 (sensor_data)，在 set-cookie 一次 ---&gt; 带 cookie 直接请求接口。</p>\n<blockquote>\n<p>总的来说流程其实不复杂。</p>\n</blockquote>\n<h4 id=\"sensor_data\"><a class=\"anchor\" href=\"#sensor_data\">#</a> sensor_data</h4>\n<h5 id=\"扣代码\"><a class=\"anchor\" href=\"#扣代码\">#</a> 扣代码</h5>\n<p>​\t\t首先从堆栈进去，把 akm 的 js 扣下来，发现，其实就是套了个数组，然后后续分析使用 netify 插件，保证 js 是脱混淆后的，</p>\n<p>然后，总的来说，里面出现了很多生成这玩意的地方，从 send 往上回溯，然后找到位置慢慢扣就好了。</p>\n<blockquote>\n<p>扣下来，发现，其中计算包括了大量的环境检测，部分可以固定死，还有的就是各种事件的监听，以及 canves 生成的值，取 cookie 中的东西进行计算，时间戳的判断，然后这个会用个  <code>&quot;-1,2,-94,-119,&quot;</code>  的字符串隔开。</p>\n</blockquote>\n<p>​\t\t直接使用测试没啥问题，如过要并发，就得拿到真实的 canvas，以及事件监听的结果尽可能多 (虽说这玩意判断不一定智能，但是一直是一样的就很容易干掉你)，更深层次的估计就是 ja3 啥的检测。</p>\n<h6 id=\"并发假设\"><a class=\"anchor\" href=\"#并发假设\">#</a> 并发假设</h6>\n<ul class=\"task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_0\" disabled=\"true\"><label for=\"cbx_0\"> 环境随机 (浏览器头等)</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_1\" disabled=\"true\"><label for=\"cbx_1\"> 时间戳随机，有些是根据他的访问流程来的，所以时间戳还是尽可能的要按他的规律来</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_2\" disabled=\"true\"><label for=\"cbx_2\"> 事件监听的结果随机 (这玩意收集网页结果就行，其中还获得了其他比较重要的东西，不一致有可能会导致过不了校验)</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_3\" disabled=\"true\"><label for=\"cbx_3\"> canvas 收集</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_4\" disabled=\"true\"><label for=\"cbx_4\"> ja3 修改</label></li>\n</ul>\n",
            "tags": [
                "Akamai"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/06/12/Cloudflare/",
            "url": "http://yida506.github.io/2022/06/12/Cloudflare/",
            "title": "Cloudflare",
            "date_published": "2022-06-12T13:53:20.000Z",
            "content_html": "<h4 id=\"五秒盾分析笔记\"><a class=\"anchor\" href=\"#五秒盾分析笔记\">#</a> 五秒盾分析笔记</h4>\n<pre><code>\t网址  https://pastebin.com/login\n</code></pre>\n<h5 id=\"网站分析\"><a class=\"anchor\" href=\"#网站分析\">#</a> 网站分析</h5>\n<p>​\t\t打开会停留五秒，然后才会返回正常的网站，直接抓包分析，看其具体流程 (把 Presever 勾选上)</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220812215705386.png\" alt=\"image-20220812215705386\"></p>\n<p>​\t\t只有这个返回 200 的时候，才是我们要的网站</p>\n<p>通过观察，可以看到，先是访问了一个 503 的代码</p>\n<p>对比 charles 中的抓包</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220812220530890.png\" alt=\"image-20220812220530890\"></p>\n<p>​\t\t我们可以看到这里的这个 ray 在后面反复出现，接下来就先去 503 的请求中，访问了啥</p>\n<p>​\t\t将 charles 抓到的放到本地</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220812220847627.png\" alt=\"image-20220812220847627\"></p>\n<p>​\t\t可以看到，这里的这个 cray 其实就是后面几次访问携带的值</p>\n<p>​\t\t然后，这个访问获取的 js 经过测试是可以直接 request 访问拿到的，但是这个 js 是每次都是不一样的，也就是说，这里的 js 采用了动态 js 的思路，我们知道 js 发送请求一般都是通过 XMLHTTPREQUEST 这个玩意的，其中发送的时候都用的 send () 方法，直接在网页里面打上 xhr 断点</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220813140942887.png\" alt=\"image-20220813140942887\"></p>\n<p>​\t\t会在这里发送 send 请求， <code>l[c('0x1cb')][c('0x38')] </code>  这玩意其实就是第二个请求，然后这个 ax 就是将 <code>l._cf_chl_ctx</code>  这个东西</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220813141350017.png\" alt=\"image-20220813141350017\"></p>\n<p>​\t\t做了一个处理</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220813142115653.png\" alt=\"image-20220813142115653\"></p>\n<p>​\t\t对比一下，发现这里的这个值其实就是网页一开始这个自执行函数的值，然后直接用插件还原 js 代码，抠出来的这个函数就能直接用，但是因为这个 js 是动态的，所以里面有个值是动态，扣算法要注意，然后这个 请求会放回一段很长的代码，然后这个会返回一段很长的代码。</p>\n<p>​\t\t然后接下来就一直按下一步，发现，始终在这里来回摇摆，</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220813173911368.png\" alt=\"image-20220813173911368\"></p>\n<p>但是，观察调用栈，发现，后面的这玩意其实有所不同，一开始是直接调用的，后面的调用栈就包含了 eval，跟进去看，发现一个很骚的操作，就是把那个数组中的值反复替换，然后反复调用才会拿到最后的值，这样一来就极大加强了 ast 还原代码的成本，</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220813211453268.png\" alt=\"image-20220813211453268\"></p>\n<p>然后继续跟，发现  <code>_cf_chl_ctx</code>  这玩意里面多了点东西，</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220813211725224.png\" alt=\"image-20220813211725224\"></p>\n<p>在跟一下</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220813212631241.png\" alt=\"image-20220813212631241\"></p>\n<p>这里看着就像检测点</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220813215046671.png\" alt=\"image-20220813215046671\"></p>\n<p>果然，这里就是在添加环境啥的，然后这里这个 <code>e()</code>  其实是又是进入一次这个函数，估计又生成了一些环境，</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Cloudflare/image-20220813221231138.png\" alt=\"image-20220813221231138\"></p>\n<p>​\t\t这里还有个 sendRequest，就是指向初次那个 js 的地方</p>\n<p>​\t\t重新捋一下思路，整个的流程如下：<br>\n首次访问返回 503----&gt; 访问 503 指向的 js (会根据 503 页面的 <code>window._cf_chl_ctx</code>  生成一段加密参数作为 post 请求的参数) -&gt; 返回一个长度为 10W 的字符串 (这个会用于生成 vm 代码)，然后这时候，就会进行一系列初始化的过程，在 vm 中校验环境等等然后这时候往 <code>window._cf_chl_ctx</code>  这里面加东西，最终会在发一段比较长的请求，请求成功后，拿到参数 ---&gt; 访问网页</p>\n<blockquote>\n<p>主要的难点在于，如何拿到这个环境对象，如果他检测到了你在调试，他就会返回很少的环境，</p>\n</blockquote>\n<p>这里采用油猴脚本进行 hook，其中关键点其实是在于进入 vm 前后这个环境对象的变化</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">var</span> xxa<span class=\"token operator\">=</span>Function<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function-variable function\">Function</span><span class=\"token operator\">=</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'env obj --->'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>_cf_chl_ctx<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">debugger</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token function\">xxa</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>根据堆栈的信息来看，这玩意经过了很多事件的交互。</p>\n<h4 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结：</h4>\n<p>接下来的话就是漫长的补环境</p>\n",
            "tags": [
                "五秒盾"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/06/01/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%BB%8B%E7%BB%8D/",
            "url": "http://yida506.github.io/2022/06/01/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%BB%8B%E7%BB%8D/",
            "title": "数据挖掘介绍",
            "date_published": "2022-06-01T12:34:27.000Z",
            "content_html": "<h4 id=\"概述\"><a class=\"anchor\" href=\"#概述\">#</a> 概述</h4>\n<h3 id=\"1数据挖掘基本任务\"><a class=\"anchor\" href=\"#1数据挖掘基本任务\">#</a> 1. 数据挖掘基本任务</h3>\n<p>利用分类与预测、聚类分析、关联分析、时序分析、偏差分析、智能推荐等方法，帮助企业提取数据中蕴含的商业价值，提高企业的核心竞争力。</p>\n<h3 id=\"2数据挖掘的建模过程\"><a class=\"anchor\" href=\"#2数据挖掘的建模过程\">#</a> 2. 数据挖掘的建模过程</h3>\n<ul>\n<li>目标定义</li>\n<li>数据采集</li>\n<li>数据整理</li>\n<li>构建模型</li>\n<li>模型评估</li>\n<li>模型上线</li>\n</ul>\n<h4 id=\"21定义挖掘目标\"><a class=\"anchor\" href=\"#21定义挖掘目标\">#</a> 2.1 定义挖掘目标</h4>\n<p>针对不同的数据挖掘应用需求，我们需要了解目标领域的相关知识，熟悉背景知识，弄清客户需求。</p>\n<p>通常来讲，定义目标可以细致的分为任务理解、指标确立这两个步骤。</p>\n<p>这里以电商平台为例来阐述：</p>\n<p>对于任务理解来讲，我们通常希望采取一定的策略使得商家的利润增加、同时也使得消费者满意度增加，达到双赢的效果。</p>\n<p>以消费者的角度来看，我们在购买商品的时候，往往会因为商品数量过多，无法对所有的商品有所了解，因此，如何使得消费者能快速的找到满意的商品对提高消费者的满意度有很高的价值。</p>\n<p>对于商家来讲，不同的消费者往往在购买时往往会有不同的消费习惯，例如，经常购买的往往会一次性买很多，而不经常买的往往会选择一部分先进行观望，这样如果能把这些用户分开，对不同的用户采取不同的营销策略，也可以进一步实现提高用户满意度、利润增加；同时，在不同的季节，消费者购买所关注点也是不同的，若能将其区分开来，同样也可解决商家货供给不足、消费者需求无法很好的满足的问题。</p>\n<p>在经过初步的任务理解后，已经对要做的事有了一个大致的了解，接着就需要对其建立详细的指标，由于指标的建立往往需要实际的业务经验，这里暂时不过多描述。</p>\n<h4 id=\"22-数据取样\"><a class=\"anchor\" href=\"#22-数据取样\">#</a> 2.2 数据取样</h4>\n<p>在明确了数据挖掘的目标后，接下来就是需要获取数据，我们在分析时，不可能拿全部数据进行分析，因为这样耗时耗力，通常采取取样方法，获取样本子集。在取样的同时，还需要特别关注数据的质量，若是数据有误，那么根据数据进行后续操作往往会造成误导，从而得到错误的结论，所以在取样是要注重数据的完整性和有效性。</p>\n<h5 id=\"衡量数据质量指标齐全-数据正常数据不正常往往是服务器等出现问题导致的\"><a class=\"anchor\" href=\"#衡量数据质量指标齐全-数据正常数据不正常往往是服务器等出现问题导致的\">#</a> 衡量数据质量：指标齐全、数据正常 (数据不正常往往是服务器等出现问题导致的)</h5>\n<p>抽样方法采用统计学的抽样方法即可。</p>\n<h4 id=\"23-数据探索\"><a class=\"anchor\" href=\"#23-数据探索\">#</a> 2.3 数据探索</h4>\n<p>在拿到数据后，我们往往会想找到其中的规律，比如各个数据之间有没有什么关联等等，这些都是需要探索的问题。</p>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/05/22/vue%E5%88%9D%E6%8E%A2/",
            "url": "http://yida506.github.io/2022/05/22/vue%E5%88%9D%E6%8E%A2/",
            "title": "vue初探",
            "date_published": "2022-05-22T09:16:53.000Z",
            "content_html": "<h5 id=\"项目模板\"><a class=\"anchor\" href=\"#项目模板\">#</a> 项目模板</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">git</span> clone https://github.com/ElementUI/element-starter.git</pre></td></tr></table></figure><ul>\n<li>yarn 安装依赖</li>\n<li>npm run dev 打开服务</li>\n</ul>\n<h5 id=\"使用教程\"><a class=\"anchor\" href=\"#使用教程\">#</a> 使用教程</h5>\n<p>直接在 app.vue 中编写</p>\n<p>原理应该是相当于，在 html 中 new 一个 vue 对象，给定一个 id, 然后针对这个 id 绑定不同的脚本</p>\n<p>vue 中分为几个部分</p>\n<pre><code class=\"language-vue\">    &lt;template&gt; 部分用于添加模板之类的(需要在声明了id的里面创建)\n    &lt;script&gt; 中添加js,这里export defaul 用于导出方法,使得&lt;template&gt;中可以调用。\n    &lt;style&gt; 控制布局\n</code></pre>\n<h5 id=\"vue对象\"><a class=\"anchor\" href=\"#vue对象\">#</a> vue 对象</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">new</span> <span class=\"token class-name\">Vue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  el<span class=\"token operator\">:</span> <span class=\"token string\">\"#test\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token function-variable function\">render</span><span class=\"token operator\">:</span> <span class=\"token parameter\">h</span> <span class=\"token operator\">=></span> <span class=\"token function\">h</span><span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>需要针对每一个 vue 实例添加绑定的对象</p>\n<ul>\n<li>el 指代的是绑定的对象 这里 #test 表示 id 为 test</li>\n<li>render 表示指向的位置，这里指代的是导入的 test.vue 的对象，同时这里的 h 其实是 createElement 的缩写</li>\n</ul>\n<h5 id=\"style语法介绍\"><a class=\"anchor\" href=\"#style语法介绍\">#</a> style 语法介绍</h5>\n<p>与 css 类似</p>\n<pre><code class=\"language-vue\">&lt;style&gt;\n    #app &#123;\n      font-family: Helvetica, sans-serif;\n      text-align: center;\n    &#125;\n&lt;/style&gt;\n</code></pre>\n<h5 id=\"菜单构建navmenu\"><a class=\"anchor\" href=\"#菜单构建navmenu\">#</a> 菜单构建 NavMenu</h5>\n<p>新起一个文件夹，命名为 config, 在里面加入配置文件</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  clazz<span class=\"token operator\">:</span> <span class=\"token string\">'el-icon-edit'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  name<span class=\"token operator\">:</span> <span class=\"token string\">'基础'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  id<span class=\"token operator\">:</span> <span class=\"token string\">'basic'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  sub<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    name<span class=\"token operator\">:</span> <span class=\"token string\">'管理系统'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    componentName<span class=\"token operator\">:</span> <span class=\"token string\">'BaseLayout'</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    name<span class=\"token operator\">:</span> <span class=\"token string\">'Main 布局容器'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    componentName<span class=\"token operator\">:</span> <span class=\"token string\">'BaseMain'</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  clazz<span class=\"token operator\">:</span> <span class=\"token string\">'el-icon-delete'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  name<span class=\"token operator\">:</span> <span class=\"token string\">'Form'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  id<span class=\"token operator\">:</span> <span class=\"token string\">'form'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  sub<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    name<span class=\"token operator\">:</span> <span class=\"token string\">'Radio 单选框'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    componentName<span class=\"token operator\">:</span> <span class=\"token string\">'BaseRadio'</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    name<span class=\"token operator\">:</span> <span class=\"token string\">'Checkbox 多选框'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    componentName<span class=\"token operator\">:</span> <span class=\"token string\">'BaseCheckbox'</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>这样就可以分离出菜单，然后在此处进行配置，接着在 NavMenu.vue 中导入</p>\n<pre><code class=\"language-vue\"># 这里采取for循环遍历menu,menu需要在script中导入\n&lt;el-submenu v-for=&quot;item in menu&quot; :index=&quot;item.id&quot; :key=&quot;item.id&quot;&gt;\n      &lt;template slot=&quot;title&quot;&gt;\n        &lt;i class=&quot;&quot; :class=&quot;item.clazz&quot;&gt;&lt;/i&gt;\n        &lt;span v-text=&quot;item.name&quot;&gt;&lt;/span&gt;\n      &lt;/template&gt;\n      &lt;el-menu-item-group class=&quot;over-hide&quot; v-for=&quot;sub in item.sub&quot; :key=&quot;sub.componentName&quot;&gt;\n        &lt;el-menu-item :index=&quot;sub.componentName&quot; v-text=&quot;sub.name&quot;&gt;\n        &lt;/el-menu-item&gt;\n      &lt;/el-menu-item-group&gt;\n    &lt;/el-submenu&gt;\n</code></pre>\n<h5 id=\"顶部标题构建topheader\"><a class=\"anchor\" href=\"#顶部标题构建topheader\">#</a> 顶部标题构建 TopHeader</h5>\n<p>采取 el-row 分块，然后选用 vuex 保存全局对象，内置 changecollapse 方法，对 vuex 中的内容进行修改，从而使得菜单栏展开</p>\n<h4 id=\"vue\"><a class=\"anchor\" href=\"#vue\">#</a> vue</h4>\n<p>vue 中的 el-container 默认的是横向布局，若是包含 el-header 或者 el-footer, 就会变为纵向布局 (若设置初始大小，就会自适应)</p>\n<h5 id=\"基础语法\"><a class=\"anchor\" href=\"#基础语法\">#</a> 基础语法</h5>\n<p>v-model: 用于双向绑定<br>\n：表达式，v-bind 的缩写，动态绑定</p>\n<h6 id=\"data\"><a class=\"anchor\" href=\"#data\">#</a> data</h6>\n<p>data 位于 vue 中的 scrpit 部分，主要用于返回数据</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        ruturn</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            msg<span class=\"token operator\">:</span> <span class=\"token number\">123</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>其中 data 用于存储数据</p>\n<h6 id=\"router\"><a class=\"anchor\" href=\"#router\">#</a> router</h6>\n<p>用于切换路由</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> Vue <span class=\"token keyword\">from</span> <span class=\"token string\">'vue'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> Router <span class=\"token keyword\">from</span> <span class=\"token string\">'vue-router'</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> menus <span class=\"token keyword\">from</span> <span class=\"token string\">'@/config/menu-config'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Vue<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>Router<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">var</span> routes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>menus<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  item<span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sub</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    routes<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>sub<span class=\"token punctuation\">.</span>componentName<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      name<span class=\"token operator\">:</span> sub<span class=\"token punctuation\">.</span>componentName<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token function-variable function\">component</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">@/components/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>sub<span class=\"token punctuation\">.</span>componentName<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span> routes <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">// 这样就对路由进行了配置，如果 path 对应的是子菜单的 componentName, 那么就跳转到对应的组件</span></pre></td></tr></table></figure><blockquote>\n<p>在 vue 中需要 &lt;router-view&gt;&lt;/router-view &gt; 引入组件</p>\n</blockquote>\n<ul>\n<li>path: 对应路径</li>\n<li>name: 名字 (可以不要)</li>\n<li>component: 组件所处的位置</li>\n</ul>\n<blockquote>\n<p>可以通过 this.<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mi>o</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi mathvariant=\"normal\">.</mi><mi>p</mi><mi>u</mi><mi>s</mi><mi>h</mi><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><msup><mo>:</mo><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>a</mi><mi>y</mi><mi>o</mi><mi>u</mi><msup><mi>t</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><mo stretchy=\"false\">)</mo><mtext>通过</mtext><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mtext>跳转到对应的路由</mtext><mo separator=\"true\">,</mo><mi>r</mi><mi>o</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>r</mi><mtext>是全局路由</mtext><mi>r</mi><mi>o</mi><mi>u</mi><mi>t</mi><mi>e</mi><mtext>是当前路由</mtext><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">router.push({name:&#x27;baselayout&#x27;}) 通过name跳转到对应的路由, router是全局路由 route是当前路由\nthis.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.001892em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\"><span class=\"mrel\">:</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord cjk_fallback\">通</span><span class=\"mord cjk_fallback\">过</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">e</span><span class=\"mord cjk_fallback\">跳</span><span class=\"mord cjk_fallback\">转</span><span class=\"mord cjk_fallback\">到</span><span class=\"mord cjk_fallback\">对</span><span class=\"mord cjk_fallback\">应</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">路</span><span class=\"mord cjk_fallback\">由</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord cjk_fallback\">是</span><span class=\"mord cjk_fallback\">全</span><span class=\"mord cjk_fallback\">局</span><span class=\"mord cjk_fallback\">路</span><span class=\"mord cjk_fallback\">由</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mord cjk_fallback\">是</span><span class=\"mord cjk_fallback\">当</span><span class=\"mord cjk_fallback\">前</span><span class=\"mord cjk_fallback\">路</span><span class=\"mord cjk_fallback\">由</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">.</span></span></span></span><span class=\"exturl\" data-url=\"aHR0cDovL3JvdXRlLm5hbWU=\">route.name</span><br>\naddRoute 通过改方法添加路由</p>\n</blockquote>\n<h4 id=\"vuex\"><a class=\"anchor\" href=\"#vuex\">#</a> vuex</h4>\n<p>vuex 的版本要和 vue 对应</p>\n<p>在 main.js 中导入 vuex,<br>\n 创建 store 文件夹，编写 Js</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> Vue <span class=\"token keyword\">from</span> <span class=\"token string\">'vue'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> Vuex <span class=\"token keyword\">from</span> <span class=\"token string\">'vuex'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Vue<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>Vuex<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vuex<span class=\"token punctuation\">.</span>Store</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  state<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    title<span class=\"token operator\">:</span> <span class=\"token string\">'hello world'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    userInfo<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      name<span class=\"token operator\">:</span> <span class=\"token string\">'rayfoo'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      age<span class=\"token operator\">:</span> <span class=\"token number\">24</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      car<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Porsche'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'BMW'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  mutations<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token constant\">SET_TITLE</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> _title</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      state<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> _title</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  actions<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  modules<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">// 调用方式</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>$store<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isCollapse</pre></td></tr></table></figure><p>这样就可以直接通过访问 state 中的内容获取全局数据.</p>\n<h5 id=\"state\"><a class=\"anchor\" href=\"#state\">#</a> state</h5>\n<ul>\n<li>与 vue 中的 data () 类似，就是个存数据的地方</li>\n<li>内部的数据无法像 vue 中直接修改，需要在 mutations 修改</li>\n</ul>\n<h5 id=\"mutations\"><a class=\"anchor\" href=\"#mutations\">#</a> mutations</h5>\n<p>mutation 作为修改数据的方法集合，写法类似 vue 中的 methods</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mutations<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token constant\">SET_TITLE</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> _title</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      state<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> _title</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// 这里定义了一个 set_title 方法，第一个参数为 state 必带，</span></pre></td></tr></table></figure><p>在 vue 中调用 SET_TITLE 需要遵循如下写法：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 使用 commit 提交，然后第一个参数跟上方法名</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">changetitle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$store<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SET_TITLE'</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"hello Vuex\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/05/21/%E6%8A%96%E5%BA%97vmp/",
            "url": "http://yida506.github.io/2022/05/21/%E6%8A%96%E5%BA%97vmp/",
            "title": "抖店vmp",
            "date_published": "2022-05-21T11:08:25.000Z",
            "content_html": "<h4 id=\"vmp介绍\"><a class=\"anchor\" href=\"#vmp介绍\">#</a> VMP 介绍</h4>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token string\">\"索引j\"</span><span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">,</span><span class=\"token string\">\"索引O\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\" 值：\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token constant\">S</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key<span class=\"token punctuation\">,</span> value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value <span class=\"token operator\">==</span> window<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">return</span> value<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h1 id=\"jsvmp\"><a class=\"anchor\" href=\"#jsvmp\">#</a> jsvmp</h1>\n<h3 id=\"签名分析\"><a class=\"anchor\" href=\"#签名分析\">#</a> 签名分析</h3>\n<p>签名参数：<br>\n_02B4Z6wo00101loNtfAAAIDDhHvtVmvJQOZaCbFAAPQYwzYkMBmMy0OIRqJQNqhou0eH.DJLTigPioA7TAwBj3B7N1HhHxmv5dJlR1wA5ViS1rIJXRF.2jx88ty4qN9zJEh5kPLfJLRpsdxx14<br>\n 根据插桩日志，可以将上述分为 8 部分<br>\n sign1:loNtf<br>\nsign2:AAAID<br>\nsign3:DhHvtV<br>\nsign4:mvJQO<br>\nsign5:ZaCbF<br>\nsign6:AAPQY<br>\nsign7: wzYk<br>\nsign8: MBmMy0OIRqJQNqhou0eH.DJLTigPioA7TAwBj3B7N1HhHxmv5dJlR1wA5ViS1rIJXRF.2jx88ty4qN9zJEh5kPLfJLRpsdxx<br>\n 最后在对整体的拼接计算一个尾缀</p>\n<h5 id=\"字符索引修改\"><a class=\"anchor\" href=\"#字符索引修改\">#</a> 字符索引修改</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">move_char_calc</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token operator\">&lt;=</span> num <span class=\"token operator\">&amp;&amp;</span> num <span class=\"token operator\">&lt;</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">return</span> num <span class=\"token operator\">+</span> <span class=\"token number\">65</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span> <span class=\"token operator\">&lt;=</span> num <span class=\"token operator\">&amp;&amp;</span> num <span class=\"token operator\">&lt;</span> <span class=\"token number\">52</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">return</span> num <span class=\"token operator\">+</span> <span class=\"token number\">71</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">==</span> <span class=\"token number\">62</span> <span class=\"token operator\">||</span> num <span class=\"token operator\">==</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> num <span class=\"token operator\">-</span> <span class=\"token number\">17</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">return</span> num <span class=\"token operator\">-</span> <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>根据插桩日志的分析，发现在每一个签名计算的过程中，在最后都会进行一个计算，这个值主要是用于修改字符的索引，将不存在的剔除出去</p>\n<h5 id=\"魔改sdbm\"><a class=\"anchor\" href=\"#魔改sdbm\">#</a> 魔改 sdbm</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">sdbmhash</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">strurl<span class=\"token punctuation\">,</span> hash</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span><span class=\"token number\">32</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        hash <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>hash <span class=\"token operator\">*</span> <span class=\"token number\">65599</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>>></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> strurl<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span>hash <span class=\"token operator\">%</span> strurl<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">return</span> hash<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">sdbmhash2</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">strurl<span class=\"token punctuation\">,</span> hash</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>strurl<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        hash <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>hash <span class=\"token operator\">^</span> strurl<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">65599</span> <span class=\"token operator\">>>></span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">return</span> hash<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">sdbmhash3</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">strurl<span class=\"token punctuation\">,</span> hash</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>strurl<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        hash <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>hash <span class=\"token operator\">*</span> <span class=\"token number\">65599</span> <span class=\"token operator\">+</span> strurl<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>>></span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">return</span> hash<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这里包含了三种 sdbm 算法的魔改，主要用于计算不同的 hash 值用于后续计算</p>\n<h5 id=\"sign1\"><a class=\"anchor\" href=\"#sign1\">#</a> sign1</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>offset1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">get_signature1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token keyword\">let</span> now_str <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> index <span class=\"token keyword\">in</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>offset1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token keyword\">let</span> charnum <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>nownumble <span class=\"token operator\">>></span> <span class=\"token number\">2</span> <span class=\"token operator\">>></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>offset1<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                now_str <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token function\">move_char_calc</span><span class=\"token punctuation\">(</span>charnum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sign1:'</span><span class=\"token operator\">+</span>now_str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">return</span> now_str<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这里的 this.nownumble 是由长数字计算出来，长数字是由浏览器 reference, 时间戳，canves 指纹计算得到<br>\n其他 sign 大同小异</p>\n<h5 id=\"sign4\"><a class=\"anchor\" href=\"#sign4\">#</a> sign4</h5>\n<p>sign4,sign5,sign6 都还使用了别的参数进行计算.<br>\nsign4 的参数包含 url 修改后的参数拼接计算以及浏览器 user-agent 的 sdbm 计算</p>\n<h5 id=\"sign8\"><a class=\"anchor\" href=\"#sign8\">#</a> sign8</h5>\n<p>sign8 的计算主要涉及到一个 18 数组的初始化，以及八次变化，同时包含了 cookie 中的 sec_id (AES 加密)</p>\n",
            "tags": [
                "vmp"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/05/14/unidbg/",
            "url": "http://yida506.github.io/2022/05/14/unidbg/",
            "title": "unidbg",
            "date_published": "2022-05-14T11:34:31.000Z",
            "content_html": "<h4 id=\"前提纪要\"><a class=\"anchor\" href=\"#前提纪要\">#</a> 前提纪要</h4>\n<p>在 app 加密中，加密逻辑不单单出现在 java 方法中，也有可能出现在 native 方法中，wiki 中介绍，java native interface 是能将 java 代码运行在 jvm 同时可以让其他语言类似 C,C++ 本机调用的方法。</p>\n<p>同时，在 java 代码中会以如下方式出现：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 加载库</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">loadLibrary</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token namespace\">o00OO<span class=\"token punctuation\">.</span></span>OooO00o<span class=\"token punctuation\">.</span>OooO00o</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">592843821021945178L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">// 加载 Native 方法</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">native</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sign</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"unidbg介绍\"><a class=\"anchor\" href=\"#unidbg介绍\">#</a> Unidbg 介绍</h4>\n<p>unidbg 是一个基于 unicorn 的逆向工具，可以直接调用 Android 和 iOS 中的  <code>so</code>  文件。项目的 GitHub 地址为 https://github.com/zhkl0228/unidbg。</p>\n<blockquote>\n<p>idea 配好 jdk 即可</p>\n</blockquote>\n<p>本质上是 java 可以调用 c 中的方法，那么只要模拟其方法即可。</p>\n<h4 id=\"unidbg使用\"><a class=\"anchor\" href=\"#unidbg使用\">#</a> Unidbg 使用</h4>\n<p>这里以 https://www.qinless.com/1173 提到的为例，在编写对应 java 代码的时候，我们需要先编写伪方法：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>nio<span class=\"token punctuation\">.</span>charset<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StandardCharsets</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> oasis <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">String</span> input1 <span class=\"token operator\">=</span> <span class=\"token string\">\"aid=01A-khBWIm48A079Pz_DMW6PyZR8\"</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                <span class=\"token string\">\"uyTumcCNm4e8awxyC2ANU.&amp;cfrom=28B529501\"</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                <span class=\"token string\">\"0&amp;cuid=5999578300&amp;noncestr=46274W9279Hr1\"</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token string\">\"X49A5X058z7ZVz024&amp;platform=ANDROID&amp;timestamp\"</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token string\">\"=1621437643609&amp;ua=Xiaomi-MIX2S__oasis__3.5.8_\"</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token string\">\"_Android__Android10&amp;version=3.5.8&amp;vid=10190135\"</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token string\">\"94003&amp;wm=20004_90024\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">Boolean</span> input2 <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        oasis test <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token function\">oasis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token class-name\">String</span> sign <span class=\"token operator\">=</span> test<span class=\"token punctuation\">.</span><span class=\"token function\">s</span><span class=\"token punctuation\">(</span>input1<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StandardCharsets</span><span class=\"token punctuation\">.</span>UTF_8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> input2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>sign<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">s</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> barr<span class=\"token punctuation\">,</span> <span class=\"token keyword\">boolean</span> z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Sign\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>就是相当于，先编写一段调用代码，保持与原生 app 调用方法一致，然后将调用 so 的逻辑写进去即可。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">AndroidEmulator</span> emulator<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">VM</span> vm<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Module</span> <span class=\"token keyword\">module</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// 补充构造方法，初始化 jni 啥的</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function\">oasis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">// 创建模拟器实例，进程名建议依照实际进程名填写，可以规避针对进程名的校验</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        emulator <span class=\"token operator\">=</span> <span class=\"token class-name\">AndroidEmulatorBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">for32Bit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setProcessName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.sina.oasis\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 获取模拟器的内存操作接口</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">final</span> <span class=\"token class-name\">Memory</span> memory <span class=\"token operator\">=</span> emulator<span class=\"token punctuation\">.</span><span class=\"token function\">getMemory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 设置系统类库解析</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        memory<span class=\"token punctuation\">.</span><span class=\"token function\">setLibraryResolver</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">AndroidResolver</span><span class=\"token punctuation\">(</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// 创建 Android 虚拟机，传入 APK，Unidbg 可以替我们做部分签名校验的工作</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        vm <span class=\"token operator\">=</span> emulator<span class=\"token punctuation\">.</span><span class=\"token function\">createDalvikVM</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unidbg-android\\\\src\\\\test\\\\java\\\\com\\\\lession1\\\\lvzhou.apk\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">//</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">//        vm = emulator.createDalvikVM(null);</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\">// 加载目标 SO</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token class-name\">DalvikModule</span> dm <span class=\"token operator\">=</span> vm<span class=\"token punctuation\">.</span><span class=\"token function\">loadLibrary</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unidbg-android\\\\src\\\\test\\\\java\\\\com\\\\lession1\\\\liboasiscore.so\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 加载 so 到虚拟内存</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token comment\">// 获取本 SO 模块的句柄，后续需要用它</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">module</span> <span class=\"token operator\">=</span> dm<span class=\"token punctuation\">.</span><span class=\"token function\">getModule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        vm<span class=\"token punctuation\">.</span><span class=\"token function\">setJni</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 设置 JNI</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        vm<span class=\"token punctuation\">.</span><span class=\"token function\">setVerbose</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 打印日志</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        dm<span class=\"token punctuation\">.</span><span class=\"token function\">callJNI_OnLoad</span><span class=\"token punctuation\">(</span>emulator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 调用 JNI OnLoad</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>​\t接着修改调用逻辑里的参数</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getS</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    \t<span class=\"token comment\">// 使用 List 构建参数列表</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// args list</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// arg1 env</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">.</span><span class=\"token function\">getJNIEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">//arg2 jobject/jclazz 一般用不到，直接填 0</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\">// arg3 bytes</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token class-name\">String</span> input <span class=\"token operator\">=</span> <span class=\"token string\">\"xxx\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> inputByte <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StandardCharsets</span><span class=\"token punctuation\">.</span>UTF_8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token class-name\">ByteArray</span> inputByteArray <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ByteArray</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">,</span>inputByte<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">.</span><span class=\"token function\">addLocalObject</span><span class=\"token punctuation\">(</span>inputByteArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">//arg4 ,boolean false 填入 0</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\">// 参数准备完成</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\">//call function 根据地址偏移调用参数 </span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token class-name\">Number</span> number <span class=\"token operator\">=</span> <span class=\"token keyword\">module</span><span class=\"token punctuation\">.</span><span class=\"token function\">callFunction</span><span class=\"token punctuation\">(</span>emulator<span class=\"token punctuation\">,</span> <span class=\"token number\">0xC365</span><span class=\"token punctuation\">,</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">toArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token class-name\">String</span> result <span class=\"token operator\">=</span> vm<span class=\"token punctuation\">.</span><span class=\"token function\">getObject</span><span class=\"token punctuation\">(</span>number<span class=\"token punctuation\">.</span><span class=\"token function\">intValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>这里的前两个参数 env, obj 一般都不用管，由于这里第三个参数是 byte 数组类型，所以要用 unidbg 内置的 ByteArray 实现，然后用 list 包裹进去，最后 list.toArray 封装</p>\n</blockquote>\n<p>整体框架</p>\n<pre><code class=\"language-JAVA\">package com.lession2;\n\n// 导入通用且标准的类库\nimport com.github.unidbg.linux.android.dvm.AbstractJni;\nimport com.github.unidbg.AndroidEmulator;\nimport com.github.unidbg.Module;\nimport com.github.unidbg.linux.android.AndroidEmulatorBuilder;\nimport com.github.unidbg.linux.android.AndroidResolver;\nimport com.github.unidbg.linux.android.dvm.*;\nimport com.github.unidbg.linux.android.dvm.array.ByteArray;\nimport com.github.unidbg.memory.Memory;\nimport com.lession1.oasis;\n\nimport java.io.File;\n\n// 这里的sina是文件名\npublic class sina extends AbstractJni&#123;\n    private final AndroidEmulator emulator;\n    private final VM vm;\n    private final Module module;\n\n    sina() &#123;\n        // 创建模拟器实例,进程名建议依照实际进程名填写，可以规避针对进程名的校验\n        emulator = AndroidEmulatorBuilder.for32Bit().setProcessName(&quot;com.sina.International&quot;).build();\n        // 获取模拟器的内存操作接口\n        final Memory memory = emulator.getMemory();\n        // 设置系统类库解析\n        memory.setLibraryResolver(new AndroidResolver(23));\n        // 创建Android虚拟机,传入APK，Unidbg可以替我们做部分签名校验的工作\n        vm = emulator.createDalvikVM(new File(&quot;unidbg-android\\\\src\\\\test\\\\java\\\\com\\\\lession2\\\\sinaInternational.apk&quot;));\n        //\n//        vm = emulator.createDalvikVM(null);\n\n        // 加载目标SO\n        DalvikModule dm = vm.loadLibrary(new File(&quot;unidbg-android\\\\src\\\\test\\\\java\\\\com\\\\lession2\\\\libutility.so&quot;), true); // 加载so到虚拟内存\n        //获取本SO模块的句柄,后续需要用它\n        module = dm.getModule();\n        vm.setJni(this); // 设置JNI\n        vm.setVerbose(true); // 打印日志\n        // 样本连JNI OnLoad都没有\n        // dm.callJNI_OnLoad(emulator); // 调用JNI OnLoad\n    &#125;;\n\n    public static void main(String[] args) &#123;\n        sina test = new sina();\n        // 这里调用补充的方法\n    &#125;\n    \n    // 这里补充方法\n&#125;\n</code></pre>\n",
            "tags": [
                "unidbg"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/05/03/Ratel/",
            "url": "http://yida506.github.io/2022/05/03/Ratel/",
            "title": "Ratel",
            "date_published": "2022-05-03T06:09:45.000Z",
            "content_html": "<h4 id=\"ratel介绍\"><a class=\"anchor\" href=\"#ratel介绍\">#</a> Ratel 介绍</h4>\n<p>直接 adb install 安装。</p>\n<h6 id=\"app感染\"><a class=\"anchor\" href=\"#app感染\">#</a> app 感染：</h6>\n<p>使用 <code>ratel.bat package </code> 生成被感染的 app 然后 <code>adb install package</code></p>\n<blockquote>\n<p>apk 逻辑可以直接 <code>jadx -e package</code>  导出为 gradle 项目，用 As 看</p>\n</blockquote>\n<h6 id=\"ratel插件开发\"><a class=\"anchor\" href=\"#ratel插件开发\">#</a> Ratel 插件开发</h6>\n<p>模板地址  <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3ZpcmphclJhdGVsL3JhdGVsLW1vZHVsZS10ZW1wbGF0ZS5naXQ=\">https://github.com/virjarRatel/ratel-module-template.git</span></p>\n<ul>\n<li>直接使用模板创建</li>\n</ul>\n<p>template.bat -a &lt;appname&gt; -m &lt;dirname&gt;</p>\n<ul>\n<li>直接用 as 创建工程</li>\n</ul>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//gradle </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>android <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// ...</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>packagingOptions <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>exclude <span class=\"token string\">'META-INF/INDEX.LIST'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>exclude <span class=\"token string\">'META-INF/io.netty.versions.properties'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>dependencies <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">//... 其他的依赖</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">//ratel 核⼼ api</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>compileOnly <span class=\"token string\">'com.virjar:ratel-api:1.3.6'</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">//ratel 的扩展 api，他⼀般是给逆向破解和爬⾍业务使⽤，如果您只是基于 ratel 做⼀个插件，那么⼤多数情况</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>api <span class=\"token string\">'com.virjar:ratel-extersion:1.0.6'</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">//sekiro 项⽬，他可以提供⻓链接 RPC 功能</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>api <span class=\"token string\">'com.virjar:sekiro-api:1.0.3'</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">// AndroidManifest</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token operator\">&lt;</span>meta<span class=\"token operator\">-</span>data android<span class=\"token operator\">:</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"xposedminversion\"</span> android<span class=\"token operator\">:</span>value<span class=\"token operator\">=</span><span class=\"token string\">\"54\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token operator\">&lt;</span>meta<span class=\"token operator\">-</span>data android<span class=\"token operator\">:</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"xposedmodule\"</span> android<span class=\"token operator\">:</span>value<span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token operator\">&lt;</span>meta<span class=\"token operator\">-</span>data android<span class=\"token operator\">:</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"xposeddescription\"</span> android<span class=\"token operator\">:</span>value<span class=\"token operator\">=</span><span class=\"token string\">\"这个描述可以随便写, 会展示在插件列\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">//xposed_init 中 添加入口类</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token class-name\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>yuanrenxue<span class=\"token punctuation\">.</span>ratel<span class=\"token punctuation\">.</span>crack01<span class=\"token punctuation\">.</span></span>HookEntry</span></pre></td></tr></table></figure><blockquote>\n<p>这里面的逻辑都要在 handleLoadPackage 中写</p>\n</blockquote>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handleLoadPackage</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token class-name\">RC_LoadPackage<span class=\"token punctuation\">.</span>LoadPackageParam</span> lpparam<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span>tag<span class=\"token punctuation\">,</span> <span class=\"token string\">\"hook begin\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span>tag<span class=\"token punctuation\">,</span> <span class=\"token string\">\"current pacakage name : \"</span> <span class=\"token operator\">+</span> lpparam<span class=\"token punctuation\">.</span>packageName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   <span class=\"token comment\">//lpparam.packageName 可以输出包名，如果要针包 hook, 就需要 z</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>lpparam<span class=\"token punctuation\">.</span>packageName<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.example.myapplication\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span>tag<span class=\"token punctuation\">,</span> <span class=\"token string\">\"current is in app package\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">addFloatingButtonForActivity</span><span class=\"token punctuation\">(</span>lpparam<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span>tag<span class=\"token punctuation\">,</span> <span class=\"token string\">\"hook end\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"api\"><a class=\"anchor\" href=\"#api\">#</a> api</h4>\n<h5 id=\"hook\"><a class=\"anchor\" href=\"#hook\">#</a> hook</h5>\n<h6 id=\"回调中对参数的操作\"><a class=\"anchor\" href=\"#回调中对参数的操作\">#</a> 回调中对参数的操作</h6>\n<ul>\n<li>\n<p>param.getResult () 获取返回值</p>\n</li>\n<li>\n<p>param.args 对应传参的列表</p>\n</li>\n<li>\n<p>param.thisObject 获取对象</p>\n</li>\n<li>\n<p>RposedHelpers.setObjectField 修改值</p>\n</li>\n<li>\n<p>RposedHelpers.getObjectField 获取值</p>\n</li>\n</ul>\n<h6 id=\"hook-构造方法\"><a class=\"anchor\" href=\"#hook-构造方法\">#</a> HOOK 构造方法</h6>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 类名  + 回调即可</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">RposedBridge</span><span class=\"token punctuation\">.</span><span class=\"token function\">hookAllConstructors</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Dialog</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RC_MethodHook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">afterHookedMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodHookParam</span> param<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">afterHookedMethod</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                        <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span>tag<span class=\"token punctuation\">,</span> <span class=\"token string\">\"show dialog\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Throwable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h6 id=\"hook-类方法\"><a class=\"anchor\" href=\"#hook-类方法\">#</a> Hook 类方法</h6>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 这里跟感染前的类名</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">RposedHelpers</span><span class=\"token punctuation\">.</span><span class=\"token function\">findAndHookMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.example.testratel.SecondActivity\"</span><span class=\"token punctuation\">,</span> lpparam<span class=\"token punctuation\">.</span>classLoader<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                <span class=\"token string\">\"BuildDialog\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">View</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RC_MethodHook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">beforeHookedMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodHookParam</span> param<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">beforeHookedMethod</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                        param<span class=\"token punctuation\">.</span><span class=\"token function\">setResult</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">//                        Object[] args = param.args;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">//                        Log.i(tag, \"args[0]: \" + args[0]);</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">//                    @Override</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">//                    protected void afterHookedMethod(MethodHookParam param) throws Throwable &#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">//                        super.afterHookedMethod(param);</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">////                        Object result = param.getResult();</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">////                        Log.i(tag, \"result: \" );</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">//                    &#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"主动调用\"><a class=\"anchor\" href=\"#主动调用\">#</a> 主动调用</h5>\n<h6 id=\"静态方法\"><a class=\"anchor\" href=\"#静态方法\">#</a> 静态方法</h6>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">RposedHelpers</span><span class=\"token punctuation\">.</span><span class=\"token function\">callStaticMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Class</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> clazz<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> methodName<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> args<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><ul>\n<li>clazz 类实例，可以用 lpparam 自带的 classLoader 拿到</li>\n<li>methodName 方法名</li>\n<li>args 传的参数</li>\n</ul>\n<h6 id=\"类方法\"><a class=\"anchor\" href=\"#类方法\">#</a> 类方法</h6>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">callMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> obj<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> methodName<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> args<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><ul>\n<li>obj 指代的是类实例，要用 <code>RposedHelpers.newInstance(RposedHelpers.findclass(classname))</code>  实例化一下。</li>\n</ul>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/04/23/Android%E5%9F%BA%E7%A1%80/",
            "url": "http://yida506.github.io/2022/04/23/Android%E5%9F%BA%E7%A1%80/",
            "title": "Android基础",
            "date_published": "2022-04-23T14:54:02.000Z",
            "content_html": "<h3 id=\"app介绍\"><a class=\"anchor\" href=\"#app介绍\">#</a> APP 介绍</h3>\n<h5 id=\"hello-world\"><a class=\"anchor\" href=\"#hello-world\">#</a> hello world</h5>\n<p>直接在 android 中创建一个 hello world 项目。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Android%E5%9F%BA%E7%A1%80/image-20220425230616509.png\" alt=\"image-20220425230616509\"></p>\n<p>可以看到包含很多内容，这里的 java 里面有一个应用名称目录，其中包含了 MainActivity,</p>\n<p>Android 项目的资源会被存储在 res 文件夹中。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>myapplication</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">androidx<span class=\"token punctuation\">.</span>appcompat<span class=\"token punctuation\">.</span>app<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AppCompatActivity</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">android<span class=\"token punctuation\">.</span>os<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Bundle</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MainActivity</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AppCompatActivity</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Bundle</span> savedInstanceState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span>savedInstanceState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token function\">setContentView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">R</span><span class=\"token punctuation\">.</span>layout<span class=\"token punctuation\">.</span>activity_main<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>在 MainActivity 中，基础了一个基础的 Activity 类，然后又重写了这个 onCreate 方法，最后设置了 layout.activity_main 为 View.</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Android%E5%9F%BA%E7%A1%80/image-20220425232435459.png\" alt=\"image-20220425232435459\"></p>\n<p>这里编写了 hello world 然后渲染到了 app 主界面上.</p>\n<h6 id=\"点击事件添加\"><a class=\"anchor\" href=\"#点击事件添加\">#</a> 点击事件添加</h6>\n<p>直接修改 TextView 为 Button, 然后添加 id 属性 (&quot;@+id/check&quot;) 即可。</p>\n<p>然后在 MainActivity 中添加如下代码，绑定 button 按钮并添加事件</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Button</span> bt_check <span class=\"token operator\">=</span> <span class=\"token function\">findViewById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">R</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>check<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        bt_check<span class=\"token punctuation\">.</span><span class=\"token function\">setOnClickListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">View<span class=\"token punctuation\">.</span>OnClickListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onClick</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">View</span> view<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"rousue\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hello world from button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"http://pic.ddddhm.cn/Android%E5%9F%BA%E7%A1%80/image-20220426231939847.png\" alt=\"image-20220426231939847\"></p>\n<p>这样一来每次点击在后台返回了日志。</p>\n<h6 id=\"android组成部分\"><a class=\"anchor\" href=\"#android组成部分\">#</a> Android 组成部分</h6>\n<ul>\n<li>Activity 表示层 展示 UI，响应用户动作</li>\n<li>Service 更新数据源和 Activity</li>\n<li>Content Provider 数据储存器</li>\n<li>Intent 消息传递框架</li>\n<li>Broadcast Receiver Intet 监听器</li>\n<li>Widget 可视化组件</li>\n<li>Notification 向用户发起信号</li>\n</ul>\n<blockquote>\n<p>Manifest 存储在最底层，定义应用程序的组件和需求的结构和元数据。</p>\n</blockquote>\n<h5 id=\"activity\"><a class=\"anchor\" href=\"#activity\">#</a> Activity</h5>\n<p>该类为所有用户界面的基础。</p>\n<p>每一个 Activity 都表示一个屏幕，类似 web 中的 html</p>\n<h4 id=\"andriod库\"><a class=\"anchor\" href=\"#andriod库\">#</a> Andriod 库</h4>\n<h6 id=\"okhttp3\"><a class=\"anchor\" href=\"#okhttp3\">#</a> okhttp3:</h6>\n<p>网络请求相关 (类似 requests)</p>\n<h6 id=\"retrofit\"><a class=\"anchor\" href=\"#retrofit\">#</a> retrofit:</h6>\n<p>网络请求相关</p>\n<h6 id=\"rxjava\"><a class=\"anchor\" href=\"#rxjava\">#</a> rxjava:</h6>\n<p>与 retrofit 结合使用</p>\n<h6 id=\"gson\"><a class=\"anchor\" href=\"#gson\">#</a> gson:</h6>\n<p>序列化</p>\n<h3 id=\"android开发\"><a class=\"anchor\" href=\"#android开发\">#</a> Android 开发</h3>\n<h4 id=\"step1\"><a class=\"anchor\" href=\"#step1\">#</a> Step1</h4>\n<h6 id=\"intent\"><a class=\"anchor\" href=\"#intent\">#</a> intent</h6>\n<p>主要用于组件之间的传输，类似从一个 activity 到另一个 activity。</p>\n<p>要实现这种传输，需要实例化 intent 对象。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>btn<span class=\"token punctuation\">.</span><span class=\"token function\">setOnClickListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">View<span class=\"token punctuation\">.</span>OnClickListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onClick</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">View</span> v<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                <span class=\"token function\">setTitle</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"被点击了\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span>TAG<span class=\"token punctuation\">,</span> <span class=\"token string\">\"onClick: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                <span class=\"token comment\">// 实例化 intentd</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                <span class=\"token class-name\">Intent</span> intent <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Intent</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">SecondActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token function\">startActivity</span><span class=\"token punctuation\">(</span>intent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/04/21/Frida/",
            "url": "http://yida506.github.io/2022/04/21/Frida/",
            "title": "Frida",
            "date_published": "2022-04-21T11:51:59.000Z",
            "content_html": "<h4 id=\"frida基础\"><a class=\"anchor\" href=\"#frida基础\">#</a> Frida 基础</h4>\n<h5 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h5>\n<p>需要把 frida-serve push 到对应的 tmp 文件夹中</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>adb push myfs14218 /data/local/tmp/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> adb shell</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token function\">su</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre> <span class=\"token builtin class-name\">cd</span> /data/local/tmp/</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token function\">chmod</span> <span class=\"token number\">777</span> 对应frida-serve的名字</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> ./对应frida-serve的名字+<span class=\"token operator\">&amp;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>//cmd 端口转发</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>adb forward tcp:27043 tcp:27043</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>adb forward tcp:27042 tcp:27042</pre></td></tr></table></figure><h4 id=\"frida介绍\"><a class=\"anchor\" href=\"#frida介绍\">#</a> Frida 介绍</h4>\n<p>frida 操作 app 的方式有两种:</p>\n<ul>\n<li>spawn (调用模式), 通过 frida 启动 app</li>\n<li>attach (附加模式), 对已启动的 app 通过 ptrace 原理注入程序</li>\n</ul>\n<blockquote>\n<p>两种注入方式主要是时机不同</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># spawn</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>frida -U --no-pause -f app -l hook.js</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># attach </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>frida -U -l test.js app</pre></td></tr></table></figure><h5 id=\"hook\"><a class=\"anchor\" href=\"#hook\">#</a> HOOK</h5>\n<p>原理就是在函数运行前，进行动态二进制插桩，很关注时机。</p>\n<h6 id=\"python\"><a class=\"anchor\" href=\"#python\">#</a> python</h6>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> frida</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">on_message</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span> message<span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'send'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[*] &#123;0&#125;\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">[</span><span class=\"token string\">'payload'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>test_signature <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">'''</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tjs代码</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>'''</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># 启动方式 1 attachH 后跟进程名</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>process <span class=\"token operator\">=</span> frida<span class=\"token punctuation\">.</span>get_usb_device<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>attach<span class=\"token punctuation\">(</span><span class=\"token string\">'com.chaozhuo.texteditor'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>script <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>create_script<span class=\"token punctuation\">(</span>test_signature<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>script<span class=\"token punctuation\">.</span>on<span class=\"token punctuation\">(</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">,</span> on_message<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>script<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>sys<span class=\"token punctuation\">.</span>stdin<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>本质上写 Js 代码即可。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>process <span class=\"token operator\">=</span> frida<span class=\"token punctuation\">.</span>get_usb_device<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>enumerate_processes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#可以查看当前运行的进程名</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>也可以直接 adb 查看进程，这里条件可以任意，为 com.xxx 皆可，目的是缩小范围.</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>adb shell <span class=\"token string\">\"ps | grep 条件\"</span></pre></td></tr></table></figure><h6 id=\"重载的代码hook\"><a class=\"anchor\" href=\"#重载的代码hook\">#</a> 重载的代码 hook</h6>\n<p><img data-src=\"http://pic.ddddhm.cn/Frida/image-20220423112839478.png\" alt=\"image-20220423112839478\"></p>\n<p>以该处为例，该类中有两个 a 方法，我们只想 hook 上面一个，直接写就会报错。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/Frida/image-20220423113034693.png\" alt=\"image-20220423113034693\"></p>\n<p>这样，我们只需要等他报错后，修改代码即可。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 加上.overload ('a.u$a')</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Signature<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">.</span><span class=\"token function\">overload</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a.u$a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">implementation</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">val</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'enter a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">a</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>以上是对于调用的函数进行 hook，得到的，还有一种情况，就是方法没有被调用，我们想查看他的方法，拿到其结果，那么我们可以采用 Java.choose (类名 + 回调)。</p>\n<p>也可以考虑直接编写 js 脚本进行 frida.</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>// 打印出当前手机上的进程</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>frida-ps -Ua</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>//后面的是进程名，只需要在jsl</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>frida -U -l test.js com.example.simpleencryption</pre></td></tr></table></figure><h4 id=\"objection\"><a class=\"anchor\" href=\"#objection\">#</a> Objection</h4>\n<p>Objection 本质上是 frida 的一种工具实现，可以通过命令行输出，实现 frida 交互过程，达到类调用，hook 的目的。</p>\n<h6 id=\"安装-2\"><a class=\"anchor\" href=\"#安装-2\">#</a> 安装</h6>\n<p>由于 frida 版本是 14.1.3，直接 pip install objection 即可</p>\n<h6 id=\"使用\"><a class=\"anchor\" href=\"#使用\">#</a> 使用</h6>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>// 注入代码</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>objection -g 进程名 explore  --startup-command <span class=\"token string\">\"android root disable\"</span> <span class=\"token operator\">&lt;</span>在启动前注入命令<span class=\"token operator\">></span></pre></td></tr></table></figure><ol>\n<li>寻找包名 frida-ps -U | grep 参数</li>\n<li>Objection 注入</li>\n<li>android hooking search classes [类名]</li>\n<li>android hooking search methods &lt;key&gt;[关键词] (从所有内存中加载)</li>\n<li>android hooking list class methods 包名 + 类名 (列出所有的方法)</li>\n<li>android hooking list 组件</li>\n<li>android hooking watch class_method &lt;methodName&gt;(hook 指定方法) --dump-args --dump-backtrace --dump-return</li>\n<li>jobs list (查看作业，显示 hook 的函数的信息)</li>\n<li>job kill &lt;id&gt; 删除作业</li>\n<li>memory list modules</li>\n</ol>\n<blockquote>\n<p>如果要 hook 构造方法 需要使用 $init</p>\n</blockquote>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/04/19/%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/",
            "url": "http://yida506.github.io/2022/04/19/%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/",
            "title": "静态分析",
            "date_published": "2022-04-19T13:44:34.000Z",
            "content_html": "<h4 id=\"jadx使用\"><a class=\"anchor\" href=\"#jadx使用\">#</a> jadx 使用</h4>\n<p>直接用 jadx 打开 apk。</p>\n<h4 id=\"静态分析\"><a class=\"anchor\" href=\"#静态分析\">#</a> 静态分析</h4>\n<h5 id=\"1代码搜索\"><a class=\"anchor\" href=\"#1代码搜索\">#</a> 1. 代码搜索</h5>\n<p><img data-src=\"http://pic.ddddhm.cn/%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/image-20220419214843370.png\" alt=\"image-20220419214843370\"></p>\n<p>activity 里面包含主要代码。其中在 main 之前的为主界面代码，这里只有 mainActivity.</p>\n<p><img data-src=\"http://pic.ddddhm.cn/%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/image-20220419215044951.png\" alt=\"image-20220419215044951\"></p>\n<p>onCreate、onClick 为事件。</p>\n<h4 id=\"frida\"><a class=\"anchor\" href=\"#frida\">#</a> Frida</h4>\n<h5 id=\"启动\"><a class=\"anchor\" href=\"#启动\">#</a> 启动：</h5>\n<p>连接到手机后，进入安装 frida-serve 的位置</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>adb shell</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token function\">su</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token builtin class-name\">cd</span> /data/local/tmp/</pre></td></tr></table></figure><p>ps -A | grep com</p>\n<p>com 指代的是过滤条件，该指令可以展示当前进程名，也对应下图 xml 中的 package 名。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/image-20220419221411727.png\" alt=\"image-20220419221411727\"></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> frida</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#模板</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">on_message</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span> message<span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'send'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[*] &#123;0&#125;\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">[</span><span class=\"token string\">'payload'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#这里写要 hook 代码</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>test_t<span class=\"token operator\">=</span><span class=\"token triple-quoted-string string\">'''</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>Java.perform(</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    function()&#123;</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        var MainActivity = Java.use('com.example.seccon2015.rock_paper_scissors.MainActivity')</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        MainActivity.onClick.implementation = function(val)&#123;</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            console.log('mmmm:'+this.m.value);</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            console.log(this.n.value);</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            this.onClick(val);</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        &#125;;</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        #下面是匿名类的hook方法,这里要把他自带的.改为$</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>         var test = Java.use('com.example.seccon2015.rock_paper_scissors.MainActivity$1')</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        test.run.implementation = function()&#123;</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            console.log('this is test');</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            this.run();</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        &#125;</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    &#125;</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>)</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>'''</pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\">#模板</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\">#启动方式 1 attachH 后跟进程名</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>process <span class=\"token operator\">=</span> frida<span class=\"token punctuation\">.</span>get_usb_device<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>attach<span class=\"token punctuation\">(</span><span class=\"token string\">'com.example.seccon2015.rock_paper_scissors'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>script <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>create_script<span class=\"token punctuation\">(</span>test_t<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>script<span class=\"token punctuation\">.</span>on<span class=\"token punctuation\">(</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">,</span> on_message<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>script<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>sys<span class=\"token punctuation\">.</span>stdin<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>匿名类可以通过 smali 代码判断。</p>\n<p>在匿名函数访问外部类：<br>\nthis.this$0.value.xxx.value</p>\n<pre><code>\n#打印调用堆栈\nfunction printstack()&#123;\n    console.log(Java.use(&quot;android.util.Log&quot;).getStackTraceString(Java.use(&quot;java.lang.Exception&quot;).$new()));\n&#125;\n</code></pre>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/04/03/app%E5%85%A5%E9%97%A8/",
            "url": "http://yida506.github.io/2022/04/03/app%E5%85%A5%E9%97%A8/",
            "title": "app入门",
            "date_published": "2022-04-03T13:43:10.000Z",
            "content_html": "<h4 id=\"刷机\"><a class=\"anchor\" href=\"#刷机\">#</a> 刷机</h4>\n<p>手机选择 nexus 5</p>\n<h6 id=\"刷机包下载不同手机有不同的镜像\"><a class=\"anchor\" href=\"#刷机包下载不同手机有不同的镜像\">#</a> 刷机包下载 (不同手机有不同的镜像)：</h6>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vYW5kcm9pZC9pbWFnZXMjYnVsbGhlYWQ=\">https://developers.google.com/android/images#bullhead</span></p>\n<p>选择版本 OPM1.171019.011, Dec 2017</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zb3VyY2UuYW5kcm9pZC5jb20vc2V0dXAvc3RhcnQvYnVpbGQtbnVtYmVycyNzb3VyY2UtY29kZS10YWdzLWFuZC1idWlsZHM=\">https://source.android.com/setup/start/build-numbers#source-code-tags-and-builds</span></p>\n<blockquote>\n<p>pixel 8.0.0 貌似会使得后面用 frida 有小问题</p>\n</blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jbi9hbmRyb2lkL2ltYWdlcw==\">https://developers.google.cn/android/images</span></p>\n<h6 id=\"电脑驱动更新\"><a class=\"anchor\" href=\"#电脑驱动更新\">#</a> 电脑驱动更新</h6>\n<p>**win10 需要更新 google usb driver **</p>\n<blockquote>\n<p><img data-src=\"http://pic.ddddhm.cn/app%E5%85%A5%E9%97%A8/image-20220417122821654.png\" alt=\"image-20220417122821654\"></p>\n</blockquote>\n<p>然后到 bootloader 界面直接运行</p>\n<p><img data-src=\"http://pic.ddddhm.cn/app%E5%85%A5%E9%97%A8/image-20220417135832286.png\" alt=\"image-20220417135832286\"></p>\n<p>即可</p>\n<p>时间同步</p>\n<pre><code>adb shell settings put global captive_portal_http_url https://www.google.cn/generate_204\n\nadb shell settings put global captive_portal_https_url https://www.google.cn/generate_204\n\nadb shell settings put global global ntp_server 1.hk.pool.ntp.org\n\nadb shell reboot\n</code></pre>\n<h4 id=\"root\"><a class=\"anchor\" href=\"#root\">#</a> ROOT</h4>\n<p>​\t\t参考文兄的 <span class=\"exturl\" data-url=\"aHR0cDovL2Jsb2cud2VuMmdvLnNpdGUvMjAyMS8xMi8wMy8yMDIxMTIwMy8=\">http://blog.wen2go.site/2021/12/03/20211203/</span></p>\n<p>去下一个 TWRP 镜像，</p>\n<p>然后用 fastboot flash  recovery twrp 镜像推送镜像 ，然后从 bootloaders 界面进去 recovery 分区，安装 twrp</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3RvcGpvaG53dS9NYWdpc2svcmVsZWFzZXMvdGFnL3YyMC40\">https://github.com/topjohnwu/Magisk/releases/tag/v20.4</span></p>\n<blockquote>\n<p>nexus5 和 pixel2 xl 的方式不同，pixel2 不自带 recovery 分区，需要先刷临时分区。</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>// 刷入临时镜像</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>fastboot flash boot twrp-3.6.0_9-0-taimen.img</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>//重启后进入twrp</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>fastboot <span class=\"token function\">reboot</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>// 乱码要格式化dataf</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>adb push twrp-installer-3.6.0_9-0-taimen.zip /sdcard/</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>adb push Magisk-v20.4.zip /sdcard/</pre></td></tr></table></figure><p>下载 magisk 包</p>\n<p>然后通过 adb push Magisk-v20.4.zip/sdcard/ 推送到手机上</p>\n<p>这里 sdcard 指代的是默认目录。</p>\n<p>然后通过 twrp 的 install 找到传输过来的 zip 进行安装。</p>\n<blockquote>\n<p>对于 pxel 需要安装完永久的 twrp 后，点击上面的按钮在安装 magisk</p>\n</blockquote>\n<p><img data-src=\"http://pic.ddddhm.cn/app%E5%85%A5%E9%97%A8/image-20220417144216066.png\" alt=\"image-20220417144216066\"></p>\n<p>adb shell 连接手机，su 是进入 root 权限.</p>\n<blockquote>\n<p>pixel2 分区在输入 magisk 时貌似有兼容错误，</p>\n<p>adb sideload Magisk-v20.0.zip。</p>\n</blockquote>\n<h4 id=\"frida安装\"><a class=\"anchor\" href=\"#frida安装\">#</a> Frida 安装</h4>\n<h5 id=\"frida-serve安装\"><a class=\"anchor\" href=\"#frida-serve安装\">#</a> frida-serve 安装</h5>\n<p>下载对应版本的 frida-serve (14.1.3)</p>\n<h5 id=\"电脑端\"><a class=\"anchor\" href=\"#电脑端\">#</a> 电脑端</h5>\n<p>直接 pip 安装 有点慢 会卡在 setup 处</p>\n<p>然后安装 frida-tools 版本要对应</p>\n<p>接着暗转 frida-server push 到手机上</p>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/03/21/%E6%8A%96%E9%9F%B3web/",
            "url": "http://yida506.github.io/2022/03/21/%E6%8A%96%E9%9F%B3web/",
            "title": "抖音web",
            "date_published": "2022-03-21T13:21:53.000Z",
            "content_html": "<p>mysql+redis</p>\n<h4 id=\"tcp协议\"><a class=\"anchor\" href=\"#tcp协议\">#</a> TCP 协议</h4>\n<p>需要建立三次握手，断开需要建立四次握手。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/%E6%8A%96%E9%9F%B3web/image-20220326225236374.png\" alt=\"image-20220326225236374\"></p>\n<p>连接过程：Client (客户端) 发送连接请求 SYN 报文，Server 段接受连接后回复 ACK 报文，然后分配资源，客户端接收 ACK 报文后，也向服务端发送 ACK 报文，分配资源，然后就建立了 TCP 连接</p>\n<p>断开连接：客户端发送 FIN 报文，假如数据还没传完，服务端继续发送 ACK 报文，之后在发送 FIN 报文给客户端，然后客户端再发 ACK 报文回来 (告诉服务器可以关闭了)，然后就关闭了 TCP 连接。</p>\n<h4 id=\"websocket协议\"><a class=\"anchor\" href=\"#websocket协议\">#</a> WebSocket 协议</h4>\n<p>实现了浏览器与服务器全双工通信 (full-duplex)。只需要建立一次连接，就可以一直保持连接状态，并且前后端可以互相通信，不再是单向的了。</p>\n<blockquote>\n<p>简单来讲，就是可以直接搭建起双向连接机制，</p>\n</blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZWdyZXAvcC85NTQ2Mjc1Lmh0bWw=\">WebSocket 的原理，及如何测试 websocket 是否连接成功 - Egrep - 博客园 (cnblogs.com)</span></p>\n<h4 id=\"目标网站\"><a class=\"anchor\" href=\"#目标网站\">#</a> 目标网站</h4>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZG91eWluLmNvbS91c2VyL01TNHdMakFCQUFBQWVISjQxc01MSlF2MDZLRkktUHlxeG9jb2lwQmw1QUtoRVY4RVJPcDdIWlU=\">https://www.douyin.com/user/MS4wLjABAAAAeHJ41sMLJQv06KFI-PyqxocoipBl5AKhEV8EROp7HZU</span></p>\n<p>RPC 注入：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">SekiroClient</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">wsURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wsURL <span class=\"token operator\">=</span> wsURL<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handlers <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// check</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>wsURL<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wsURL can not be empty!!'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>webSocketFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">resolveWebSocketFactory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">resolveWebSocketFactory</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> window <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">var</span> theWebSocket <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>WebSocket <span class=\"token operator\">?</span> window<span class=\"token punctuation\">.</span>WebSocket <span class=\"token operator\">:</span> window<span class=\"token punctuation\">.</span>MozWebSocket<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">wsURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">function</span> <span class=\"token function\">WindowWebSocketWrapper</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">wsURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">theWebSocket</span><span class=\"token punctuation\">(</span>wsURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">close</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmessage</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">onMessageFunction</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket<span class=\"token punctuation\">.</span>onmessage <span class=\"token operator\">=</span> onMessageFunction<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onopen</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">onOpenFunction</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket<span class=\"token punctuation\">.</span>onopen <span class=\"token operator\">=</span> onOpenFunction<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclose</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">onCloseFunction</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket<span class=\"token punctuation\">.</span>onclose <span class=\"token operator\">=</span> onCloseFunction<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">send</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">(</span>wsURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> weex <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token comment\">// this is weex env : https://weex.apache.org/zh/docs/modules/websockets.html</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test webSocket for weex\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token keyword\">var</span> ws <span class=\"token operator\">=</span> weex<span class=\"token punctuation\">.</span><span class=\"token function\">requireModule</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webSocket'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"find webSocket for weex:\"</span> <span class=\"token operator\">+</span> ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">wsURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>                    ws<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                ws<span class=\"token punctuation\">.</span><span class=\"token function\">WebSocket</span><span class=\"token punctuation\">(</span>wsURL<span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                <span class=\"token keyword\">return</span> ws<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            <span class=\"token comment\">//ignore</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token comment\">//TODO support ReactNative</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> WebSocket <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">wsURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">theWebSocket</span><span class=\"token punctuation\">(</span>wsURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token comment\">// weex å’Œ PCçŽ¯å¢ƒçš„websocket APIä¸å®Œå…¨ä¸€è‡´ï¼Œæ‰€ä»¥åšäº†æŠ½è±¡å…¼å®¹</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the js environment do not support websocket\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre></pre></td></tr><tr><td data-num=\"73\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">connect</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sekiro: begin of connect to wsURL: '</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wsURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    <span class=\"token keyword\">var</span> _this <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    <span class=\"token comment\">// ä¸check closeï¼Œè®©</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token comment\">// if (this.socket &amp;&amp; this.socket.readyState === 1) &#123;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token comment\">//     this.socket.close();</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token comment\">// &#125;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">webSocketFactory</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wsURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sekiro: create connection failed,reconnect after 2s\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>            _this<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">onmessage</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>        _this<span class=\"token punctuation\">.</span><span class=\"token function\">handleSekiroRequest</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">onopen</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sekiro: open a sekiro client connection'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">onclose</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sekiro: disconnected ,reconnection after 2s'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>        <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>            _this<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre></pre></td></tr><tr><td data-num=\"105\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">handleSekiroRequest</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">requestJson</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"receive sekiro request: \"</span> <span class=\"token operator\">+</span> requestJson<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>    <span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>requestJson<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>    <span class=\"token keyword\">var</span> seq <span class=\"token operator\">=</span> request<span class=\"token punctuation\">[</span><span class=\"token string\">'__sekiro_seq__'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>request<span class=\"token punctuation\">[</span><span class=\"token string\">'action'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">sendFailed</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> <span class=\"token string\">'need request param &#123;action&#125;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>        <span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>    <span class=\"token keyword\">var</span> action <span class=\"token operator\">=</span> request<span class=\"token punctuation\">[</span><span class=\"token string\">'action'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handlers<span class=\"token punctuation\">[</span>action<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">sendFailed</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> <span class=\"token string\">'no action handler: '</span> <span class=\"token operator\">+</span> action <span class=\"token operator\">+</span> <span class=\"token string\">' defined'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>        <span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>    <span class=\"token keyword\">var</span> theHandler <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handlers<span class=\"token punctuation\">[</span>action<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>    <span class=\"token keyword\">var</span> _this <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>        <span class=\"token function\">theHandler</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>                _this<span class=\"token punctuation\">.</span><span class=\"token function\">sendSuccess</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>                _this<span class=\"token punctuation\">.</span><span class=\"token function\">sendFailed</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> <span class=\"token string\">\"e:\"</span> <span class=\"token operator\">+</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">errorMessage</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>            _this<span class=\"token punctuation\">.</span><span class=\"token function\">sendFailed</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> errorMessage<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error: \"</span> <span class=\"token operator\">+</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>        _this<span class=\"token punctuation\">.</span><span class=\"token function\">sendFailed</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre></pre></td></tr><tr><td data-num=\"138\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">sendSuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">seq<span class=\"token punctuation\">,</span> response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>    <span class=\"token keyword\">var</span> responseJson<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> response <span class=\"token operator\">==</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>            responseJson <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>            responseJson <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>            responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> response<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> response <span class=\"token operator\">==</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>        responseJson <span class=\"token operator\">=</span> response<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>        responseJson <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>        responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> response<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre></pre></td></tr><tr><td data-num=\"154\"></td><td><pre></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>responseJson<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>        responseJson <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>            data<span class=\"token operator\">:</span> responseJson<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>            code<span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>        responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'code'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>        responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>        responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>    responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'__sekiro_seq__'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>    <span class=\"token keyword\">var</span> responseText <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>responseJson<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"response :\"</span> <span class=\"token operator\">+</span> responseText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>responseText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre></pre></td></tr><tr><td data-num=\"175\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">sendFailed</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">seq<span class=\"token punctuation\">,</span> errorMessage</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> errorMessage <span class=\"token operator\">!=</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>        errorMessage <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>errorMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>    <span class=\"token keyword\">var</span> responseJson <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>    responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> errorMessage<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>    responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>    responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'__sekiro_seq__'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>    <span class=\"token keyword\">var</span> responseText <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>responseJson<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sekiro: response :\"</span> <span class=\"token operator\">+</span> responseText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>responseText<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre></pre></td></tr><tr><td data-num=\"188\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">registerAction</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">action<span class=\"token punctuation\">,</span> handler</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> action <span class=\"token operator\">!==</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"an action must be string\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> handler <span class=\"token operator\">!==</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a handler must be function\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sekiro: register action: \"</span> <span class=\"token operator\">+</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handlers<span class=\"token punctuation\">[</span>action<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> handler<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">guid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>            <span class=\"token keyword\">function</span> <span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>                  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">+</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">0x10000</span><span class=\"token punctuation\">)</span><span class=\"token operator\">|</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre><span class=\"token keyword\">var</span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ws://127.0.0.1:5620/business-demo/register?group=dy&amp;clientId=\"</span><span class=\"token operator\">+</span><span class=\"token function\">guid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>client<span class=\"token punctuation\">.</span><span class=\"token function\">registerAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"getSignature\"</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">request<span class=\"token punctuation\">,</span> resolve<span class=\"token punctuation\">,</span>reject</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"209\"></td><td><pre>    <span class=\"token keyword\">let</span> pageurl <span class=\"token operator\">=</span> <span class=\"token string\">'/aweme/v1/web/aweme/post/?device_platform=webapp&amp;aid=6383&amp;channel=channel_pc_web&amp;sec_user_id=MS4wLjABAAAAGyky76MpsaNiuI6tNX0dogABIPR8P_Od0YV7cGD_9P0&amp;max_cursor=1645674431000&amp;locate_query=false&amp;count=10&amp;publish_video_strategy_type=2&amp;version_code=170400&amp;version_name=17.4.0&amp;cookie_enabled=true&amp;screen_width=1920&amp;screen_height=1080&amp;browser_language=en-US&amp;browser_platform=Win32&amp;browser_name=Chrome&amp;browser_version=99.0.4844.74&amp;browser_online=true&amp;engine_name=Blink&amp;engine_version=99.0.4844.74&amp;os_name=Windows&amp;os_version=10&amp;cpu_core_num=8&amp;device_memory=8&amp;platform=PC&amp;downlink=10&amp;effective_type=4g&amp;round_trip_time=50&amp;webid=7077786468781164044'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre></pre></td></tr><tr><td data-num=\"211\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function\">sendAjax</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">url</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre>                <span class=\"token keyword\">let</span> xhr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XMLHttpRequest</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre></pre></td></tr><tr><td data-num=\"214\"></td><td><pre>                xhr<span class=\"token punctuation\">.</span>responseType <span class=\"token operator\">=</span> <span class=\"token string\">\"json\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>                xhr<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'get'</span><span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre>                xhr<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>                    <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>xhr<span class=\"token punctuation\">[</span><span class=\"token string\">'response'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'aweme_list'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre>                    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>status <span class=\"token operator\">==</span> <span class=\"token number\">200</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>status <span class=\"token operator\">==</span> <span class=\"token number\">304</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>                            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>xhr<span class=\"token punctuation\">.</span>responseURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre>                            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>xhr<span class=\"token punctuation\">.</span>responseType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre>                            <span class=\"token keyword\">return</span> xhr<span class=\"token punctuation\">[</span><span class=\"token string\">'response'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre>                xhr<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"225\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"226\"></td><td><pre>    <span class=\"token function\">sendAjax</span><span class=\"token punctuation\">(</span>pageurl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"227\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": [
                "rpc"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/03/20/jsrpc/",
            "url": "http://yida506.github.io/2022/03/20/jsrpc/",
            "title": "jsrpc",
            "date_published": "2022-03-20T08:31:07.000Z",
            "content_html": "<h4 id=\"jsrpc\"><a class=\"anchor\" href=\"#jsrpc\">#</a> JSRPC</h4>\n<p>安装 websocket 服务</p>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>npm install nodejs-websocket</pre></td></tr></table></figure><figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> ws <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"nodejs-websocket\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">var</span> _server <span class=\"token operator\">=</span> ws<span class=\"token punctuation\">.</span><span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">conn</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token comment\">// 接收客户端返回的数据</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tconn<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">str</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">,</span> <span class=\"token string\">\"接收客户端传过来的值\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\">// 客户端关闭连接</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tconn<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"close\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\tconn<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token comment\">//error</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> <span class=\"token string\">\"连接报错\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">const</span> port <span class=\"token operator\">=</span> <span class=\"token number\">8015</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>_server<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"连接成功\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'listening on websocketServer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>建立连接后，就可以用 python 和浏览器来回传递信息</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> websocket</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ws <span class=\"token operator\">=</span> websocket<span class=\"token punctuation\">.</span>WebSocketApp<span class=\"token punctuation\">(</span><span class=\"token string\">'ws://127.0.0.1:8015'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">on_message</span><span class=\"token punctuation\">(</span>ws<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span> message<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'_'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token string\">'js'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>ws<span class=\"token punctuation\">.</span>on_message <span class=\"token operator\">=</span> on_message</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>ws<span class=\"token punctuation\">.</span>run_forever<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>浏览器注入，建立通信</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>WebSocket<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\tws <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebSocket</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ws://127.0.0.1:8015/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\tws<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onopen</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tws<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclose</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'服务器关闭'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tws<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'连接出错'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\tws<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmessage</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>注入后和 js 的 websocketServer 建立了双向连接，然后就形成了通信。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/jsrpc/image-20220320171420496.png\" alt=\"image-20220320171420496\"></p>\n<p>这样，就可以在浏览器中通过 send，进行调用。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">SekiroClient</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">wsURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wsURL <span class=\"token operator\">=</span> wsURL<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handlers <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// check</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>wsURL<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wsURL can not be empty!!'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>webSocketFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">resolveWebSocketFactory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">resolveWebSocketFactory</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> window <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">var</span> theWebSocket <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>WebSocket <span class=\"token operator\">?</span> window<span class=\"token punctuation\">.</span>WebSocket <span class=\"token operator\">:</span> window<span class=\"token punctuation\">.</span>MozWebSocket<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">wsURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">function</span> <span class=\"token function\">WindowWebSocketWrapper</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">wsURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">theWebSocket</span><span class=\"token punctuation\">(</span>wsURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">close</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmessage</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">onMessageFunction</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket<span class=\"token punctuation\">.</span>onmessage <span class=\"token operator\">=</span> onMessageFunction<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onopen</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">onOpenFunction</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket<span class=\"token punctuation\">.</span>onopen <span class=\"token operator\">=</span> onOpenFunction<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclose</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">onCloseFunction</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket<span class=\"token punctuation\">.</span>onclose <span class=\"token operator\">=</span> onCloseFunction<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">send</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mSocket<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WindowWebSocketWrapper</span><span class=\"token punctuation\">(</span>wsURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> weex <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token comment\">// this is weex env : https://weex.apache.org/zh/docs/modules/websockets.html</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test webSocket for weex\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token keyword\">var</span> ws <span class=\"token operator\">=</span> weex<span class=\"token punctuation\">.</span><span class=\"token function\">requireModule</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webSocket'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"find webSocket for weex:\"</span> <span class=\"token operator\">+</span> ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">wsURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>                    ws<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                ws<span class=\"token punctuation\">.</span><span class=\"token function\">WebSocket</span><span class=\"token punctuation\">(</span>wsURL<span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                <span class=\"token keyword\">return</span> ws<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            <span class=\"token comment\">//ignore</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token comment\">//TODO support ReactNative</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> WebSocket <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">wsURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">theWebSocket</span><span class=\"token punctuation\">(</span>wsURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token comment\">// weex å’Œ PCçŽ¯å¢ƒçš„websocket APIä¸å®Œå…¨ä¸€è‡´ï¼Œæ‰€ä»¥åšäº†æŠ½è±¡å…¼å®¹</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the js environment do not support websocket\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre></pre></td></tr><tr><td data-num=\"73\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">connect</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sekiro: begin of connect to wsURL: '</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wsURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    <span class=\"token keyword\">var</span> _this <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    <span class=\"token comment\">// ä¸check closeï¼Œè®©</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token comment\">// if (this.socket &amp;&amp; this.socket.readyState === 1) &#123;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token comment\">//     this.socket.close();</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token comment\">// &#125;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">webSocketFactory</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wsURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sekiro: create connection failed,reconnect after 2s\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>            _this<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">onmessage</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>        _this<span class=\"token punctuation\">.</span><span class=\"token function\">handleSekiroRequest</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">onopen</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sekiro: open a sekiro client connection'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">onclose</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sekiro: disconnected ,reconnection after 2s'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>        <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>            _this<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre></pre></td></tr><tr><td data-num=\"105\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">handleSekiroRequest</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">requestJson</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"receive sekiro request: \"</span> <span class=\"token operator\">+</span> requestJson<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>    <span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>requestJson<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>    <span class=\"token keyword\">var</span> seq <span class=\"token operator\">=</span> request<span class=\"token punctuation\">[</span><span class=\"token string\">'__sekiro_seq__'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>request<span class=\"token punctuation\">[</span><span class=\"token string\">'action'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">sendFailed</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> <span class=\"token string\">'need request param &#123;action&#125;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>        <span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>    <span class=\"token keyword\">var</span> action <span class=\"token operator\">=</span> request<span class=\"token punctuation\">[</span><span class=\"token string\">'action'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handlers<span class=\"token punctuation\">[</span>action<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">sendFailed</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> <span class=\"token string\">'no action handler: '</span> <span class=\"token operator\">+</span> action <span class=\"token operator\">+</span> <span class=\"token string\">' defined'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>        <span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>    <span class=\"token keyword\">var</span> theHandler <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handlers<span class=\"token punctuation\">[</span>action<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>    <span class=\"token keyword\">var</span> _this <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>        <span class=\"token function\">theHandler</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>                _this<span class=\"token punctuation\">.</span><span class=\"token function\">sendSuccess</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>                _this<span class=\"token punctuation\">.</span><span class=\"token function\">sendFailed</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> <span class=\"token string\">\"e:\"</span> <span class=\"token operator\">+</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">errorMessage</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>            _this<span class=\"token punctuation\">.</span><span class=\"token function\">sendFailed</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> errorMessage<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error: \"</span> <span class=\"token operator\">+</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>        _this<span class=\"token punctuation\">.</span><span class=\"token function\">sendFailed</span><span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre></pre></td></tr><tr><td data-num=\"138\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">sendSuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">seq<span class=\"token punctuation\">,</span> response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>    <span class=\"token keyword\">var</span> responseJson<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> response <span class=\"token operator\">==</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>            responseJson <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>            responseJson <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>            responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> response<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> response <span class=\"token operator\">==</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>        responseJson <span class=\"token operator\">=</span> response<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>        responseJson <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>        responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> response<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre></pre></td></tr><tr><td data-num=\"154\"></td><td><pre></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>responseJson<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>        responseJson <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>            data<span class=\"token operator\">:</span> responseJson<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>            code<span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>        responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'code'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>        responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>        responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>    responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'__sekiro_seq__'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>    <span class=\"token keyword\">var</span> responseText <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>responseJson<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"response :\"</span> <span class=\"token operator\">+</span> responseText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>responseText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre></pre></td></tr><tr><td data-num=\"175\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">sendFailed</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">seq<span class=\"token punctuation\">,</span> errorMessage</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> errorMessage <span class=\"token operator\">!=</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>        errorMessage <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>errorMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>    <span class=\"token keyword\">var</span> responseJson <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>    responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> errorMessage<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>    responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>    responseJson<span class=\"token punctuation\">[</span><span class=\"token string\">'__sekiro_seq__'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> seq<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>    <span class=\"token keyword\">var</span> responseText <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>responseJson<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sekiro: response :\"</span> <span class=\"token operator\">+</span> responseText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>responseText<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre></pre></td></tr><tr><td data-num=\"188\"></td><td><pre><span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">registerAction</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">action<span class=\"token punctuation\">,</span> handler</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> action <span class=\"token operator\">!==</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"an action must be string\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> handler <span class=\"token operator\">!==</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a handler must be function\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sekiro: register action: \"</span> <span class=\"token operator\">+</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handlers<span class=\"token punctuation\">[</span>action<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> handler<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">guid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>            <span class=\"token keyword\">function</span> <span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>                  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">+</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">0x10000</span><span class=\"token punctuation\">)</span><span class=\"token operator\">|</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token constant\">S4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre><span class=\"token keyword\">var</span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SekiroClient</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ws://127.0.0.1:5620/business-demo/register?group=ws-group&amp;clientId=\"</span><span class=\"token operator\">+</span><span class=\"token function\">guid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>client<span class=\"token punctuation\">.</span><span class=\"token function\">registerAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"clientTime\"</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">request<span class=\"token punctuation\">,</span> resolve<span class=\"token punctuation\">,</span>reject</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre>            <span class=\"token comment\">// 在这里 div</span></pre></td></tr><tr><td data-num=\"209\"></td><td><pre>            <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token operator\">+</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>sekiro 框架注入 Js</p>\n<pre><code>http://127.0.0.1:5620/business-demo/invoke?group=****&amp;action=****&amp;page=(这里选用要传的值)\n</code></pre>\n<p>这里的 group 对应上面的组，action 对应其调用的方法，这里是 clientTime;</p>\n<p>若要传值，可以采用类似 python</p>\n",
            "tags": [
                "rpc"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/03/13/ali/",
            "url": "http://yida506.github.io/2022/03/13/ali/",
            "title": "ali",
            "date_published": "2022-03-13T12:53:32.000Z",
            "content_html": "<h6 id=\"三重控制流平坦化\"><a class=\"anchor\" href=\"#三重控制流平坦化\">#</a> 三重控制流平坦化</h6>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">n</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> e <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">void</span> <span class=\"token number\">0</span> <span class=\"token operator\">!==</span> e<span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token number\">7</span> <span class=\"token operator\">&amp;</span> e<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">var</span> r <span class=\"token operator\">=</span> e <span class=\"token operator\">>></span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">var</span> s <span class=\"token operator\">=</span> <span class=\"token number\">7</span> <span class=\"token operator\">&amp;</span> r<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>          <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            i <span class=\"token operator\">+=</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            e <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>          <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>              e <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>              e <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>          <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            i <span class=\"token operator\">+=</span> <span class=\"token string\">\"hB\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            e <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">var</span> c <span class=\"token operator\">=</span> <span class=\"token string\">\"egdirbsj\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">var</span> k <span class=\"token operator\">=</span> j<span class=\"token punctuation\">[</span>b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">var</span> o <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>k<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>          e <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>          e <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        i <span class=\"token operator\">+=</span> <span class=\"token string\">\"ck\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token function\">d</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token operator\">!</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token keyword\">var</span> <span class=\"token function-variable function\">t</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>          <span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> e<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>          <span class=\"token keyword\">var</span> r <span class=\"token operator\">=</span> <span class=\"token string\">\"\\u03a2\\u03c3\\u03b7\\u03de\\u03a8\\u03cd\\u03f7\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>          <span class=\"token keyword\">var</span> s <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>          <span class=\"token keyword\">var</span> c <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>          <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> b <span class=\"token operator\">&lt;</span> r<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> b<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>            b <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>c <span class=\"token operator\">=</span> <span class=\"token number\">972</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            <span class=\"token keyword\">var</span> k <span class=\"token operator\">=</span> r<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>            <span class=\"token keyword\">var</span> o <span class=\"token operator\">=</span> k <span class=\"token operator\">^</span> c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>            c <span class=\"token operator\">=</span> k<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>            s <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>          <span class=\"token keyword\">var</span> t <span class=\"token operator\">=</span> a <span class=\"token operator\">===</span> s<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>          t <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">d</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        <span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token string\">\"pus\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>          e <span class=\"token operator\">=</span> <span class=\"token number\">16</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>          e <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token keyword\">var</span> n <span class=\"token operator\">=</span> <span class=\"token string\">\"def\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        n <span class=\"token operator\">+=</span> <span class=\"token string\">\"ault\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        k <span class=\"token operator\">=</span> k<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>        <span class=\"token keyword\">var</span> h <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>k<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>          e <span class=\"token operator\">=</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>          e <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">6</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>上述为其模型的典型特征。</p>\n<p>通过分析，我们可以发现，其中 for 循环中的 test 语句，为判断这个循环是否停止的条件，我们知道要使得 for 循环停止，可以添加 break 语句或者通过外嵌函数的方法，直接 return 出来，在这里我们可以看到，采用的是第二种方法，也就是说，在还原碰到 return 语句的时候，作为结束条件停止即可。</p>\n<p><strong>大变量：指代这里的 e</strong></p>\n<p><strong>初始化参数：指代这里的 a、r、s</strong></p>\n<ol>\n<li>\n<p>获取条件 test 表达式，获取初始化参数的值。</p>\n</li>\n<li>\n<p>访问到最底部的节点，然后通过遍历的方式，获取其赋值语句，这里又分为两种情况：a. 在当前层数可以找到最顶部参数的赋值语句的地方 b. 在当前层数只能找到其上一节点的参数的赋值地方 (应对多重 switch 嵌套)。</p>\n<blockquote>\n<p>思路，从初始 for 循环出发，初始化变量的值，然后根据 SwitchStatement 获取到当前变量及其对应的值，然后进入到 case 节点的位置，这里需要进行一个判断，判断其下一层是否还是 SwitchStatemen 类型，如果不是，那么就进行节点的合并，在这里面一定会包含一个关于初始值变化的位置，因此需要在这些 Expressionstatement 中找到其赋值表达式 (Assignmentexpression)，然后在进行一次计算，但是在这种情况下，难免会碰到更深层的 SwitchStatement，当游走到最深处的时候，需要判断，其是走向该 Switch 节点下的其他部分，还是赋值了大变量走入其他分支，最后根据 return 或者是结束语句判断是是否该 for 循环结束。</p>\n</blockquote>\n<p><strong>核心思路：将初始化和判断语句写入一个函数，这样可以做到一次获取全部初始变量的值，将所有的 Switch 节点均写为一个类似字典的形式，方便进入对应的节点。</strong></p>\n</li>\n</ol>\n<p><strong>但是，有个致命的问题就是 IF 表达式判断。</strong></p>\n<p><img data-src=\"http://pic.ddddhm.cn/ali/image-20220314224908224.png\" alt=\"image-20220314224908224\"></p>\n<p>通过对这里的分析，发现其本质上是走的一个 for 循环的流程，同时，其对应的 else 节点属于结束节点。</p>\n<p>大胆假设，假如 test 节点的类型为 BinaryExpression，同时其 right 部分为 MemberExpression，而且其 Identifier 部分为 length，那么这个就为 for 循环的 test 部分，同时其第一次 stack 包含的 var 声明式，在这里为 var E = 0; 代表 for 循环的起始值，其中有个流程包含 E++ 对应 for 循环的自增值。本质上这是一个环形结构。</p>\n<h5 id=\"流程梳理\"><a class=\"anchor\" href=\"#流程梳理\">#</a> 流程梳理</h5>\n<h6 id=\"step1-运行步骤\"><a class=\"anchor\" href=\"#step1-运行步骤\">#</a> STEP1 运行步骤</h6>\n<p>初始化 b=4</p>\n<p 4 k: 4, o: 0, t: b:></p>\n<p>进入该节点</p>\n<p><img data-src=\"http://pic.ddddhm.cn/ali/image-20220317210749234.png\" alt=\"image-20220317210749234\"></p>\n<p>然后碰到 if 流，根据变量名判断，这属于函数参数名，所以这两个分支应该都会走到，进入第一个 b=8 的分支。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/ali/image-20220317210938365.png\" alt=\"image-20220317210938365\"></p>\n<p>发现，接下来走到的是 b=0 的分支。</p>\n<p 0 k: 0, o: t: b:></p>\n<p><img data-src=\"http://pic.ddddhm.cn/ali/image-20220317211033300.png\" alt=\"image-20220317211033300\"></p>\n<p>接着又进入了一个 if 分支，可以发现，这里是对 A 的长度进行了一个判断，进入 b=64 分支，</p>\n<p 64 k: 0, o: 4, t: b:></p>\n<p><img data-src=\"http://pic.ddddhm.cn/ali/image-20220317211633194.png\" alt=\"image-20220317211633194\"></p>\n<p>先走 32 这个分支，给 x 赋值</p>\n<p><img data-src=\"http://pic.ddddhm.cn/ali/image-20220317222822658.png\" alt=\"image-20220317222822658\"></p>\n<p>即接下来走的是 b=3 这个分支。</p>\n<p 3 k: 3, o: 0, t: b:></p>\n<p><img data-src=\"http://pic.ddddhm.cn/ali/image-20220317211912799.png\" alt=\"image-20220317211912799\"></p>\n<p>然后又跳转到 128 分支</p>\n<p 128 k: 0, o: 8, t: b:></p>\n<p><img data-src=\"http://pic.ddddhm.cn/ali/image-20220317212010367.png\" alt=\"image-20220317212010367\"></p>\n<p>然后又跳回 0 分支，也就是说，继续重复上述步骤。</p>\n<p>那么我们需要梳理其流程，然后对其进行一个还原，在这里可以看到，我们在进入 b=0 分支后先进行了一个对其长度判断，然后</p>\n<p>进入一长串循环该步骤，最后跳出到 b=2 这个分支。</p>\n<p>其初始头为 b=0 结束头为 b=128.</p>\n<p>我们最后希望将其还原为</p>\n<p>var E=0</p>\n<p>for(;E&lt;A.length;){</p>\n<p>​\t......</p>\n<p>​     E++;</p>\n<p>}</p>\n<p>的形式，后面跟的是 b=2 的分支。</p>\n<h5 id=\"难点\"><a class=\"anchor\" href=\"#难点\">#</a> 难点</h5>\n<p><img data-src=\"http://pic.ddddhm.cn/ali/image-20220329225917160.png\" alt=\"image-20220329225917160\"></p>\n<p>也就是说，在 if 的判断表达式为二元表达式，类似 a&lt;b 这种形式的时候，都是生成的 for 循环，这样假如采取栈的形式当下一次的初值和开始的初值相等，那么就可以退出，但是，这是对于单情况而言，假如其中嵌套 if 表达式，那么还需对其进行一个判断。</p>\n<p>思路：</p>\n<ol>\n<li>if 表达式的判断部分为二元表达式，进入 for 循环，此处对应的是该流程的外部参数，记录 if 表达式中左节点的参数名 (该处一般为接下来进行更新操作的地方)。</li>\n<li>进行接下来的流程操作，假如直接是与 for 循环开始节点一样的值，那么直接返回，但是，假如是经过一个 if 表达式，其中，if 表达式的判断部分为一开始的左节点参数，一般，这个参数初始值为 0，即，随着 for 循环的运行，这个值会进入不同的流程，那么这部分的 If 表达式的节点都需要保留，那么，就只有在 else 节点结束后，才算退出 for 循环。</li>\n</ol>\n<p>个人觉得，如果枚举全部情况，虽然还原后的结果看上去很好看，但是需要耗费大量的时间、精力，退而求其次，我们可以没必要一步到位，可以只还原 if 表达式，同时不对花指令进行删除，直接生成一个包含花指令的结果。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/ali/image-20220416214725791.png\" alt=\"image-20220416214725791\"></p>\n<p>以上述流程为例，这里流程 f 到流程 a 实际上是一个假流程，假如采用顺序执行还原，那么就会一直重复 abdfabdf 这几个部分，那么我们要做的是，建立一个类似栈的东西，将流程存入栈中，同时，这里的栈只包含 if 流程的初始值 (对应 if 左节点对应的流程参数)，那么栈中的内容就为 abdf，如果在碰到 a，那么该流程就结束了。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/*****************************************************</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> * Author:  mr2</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> * Date:    2022-03-13</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> * File:    SwitchFix</pre></td></tr><tr><td data-num=\"7\"></td><td><pre> * Project: ast_tools</pre></td></tr><tr><td data-num=\"8\"></td><td><pre> *****************************************************/</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">const</span> parser <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@babel/parser\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">const</span> types <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@babel/types\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">const</span> generator <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@babel/generator\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">const</span> traverse_Switch <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token function\">ForStatement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token function\">fix</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">get_other_expression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">arr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">let</span> temparr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token keyword\">of</span> arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isSwitchStatement</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            temparr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">return</span> temparr<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">get_switch_expression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">arr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token keyword\">of</span> arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isSwitchStatement</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token keyword\">return</span> i</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">get_switch_obj</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">SwitchNode</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">let</span> CaseNode <span class=\"token operator\">=</span> SwitchNode<span class=\"token punctuation\">.</span>cases<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">let</span> current_obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token keyword\">of</span> CaseNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token comment\">// 如果节点里为 SwitchStatement</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">get_switch_expression</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>consequent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            current_obj<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_switch_obj</span><span class=\"token punctuation\">(</span><span class=\"token function\">get_switch_expression</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>consequent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            current_obj<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> i<span class=\"token punctuation\">.</span>consequent<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token keyword\">return</span> current_obj<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">return_obj_create</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">init_expression<span class=\"token punctuation\">,</span> init_params_body</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">let</span> temparr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> exp <span class=\"token keyword\">of</span> init_params_body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        temparr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">objectProperty</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">stringLiteral</span><span class=\"token punctuation\">(</span>exp<span class=\"token punctuation\">.</span>declarations<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> exp<span class=\"token punctuation\">.</span>declarations<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    temparr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">objectProperty</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">stringLiteral</span><span class=\"token punctuation\">(</span>init_expression<span class=\"token punctuation\">.</span>declarations<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> init_expression<span class=\"token punctuation\">.</span>declarations<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token keyword\">let</span> now_obj <span class=\"token operator\">=</span> types<span class=\"token punctuation\">.</span><span class=\"token function\">objectExpression</span><span class=\"token punctuation\">(</span>temparr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    <span class=\"token keyword\">return</span> now_obj<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token comment\">// 游走到最底层节点</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">get_lowest_node</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">init_value<span class=\"token punctuation\">,</span>SwitchNode<span class=\"token punctuation\">,</span> SwitchObj</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token comment\">// 给定初始对象</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">let</span> test_var <span class=\"token operator\">=</span> SwitchNode<span class=\"token punctuation\">.</span>discriminant<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token comment\">// 获取当前对象的初始值</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token keyword\">let</span> now_case_value <span class=\"token operator\">=</span> init_value<span class=\"token punctuation\">[</span>test_var<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token comment\">// 进入最底层</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token keyword\">let</span> now_node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isSwitchStatement</span><span class=\"token punctuation\">(</span>SwitchNode<span class=\"token punctuation\">.</span>cases<span class=\"token punctuation\">[</span>now_case_value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>consequent<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>        <span class=\"token comment\">// console.log(generator(SwitchNode.cases[now_case_value].consequent[0]).code);</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        now_node <span class=\"token operator\">=</span> <span class=\"token function\">get_lowest_node</span><span class=\"token punctuation\">(</span>init_value<span class=\"token punctuation\">,</span> SwitchNode<span class=\"token punctuation\">.</span>cases<span class=\"token punctuation\">[</span>now_case_value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>consequent<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> SwitchObj<span class=\"token punctuation\">[</span>now_case_value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        now_node <span class=\"token operator\">=</span> SwitchObj<span class=\"token punctuation\">[</span>now_case_value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token keyword\">return</span> now_node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre><span class=\"token comment\">// 用于节点游走，为一个递归函数 (大变量初始值，对应的 SwitchStatement)</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre><span class=\"token comment\">//base_var_name:for 循环的变量，for 循环的值，SwitchNode 对应的 node 节点，init_data 初始化变量，init_var_indentify 判断是否停止，SwitchObj 游走到底部节点，out_arr 用于保存参数，stack 用于记录不包含 If 的所有节点，var_stack 用于记录 for 循环生成的参数</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">get_node_expression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">base_var_name<span class=\"token punctuation\">,</span>value<span class=\"token punctuation\">,</span>SwitchNode<span class=\"token punctuation\">,</span>init_data<span class=\"token punctuation\">,</span>init_var_identify<span class=\"token punctuation\">,</span>SwitchObj<span class=\"token punctuation\">,</span>out_arr<span class=\"token punctuation\">,</span>stack<span class=\"token punctuation\">,</span>var_stack<span class=\"token punctuation\">,</span>test_node<span class=\"token punctuation\">,</span>for_stament_arr<span class=\"token punctuation\">,</span>if_stack</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>     <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">init_var_identify</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>     <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>if_stack<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>     <span class=\"token keyword\">let</span> init_value <span class=\"token operator\">=</span> <span class=\"token function\">init_data</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>     <span class=\"token comment\">//console.log (' 开始进行变量初始化 ',init_value, init_var_identify (0));</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>     <span class=\"token comment\">//console.log (' 当前 base_var_value',init_value [base_var_name]);</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>     <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>for_stament_arr<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> for_stament_arr<span class=\"token punctuation\">[</span>for_stament_arr<span class=\"token punctuation\">.</span>length<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> init_value<span class=\"token punctuation\">[</span>base_var_name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>         <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>     <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>     <span class=\"token keyword\">let</span> now_arr <span class=\"token operator\">=</span> <span class=\"token function\">get_lowest_node</span><span class=\"token punctuation\">(</span>init_value<span class=\"token punctuation\">,</span>SwitchNode<span class=\"token punctuation\">,</span>SwitchObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>     <span class=\"token comment\">//console.log (' 当前参数 ',generator (types.blockStatement (stack)).code);</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>     <span class=\"token comment\">//console.log (' 当前节点参数 ',generator (types.blockStatement (now_arr)).code);</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>     <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token keyword\">of</span> now_arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isExpressionStatement</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> types<span class=\"token punctuation\">.</span><span class=\"token function\">isAssignmentExpression</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>expression<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>             <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>expression<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">.</span>name <span class=\"token operator\">==</span> base_var_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>                 <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>expression<span class=\"token punctuation\">.</span>operator <span class=\"token operator\">==</span> <span class=\"token string\">'='</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>                     <span class=\"token function\">get_node_expression</span><span class=\"token punctuation\">(</span>base_var_name<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">.</span>expression<span class=\"token punctuation\">.</span>right<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span>SwitchNode<span class=\"token punctuation\">,</span>init_data<span class=\"token punctuation\">,</span>init_var_identify<span class=\"token punctuation\">,</span>SwitchObj<span class=\"token punctuation\">,</span>out_arr<span class=\"token punctuation\">,</span>stack<span class=\"token punctuation\">,</span>var_stack<span class=\"token punctuation\">,</span>test_node<span class=\"token punctuation\">,</span>for_stament_arr<span class=\"token punctuation\">,</span>if_stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>                     <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>                 <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>             <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isBreakStatement</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isIfStatement</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> stack<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isIfStatement</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>             <span class=\"token comment\">// console.log(if_stack);</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>             <span class=\"token comment\">//console.log (' 当前判断 ',generator (i.test).code);</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>             if_stack<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>             <span class=\"token keyword\">let</span> consequentExpression <span class=\"token operator\">=</span> i<span class=\"token punctuation\">.</span>consequent<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>expression<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>             <span class=\"token keyword\">let</span> alternateExpression <span class=\"token operator\">=</span> i<span class=\"token punctuation\">.</span>alternate<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>expression<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>             <span class=\"token keyword\">let</span> if_left_arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>if_right_arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>             <span class=\"token keyword\">let</span> now_stack <span class=\"token operator\">=</span> stack<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>             <span class=\"token comment\">//for 循环的话不考虑 stack</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>             <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isBinaryExpression</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>                <span class=\"token keyword\">let</span> begin_value <span class=\"token operator\">=</span> <span class=\"token function\">init_data</span><span class=\"token punctuation\">(</span>consequentExpression<span class=\"token punctuation\">.</span>right<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>base_var_name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>                <span class=\"token comment\">// 传入上一层的 value</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>                <span class=\"token keyword\">let</span> result_arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>                for_stament_arr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>init_value<span class=\"token punctuation\">[</span>base_var_name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>                <span class=\"token comment\">//console.log (' 开始生成 for 循环，此时节点的值为 ',for_stament_arr);</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>                <span class=\"token keyword\">let</span> base_for_test_name <span class=\"token operator\">=</span> i<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>                <span class=\"token function\">get_node_expression</span><span class=\"token punctuation\">(</span>base_var_name<span class=\"token punctuation\">,</span>begin_value<span class=\"token punctuation\">,</span>SwitchNode<span class=\"token punctuation\">,</span>init_data<span class=\"token punctuation\">,</span>init_var_identify<span class=\"token punctuation\">,</span>SwitchObj<span class=\"token punctuation\">,</span>result_arr<span class=\"token punctuation\">,</span>now_stack<span class=\"token punctuation\">,</span>var_stack<span class=\"token punctuation\">,</span>base_for_test_name<span class=\"token punctuation\">,</span>for_stament_arr<span class=\"token punctuation\">,</span>if_stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>                <span class=\"token comment\">//console.log ('for 循环样式:',generator (types.forStatement (null,i.test,null,types.blockStatement (result_arr))).code);</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>                <span class=\"token comment\">// 只有判断表达式的右边类似 a.length 的形式才计算值</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>                 <span class=\"token keyword\">let</span> for_type <span class=\"token operator\">=</span> types<span class=\"token punctuation\">.</span><span class=\"token function\">forStatement</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> types<span class=\"token punctuation\">.</span><span class=\"token function\">blockStatement</span><span class=\"token punctuation\">(</span>result_arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>                 out_arr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>for_type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>                <span class=\"token keyword\">let</span> for_end_value <span class=\"token operator\">=</span> <span class=\"token function\">init_data</span><span class=\"token punctuation\">(</span>alternateExpression<span class=\"token punctuation\">.</span>right<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>base_var_name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>                <span class=\"token comment\">//console.log ('else 节点 value',for_end_value,' 开始进入 else 节点 ');</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>                for_stament_arr<span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>                <span class=\"token keyword\">let</span> else_result_arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>                <span class=\"token function\">get_node_expression</span><span class=\"token punctuation\">(</span>base_var_name<span class=\"token punctuation\">,</span>for_end_value<span class=\"token punctuation\">,</span>SwitchNode<span class=\"token punctuation\">,</span>init_data<span class=\"token punctuation\">,</span>init_var_identify<span class=\"token punctuation\">,</span>SwitchObj<span class=\"token punctuation\">,</span>out_arr<span class=\"token punctuation\">,</span>now_stack<span class=\"token punctuation\">,</span>var_stack<span class=\"token punctuation\">,</span>test_node<span class=\"token punctuation\">,</span>for_stament_arr<span class=\"token punctuation\">,</span>if_stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>             <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>             <span class=\"token comment\">// 进入 if 节点的内部的时候，要传入上一层入口处的流程参数，然后在到该部分的时候，退出 if 节点</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>             <span class=\"token comment\">// 递归计算左节点</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>             <span class=\"token keyword\">let</span> left_stack<span class=\"token operator\">=</span>if_stack<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>right_stack<span class=\"token operator\">=</span>if_stack<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>             <span class=\"token comment\">//console.log (' 开始进入 '+generator (i.test).code+' 左节点 ');</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>             <span class=\"token function\">get_node_expression</span><span class=\"token punctuation\">(</span>base_var_name<span class=\"token punctuation\">,</span> consequentExpression<span class=\"token punctuation\">.</span>right<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span> SwitchNode<span class=\"token punctuation\">,</span> init_data<span class=\"token punctuation\">,</span> init_var_identify<span class=\"token punctuation\">,</span> SwitchObj<span class=\"token punctuation\">,</span> if_left_arr<span class=\"token punctuation\">,</span> now_stack<span class=\"token punctuation\">,</span> var_stack<span class=\"token punctuation\">,</span> test_node<span class=\"token punctuation\">,</span> for_stament_arr<span class=\"token punctuation\">,</span> left_stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>             <span class=\"token comment\">// 递归计算右节点</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>             <span class=\"token comment\">//console.log (' 开始进入 '+generator (i.test).code+' 右节点 ');</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>             <span class=\"token function\">get_node_expression</span><span class=\"token punctuation\">(</span>base_var_name<span class=\"token punctuation\">,</span> alternateExpression<span class=\"token punctuation\">.</span>right<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span> SwitchNode<span class=\"token punctuation\">,</span> init_data<span class=\"token punctuation\">,</span> init_var_identify<span class=\"token punctuation\">,</span> SwitchObj<span class=\"token punctuation\">,</span> if_right_arr<span class=\"token punctuation\">,</span> now_stack<span class=\"token punctuation\">,</span> var_stack<span class=\"token punctuation\">,</span> test_node<span class=\"token punctuation\">,</span> for_stament_arr<span class=\"token punctuation\">,</span> right_stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>             out_arr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">ifStatement</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">,</span> types<span class=\"token punctuation\">.</span><span class=\"token function\">blockStatement</span><span class=\"token punctuation\">(</span>if_left_arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> types<span class=\"token punctuation\">.</span><span class=\"token function\">blockStatement</span><span class=\"token punctuation\">(</span>if_right_arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>             <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>out_arr<span class=\"token punctuation\">)</span> out_arr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isReturnStatement</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>     <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre></pre></td></tr><tr><td data-num=\"155\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">fix</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>init<span class=\"token punctuation\">,</span>test<span class=\"token punctuation\">,</span>update<span class=\"token punctuation\">,</span>body<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>update<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>init<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>    <span class=\"token keyword\">let</span> init_params_body <span class=\"token operator\">=</span> <span class=\"token function\">get_other_expression</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>    <span class=\"token keyword\">let</span> return_obj_statement <span class=\"token operator\">=</span> <span class=\"token function\">return_obj_create</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">,</span> init_params_body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>    init_params_body<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">returnStatement</span><span class=\"token punctuation\">(</span>return_obj_statement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>    <span class=\"token comment\">// 将初始化的值 eval 进内存。后续可以直接调用</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>    <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token function\">generator</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">functionDeclaration</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">identifier</span><span class=\"token punctuation\">(</span><span class=\"token string\">'init_var_identify'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>        <span class=\"token punctuation\">[</span>init<span class=\"token punctuation\">.</span>declarations<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>        types<span class=\"token punctuation\">.</span><span class=\"token function\">blockStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">returnStatement</span><span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>    <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token function\">generator</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">functionDeclaration</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">identifier</span><span class=\"token punctuation\">(</span><span class=\"token string\">'init_data'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>        <span class=\"token punctuation\">[</span>init<span class=\"token punctuation\">.</span>declarations<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>        types<span class=\"token punctuation\">.</span><span class=\"token function\">blockStatement</span><span class=\"token punctuation\">(</span>init_params_body<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>    <span class=\"token keyword\">let</span> SwitchNode <span class=\"token operator\">=</span> <span class=\"token function\">get_switch_expression</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>    <span class=\"token keyword\">let</span> SwitchObj <span class=\"token operator\">=</span> <span class=\"token function\">get_switch_obj</span><span class=\"token punctuation\">(</span>SwitchNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>    <span class=\"token keyword\">let</span> out_arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>stack<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>for_stament_arr<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>if_stack<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>    <span class=\"token function\">get_node_expression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>declarations<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>init<span class=\"token punctuation\">.</span>declarations<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>init<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span>SwitchNode<span class=\"token punctuation\">,</span>init_data<span class=\"token punctuation\">,</span>init_var_identify<span class=\"token punctuation\">,</span>SwitchObj<span class=\"token punctuation\">,</span>out_arr<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>stack<span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>for_stament_arr<span class=\"token punctuation\">,</span>if_stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>    <span class=\"token comment\">// console.log(out_arr);</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>    path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWithMultiple</span><span class=\"token punctuation\">(</span>out_arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre></pre></td></tr><tr><td data-num=\"181\"></td><td><pre></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>exports<span class=\"token punctuation\">.</span>fix <span class=\"token operator\">=</span> traverse_Switch<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>以这种思路会有致命的弊端，他的 if 流程越多，那么所需要的内存越大，如果有 1000 个 if，那么空间复杂度就是 2^1000，一般电脑带不动，会直接爆内存不足。。</p>\n",
            "tags": [
                "ast"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/03/11/ast-tools%E8%A7%A3%E8%AF%BB/",
            "url": "http://yida506.github.io/2022/03/11/ast-tools%E8%A7%A3%E8%AF%BB/",
            "title": "ast_tools解读",
            "date_published": "2022-03-11T11:33:40.000Z",
            "content_html": "<p>ast_tools 源码解读</p>\n<h4 id=\"ifwithexpressfix\"><a class=\"anchor\" href=\"#ifwithexpressfix\">#</a> IfWithExpressFix</h4>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311193502748.png\" alt=\"image-20220311193502748\"></p>\n<p>主要是给不包含 block 的 if 表达式添加上，让其统一化。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">var</span> b<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">var</span> b<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"forwithexpressfix-forwithforfix\"><a class=\"anchor\" href=\"#forwithexpressfix-forwithforfix\">#</a> ForWithExpressFix &amp; ForWithForFix</h4>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311193754270.png\" alt=\"image-20220311193754270\"></p>\n<p>都是给 For 循环规范化。</p>\n<h4 id=\"returnseqfix\"><a class=\"anchor\" href=\"#returnseqfix\">#</a> ReturnSeqFix</h4>\n<p>将 return 中包含逗号表达式的还原</p>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311194547853.png\" alt=\"image-20220311194547853\"></p>\n<p>第一部分用于将所有的逗号表达式添加到数组中，第二步主要是将逗号表达式前 n-1 项加到 return 前面，然后将 return 节点只包含逗号表达式的最后一项。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span>b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> c<span class=\"token operator\">=</span>a<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span>b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>c<span class=\"token operator\">=</span>a<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">return</span> ab<span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"variabledeclaratorfix\"><a class=\"anchor\" href=\"#variabledeclaratorfix\">#</a> VariableDeclaratorFix</h4>\n<p>声明表达式及赋值表达式还原。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>m<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>d<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>n<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">var</span> a<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">var</span> b<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">var</span> c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>m<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>d<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>n<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"conditionalfix\"><a class=\"anchor\" href=\"#conditionalfix\">#</a> ConditionalFix</h4>\n<p>三目表达式转化为 if-else 的形式。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311200057628.png\" alt=\"image-20220311200057628\"></p>\n<h4 id=\"sequenceexpressionfix\"><a class=\"anchor\" href=\"#sequenceexpressionfix\">#</a> SequenceExpressionFix</h4>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311200313589.png\" alt=\"image-20220311200313589\"></p>\n<p>本质上还是逗号表达式的还原。</p>\n<h4 id=\"assignmentwithconditionalfix\"><a class=\"anchor\" href=\"#assignmentwithconditionalfix\">#</a> AssignmentWithConditionalFix</h4>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311200459670.png\" alt=\"image-20220311200459670\"></p>\n<p>还是对三目表达的还原，这里限制了其 consequent 和 alternate 部分都为数字。</p>\n<h4 id=\"logicalexpressionfix\"><a class=\"anchor\" href=\"#logicalexpressionfix\">#</a> LogicalExpressionFix</h4>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311200832831.png\" alt=\"image-20220311200832831\"></p>\n<p>将逻辑表达式转化为条件表达式。</p>\n<h4 id=\"unaryfunctionfix\"><a class=\"anchor\" href=\"#unaryfunctionfix\">#</a> UnaryFunctionFix</h4>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311201334471.png\" alt=\"image-20220311201334471\"></p>\n<p>把自执行函数的壳去掉。</p>\n<h4 id=\"controlflowfix\"><a class=\"anchor\" href=\"#controlflowfix\">#</a> ControlFlowFix</h4>\n<p>控制流平坦化。</p>\n<ul>\n<li>\n<p>进入大 FOR 循环，获取第一个初始化 Ci 的表达式，然后根据一个三目获取变量的名称 (其余的条件貌似不是针对大控制流的)。</p>\n</li>\n<li>\n<p>定义了两个数组，分别用于存取大控制流的变量</p>\n</li>\n</ul>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311203909800.png\" alt=\"image-20220311203909800\"></p>\n<ul>\n<li>\n<p>生成了一个函数，给定一个初始的 li 然后会返回一个字典包含这五个参数。</p>\n</li>\n<li>\n<p>进入控制流，然后生产了一个用于判断是否结束的函数。</p>\n</li>\n<li>\n<p>获取主流程 switch 节点</p>\n</li>\n<li>\n<p>初始化了 get_control_struct 函数，steps_hash_list，bodys，get_next_control_param 函数，</p>\n</li>\n<li>\n<p>定义了一个 get_node 函数 (控制流的另一种形式，初始 li 参数)</p>\n</li>\n</ul>\n<blockquote>\n<p>控制流的另一种形式：将上述控制流转化为一个类似字典的东西，键指代控制流指向，值包含其内容为 node 类型。</p>\n</blockquote>\n<h5 id=\"get_code函数\"><a class=\"anchor\" href=\"#get_code函数\">#</a> get_code 函数</h5>\n<p>控制流的整体流程</p>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311210310953.png\" alt=\"image-20220311210310953\"></p>\n<p>这里获取所有初始参数的值</p>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311210631798.png\" alt=\"image-20220311210631798\"></p>\n<p>这一步应该是不断计算，获取最下层节点即 Ai 节点的值。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311211105814.png\" alt=\"image-20220311211105814\"></p>\n<p>在这里，由于包含 IF 的模块，所以还要对其进行一个判断，get_next_control_param 用于获取其类型是否包含这种 IF。</p>\n<p>向栈中添加这两个节点值。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311211853434.png\" alt=\"image-20220311211853434\"></p>\n<p>然后根据这个 11490 在进行一个这个流程，在进入 while 流程中，基本上就将控制流还原了。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ba <span class=\"token operator\">=</span> window<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Nt <span class=\"token operator\">=</span> r<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ur <span class=\"token operator\">=</span> <span class=\"token keyword\">void</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Jo <span class=\"token operator\">=</span> <span class=\"token keyword\">void</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>ei <span class=\"token operator\">=</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Nt<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>。。。。</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>。。。</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>整体思想，获取初始参数的值，计算出中间参数的值，找到最底层的节点，获取当前节点的表达式，然后获取下一步初始参数的值 (要对 for 循环中的条件进行一个判断)，反复调用并合并节点，最后将整个大 FOR 循环脱掉。</p>\n</blockquote>\n<h4 id=\"constantfix\"><a class=\"anchor\" href=\"#constantfix\">#</a> ConstantFix</h4>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311220445933.png\" alt=\"image-20220311220445933\"></p>\n<p>字符串的还原。</p>\n<h4 id=\"decryptvariablefix\"><a class=\"anchor\" href=\"#decryptvariablefix\">#</a> DecryptVariableFix</h4>\n<p>将 w.pop () 的形式，还原为字符串。</p>\n<h4 id=\"reservestrfix\"><a class=\"anchor\" href=\"#reservestrfix\">#</a> ReserveStrFix</h4>\n<p><img data-src=\"http://pic.ddddhm.cn/ast-tools%E8%A7%A3%E8%AF%BB/image-20220311215701659.png\" alt=\"image-20220311215701659\"></p>\n<p>这玩意的还原。</p>\n",
            "tags": [
                "ast"
            ]
        },
        {
            "id": "http://yida506.github.io/2022/03/04/HMM/",
            "url": "http://yida506.github.io/2022/03/04/HMM/",
            "title": "HMM",
            "date_published": "2022-03-04T12:50:02.000Z",
            "content_html": "<h4 id=\"mm\"><a class=\"anchor\" href=\"#mm\">#</a> MM</h4>\n<h6 id=\"markov-model\"><a class=\"anchor\" href=\"#markov-model\">#</a> markov model：</h6>\n<p>马尔可夫模型，指的是在给定当前知识的情况下，过去对于预测未来是无关的，诶个状态的转移，只依赖之前的 n 个状态，被称为是一个 n 阶模型。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/HMM/image-20220305130113281.png\" alt=\"image-20220305130113281\"></p>\n<h6 id=\"转移矩阵\"><a class=\"anchor\" href=\"#转移矩阵\">#</a> 转移矩阵：</h6>\n<p>指的是从一个状态转移到另一个状态的概率，整体上为一个 n*n 的矩阵</p>\n<h4 id=\"hmm\"><a class=\"anchor\" href=\"#hmm\">#</a> HMM</h4>\n<p>用来描述 含有隐含未知参数的马尔可夫过程。对于投色子来讲，假如有三种色子，分别包含 6 8 10 个面，那么每个色子表现出 1 的概率是不同的，同时，我们还知道色子丢出来的结果到底是几，那么我们就可以用这个结果去反推出对应的值是由哪个色子投出来的。</p>\n<h6 id=\"hidden-state\"><a class=\"anchor\" href=\"#hidden-state\">#</a> HIDDEN STATE:</h6>\n<p>隐藏状态集合</p>\n<h6 id=\"observations-state\"><a class=\"anchor\" href=\"#observations-state\">#</a> Observations state:</h6>\n<p>观测状态集合</p>\n<h6 id=\"start-probability\"><a class=\"anchor\" href=\"#start-probability\">#</a> Start Probability:</h6>\n<p>隐藏状态初始化的概率值</p>\n<h6 id=\"hidden-transition_probability\"><a class=\"anchor\" href=\"#hidden-transition_probability\">#</a> Hidden Transition_Probability:</h6>\n<p>隐藏状态概率转移矩阵</p>\n<h6 id=\"hidden-to-observations-probability\"><a class=\"anchor\" href=\"#hidden-to-observations-probability\">#</a> Hidden to Observations Probability:</h6>\n<p>隐藏状态到观测状态概率集合</p>\n<h5 id=\"viterb算法\"><a class=\"anchor\" href=\"#viterb算法\">#</a> Viterb 算法</h5>\n<p>本质上是动态规划，假设初始状态有 n 种，观测序列的长度为 m，那么总共的路径数就为 m 的 n 次方，要想从中找到最优路径往往是不显示的，但是，对于一段长度为 x 路径来说，要是该路径是最优的，那么其长度为 x-1 的子路径也一定是最优的，那么问题就变为了，根据每一条路径，在其基础上，找到其距下个节点的最优路径即可，这样问题就缩小为了 m*n 个，极大降低了复杂度。</p>\n<h6 id=\"demo以一个看病为例\"><a class=\"anchor\" href=\"#demo以一个看病为例\">#</a> DEMO (以一个看病为例)</h6>\n<p>首先定义了隐藏状态：健康、生病</p>\n<p>观测序列：正常，冷，发烧 (这里指代我们看到的情况)</p>\n<p>初始概率：健康：0.6 生病：0.4</p>\n<p>隐藏状态概率转移矩阵：健康到健康 0.7 健康到生病 0.3 生病到健康 0.4 生病到生病 0.6’</p>\n<p>隐藏状态到观测状态概率集合:</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">\"Healthy\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"normal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"cold\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0.4</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"dizzy\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token property\">\"Fever\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token property\">\"normal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"cold\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"dizzy\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr></table></figure><p>我们要根据观测序列推断出其真实情况，在这里每一条路径都是由上一时刻的状态 X 隐藏状态转移概率矩阵 X 隐藏状态到观测状态概率集合 (这里要针对每一个隐藏状态，因为需要对这个隐藏状态进行解码).</p>\n<p><img data-src=\"http://pic.ddddhm.cn/HMM/image-20220305170041105.png\" alt=\"image-20220305170041105\"></p>\n<p>python 实现：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Hidden_states <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Healthy\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Fever\"</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 隐状态集合</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Observations_states <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"normal\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cold\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dizzy\"</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 观测状态集合</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Start_probability <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token string\">\"Healthy\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token string\">\"Fever\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.4</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># 表示病人第一次到访时医生认为其所处的 HMM 状态，他唯一知道的是病人倾向于是健康的（可以理解为这是基于一个对大众身体信息的了解得出的初始状态）</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">2</span><span class=\"token operator\">*</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>Hidden_transition_probability <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>  <span class=\"token comment\"># 隐马尔可夫链中身体状态的状态转移概率，我们能够看到，当天健康的人，第二天有 30% 的概率会发烧</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token string\">\"Healthy\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"Healthy\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.7</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Fever\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token string\">\"Fever\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"Healthy\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Fever\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>Hidden_observations_probability <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span>  <span class=\"token comment\"># 原来叫 emission_probability。这里表示病人每天的感觉的可能性。即，如果他是一个健康人，有 50% 的可能会感觉正常，40% 觉得冷，10% 觉得头晕</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token string\">\"Healthy\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"normal\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cold\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dizzy\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token string\">\"Fever\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"normal\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cold\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dizzy\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">viterbi</span><span class=\"token punctuation\">(</span>obs<span class=\"token punctuation\">,</span> states<span class=\"token punctuation\">,</span> start_p<span class=\"token punctuation\">,</span> trans_p<span class=\"token punctuation\">,</span> h2o_p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># Viterbi 算法</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    V <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    path <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token comment\"># Initialize base cases (t == 0)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token comment\"># </span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">for</span> y <span class=\"token keyword\">in</span> states<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        V<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> start_p<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> h2o_p<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>obs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token comment\"># 初始状态，由 start 的概率，对应乘上发射概率，即由隐状态到观测状态的可能性</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        path<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token comment\"># 记录下相应的路径</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token comment\"># Run Viterbi for t > 0，每天都要更新计算一遍</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">for</span> t <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>obs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        V<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        newpath <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">for</span> y <span class=\"token keyword\">in</span> states<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token comment\"># 对于每个状态，计算其由前一天的各个状态，到达今天的 y 的概率大小，与 y0 自身相比较，取最大值</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token comment\"># 前一天到达今天的每个状态对应的路径大小都计算了，取最大值。作为 V [t][y] 的值，并更新路径</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token comment\"># print('V[t-1]:',V[t-1],'trans_p:',trans_p,'h2o_p[y]:',h2o_p[y],[V[t-1][y0] * trans_p[y0][y] * h2o_p[y][obs[t]] for y0 in states])</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token punctuation\">(</span>prob<span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">[</span>t<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>y0<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> trans_p<span class=\"token punctuation\">[</span>y0<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> h2o_p<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>obs<span class=\"token punctuation\">[</span>t<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y0<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> y0 <span class=\"token keyword\">in</span> states<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">[</span>t<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            V<span class=\"token punctuation\">[</span>t<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> prob</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            newpath<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token comment\"># Don't need to remember the old paths</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        path <span class=\"token operator\">=</span> newpath</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token comment\"># print(path)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token comment\"># print_dptable(V)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token comment\"># 最后一天</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">(</span>prob<span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">[</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>obs<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> y <span class=\"token keyword\">in</span> states<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>prob<span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token keyword\">return</span> viterbi<span class=\"token punctuation\">(</span>Observations_states<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>                   Hidden_states<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>                   Start_probability<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>                   Hidden_transition_probability<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>                   Hidden_observations_probability<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>example<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h5 id=\"实际案例\"><a class=\"anchor\" href=\"#实际案例\">#</a> 实际案例</h5>\n<p>已知：</p>\n<ul>\n<li>观测序列 (指历年主题比重)</li>\n<li>状态转移矩阵：共现词矩阵 (需要进行一个归一化)</li>\n</ul>\n<p>目的：使用 Baum-Welch 算法，根据 12-21 年的比重，预测 22-25 年的比重</p>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/02/27/%E5%85%B3%E8%81%94%E6%8C%96%E6%8E%98/",
            "url": "http://yida506.github.io/2022/02/27/%E5%85%B3%E8%81%94%E6%8C%96%E6%8E%98/",
            "title": "关联挖掘",
            "date_published": "2022-02-27T08:14:42.000Z",
            "content_html": "<h4 id=\"关联挖掘\"><a class=\"anchor\" href=\"#关联挖掘\">#</a> 关联挖掘</h4>\n<h5 id=\"基本概念\"><a class=\"anchor\" href=\"#基本概念\">#</a> 基本概念</h5>\n<p>频繁项集：n 项的集合。</p>\n<p>支持度：代表 A、B 同时出现的概率，如果概率小，那么说明 A 与 B 的关系不大，如果 A、B 总是同时出现，那么说明他们是相关的。</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>s</mi><mi>u</mi><mi>p</mi><mi>p</mi><mi>o</mi><mi>r</mi><mi>t</mi><mo>=</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>A</mi><mi>U</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">support = P(AUB)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80952em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>置信度：包含 A 的数据集中包含 B 的百分比。</p>\n<h5 id=\"apriori算法\"><a class=\"anchor\" href=\"#apriori算法\">#</a> Apriori 算法</h5>\n<p>使用候选项集找频繁项集</p>\n<p>核心思想，只要一个项集是非频繁的，那么包含他的项集就都是非频繁的。</p>\n<h5 id=\"算法实现\"><a class=\"anchor\" href=\"#算法实现\">#</a> 算法实现</h5>\n<p>关联矩阵转布尔矩阵</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>data <span class=\"token operator\">=</span> final_data<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">map_func</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span> x <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">:</span>map_func<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>计算关联规则</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> mlxtend<span class=\"token punctuation\">.</span>preprocessing <span class=\"token keyword\">import</span> TransactionEncoder</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> mlxtend<span class=\"token punctuation\">.</span>frequent_patterns <span class=\"token keyword\">import</span> apriori</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#利用 Apriori 找出频繁项集</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>freq <span class=\"token operator\">=</span> apriori<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> min_support<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> use_colnames<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#导入关联规则包</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">from</span> mlxtend<span class=\"token punctuation\">.</span>frequent_patterns <span class=\"token keyword\">import</span> association_rules</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#计算关联规则</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>result <span class=\"token operator\">=</span> association_rules<span class=\"token punctuation\">(</span>freq<span class=\"token punctuation\">,</span> metric<span class=\"token operator\">=</span><span class=\"token string\">\"confidence\"</span><span class=\"token punctuation\">,</span> min_threshold<span class=\"token operator\">=</span><span class=\"token number\">0.8</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>这里采用最小支持度为 0.1，最小置信度为 0.8</p>\n<p><img data-src=\"http://pic.ddddhm.cn/%E5%85%B3%E8%81%94%E6%8C%96%E6%8E%98/image-20220227175750485.png\" alt=\"image-20220227175750485\"></p>\n<p>会得到如下 51 项关联规则，其中 support 代表支持度，confidence 代表提升度。</p>\n<p>画图：</p>\n<p><img data-src=\"http://pic.ddddhm.cn/%E5%85%B3%E8%81%94%E6%8C%96%E6%8E%98/image-20220227175825809.png\" alt=\"image-20220227175825809\"></p>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/02/26/TF-IDF/",
            "url": "http://yida506.github.io/2022/02/26/TF-IDF/",
            "title": "TF-IDF",
            "date_published": "2022-02-26T12:06:25.000Z",
            "content_html": "<h4 id=\"算法简介\"><a class=\"anchor\" href=\"#算法简介\">#</a> 算法简介:</h4>\n<h5 id=\"tf\"><a class=\"anchor\" href=\"#tf\">#</a> TF:</h5>\n<p>TF 算法，全称 Term frequency，翻译过来就是词频，顾名思义，就是词的频率：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>某词语的词频</mtext><mo>=</mo><mfrac><mtext>该词语在一篇文章所出现的次数</mtext><mtext>该篇文章包含的词语数</mtext></mfrac></mrow><annotation encoding=\"application/x-tex\">某词语的词频 = \\frac{该词语在一篇文章所出现的次数}{该篇文章包含的词语数}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">某</span><span class=\"mord cjk_fallback\">词</span><span class=\"mord cjk_fallback\">语</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">词</span><span class=\"mord cjk_fallback\">频</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.04633em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.36033em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">该</span><span class=\"mord cjk_fallback\">篇</span><span class=\"mord cjk_fallback\">文</span><span class=\"mord cjk_fallback\">章</span><span class=\"mord cjk_fallback\">包</span><span class=\"mord cjk_fallback\">含</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">词</span><span class=\"mord cjk_fallback\">语</span><span class=\"mord cjk_fallback\">数</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">该</span><span class=\"mord cjk_fallback\">词</span><span class=\"mord cjk_fallback\">语</span><span class=\"mord cjk_fallback\">在</span><span class=\"mord cjk_fallback\">一</span><span class=\"mord cjk_fallback\">篇</span><span class=\"mord cjk_fallback\">文</span><span class=\"mord cjk_fallback\">章</span><span class=\"mord cjk_fallback\">所</span><span class=\"mord cjk_fallback\">出</span><span class=\"mord cjk_fallback\">现</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">次</span><span class=\"mord cjk_fallback\">数</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>通常来讲，我们认为一个词出现的次数越多，那么该词语就越重要，但是，由于语言的特性，文章中包含许许多多停用词，虚词等无实际意义的词语，那么我们在对中文文本进行处理的时候，首先要对其进行一个预处理操作，去掉文章中的停用词等，以消除无实际意义的词产生的影响。</p>\n<p>但是，由于一词多意及同义词的现象，单纯的词频统计往往在计算关键词的时候，出现一定的偏差，导致所得结果与实际情况差别较大。</p>\n<blockquote>\n<p>词频指代的是一篇文章</p>\n</blockquote>\n<h5 id=\"idf\"><a class=\"anchor\" href=\"#idf\">#</a> IDF:</h5>\n<p>IDF 算法，全称 Inverse Document Frequency，意译过来就是逆文档频率。</p>\n<p><strong>核心思想:</strong></p>\n<p>一个词语在文档中出现的次数越少，那么逆文档频率越大，即区分类别的能力越强，可以认为是关键词。</p>\n<p><strong>逆文档解释 (个人理解)：</strong></p>\n<p>​\t\t记总共有 m 个文档，有 n 个文档中包含了某一个词语，那么对于该词语的文档出现概率为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>某词语的文档频率</mtext><mo>=</mo><mfrac><mrow><mtext>出现该词语的</mtext><mi>n</mi><mtext>篇文档</mtext></mrow><mrow><mi>m</mi><mtext>篇文档</mtext></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">某词语的文档频率 = \\frac{出现该词语的n篇文档}{m篇文档}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">某</span><span class=\"mord cjk_fallback\">词</span><span class=\"mord cjk_fallback\">语</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">文</span><span class=\"mord cjk_fallback\">档</span><span class=\"mord cjk_fallback\">频</span><span class=\"mord cjk_fallback\">率</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.04633em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.36033em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mord cjk_fallback\">篇</span><span class=\"mord cjk_fallback\">文</span><span class=\"mord cjk_fallback\">档</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">出</span><span class=\"mord cjk_fallback\">现</span><span class=\"mord cjk_fallback\">该</span><span class=\"mord cjk_fallback\">词</span><span class=\"mord cjk_fallback\">语</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord mathnormal\">n</span><span class=\"mord cjk_fallback\">篇</span><span class=\"mord cjk_fallback\">文</span><span class=\"mord cjk_fallback\">档</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>假设一个词只在 100 篇文档中出现，但是由于文档数量过大 (例如 10000)，那么该词语的文档频率就会非常的小 (1%)，和 0 基本上没任何区别，也就是说，这个词和没出现的词没明显的差异，并不能做到对文档有很好的区分作用。</p>\n<p>在此基础上，若我们取文档频率的倒数 (这里称为逆频率)，那么上述提到的值就为 100，这样一来，就可以很好的消除未出现词的影响，以及对关键词有一个很好的区分作用。</p>\n<p>但是，这样一来还是有问题，直接取倒数的话，得到的数据过于离散，在上述例子中，逆频率最少 (词只出现一次为 10000) 与最多 (词篇篇都出现 1) 的量级就会过大，在数学上，常用对数的方法，以消除量级过大的影响。</p>\n<p>因此最终逆文档的公式：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>某词语逆文档频率</mtext><mo>=</mo><mfrac><mrow><mi>m</mi><mtext>篇文档</mtext></mrow><mrow><mtext>出现该词语的文档数</mtext><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">某词语逆文档频率 = \\frac{m篇文档}{出现该词语的文档数+1}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">某</span><span class=\"mord cjk_fallback\">词</span><span class=\"mord cjk_fallback\">语</span><span class=\"mord cjk_fallback\">逆</span><span class=\"mord cjk_fallback\">文</span><span class=\"mord cjk_fallback\">档</span><span class=\"mord cjk_fallback\">频</span><span class=\"mord cjk_fallback\">率</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1296600000000003em;vertical-align:-0.7693300000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.36033em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">出</span><span class=\"mord cjk_fallback\">现</span><span class=\"mord cjk_fallback\">该</span><span class=\"mord cjk_fallback\">词</span><span class=\"mord cjk_fallback\">语</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">文</span><span class=\"mord cjk_fallback\">档</span><span class=\"mord cjk_fallback\">数</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mord cjk_fallback\">篇</span><span class=\"mord cjk_fallback\">文</span><span class=\"mord cjk_fallback\">档</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<blockquote>\n<p>补充：这里 + 1 的主要目的是为了消除未出现的词的影响 (使逆文档频率无穷大).</p>\n</blockquote>\n<h5 id=\"tf-idf\"><a class=\"anchor\" href=\"#tf-idf\">#</a> TF-IDF</h5>\n<p>词频 - 逆文档频率，本质上就是 TF 和 IDF 的乘积，TF 的本质是要获取当前文章的高频词语，而 IDF 是计算该词语在文档集合中的重要程度，对于一个词，只在一篇文章中出现多次，那么该词就会有很高的 TF 以及 IDF，那么我们就认为这个词就是关键词.</p>\n<blockquote>\n<p>TF-IDF 本质上是综合了 TF 和 IDF 的特性，对关键词加以区分的算法.</p>\n</blockquote>\n<h4 id=\"简单案例\"><a class=\"anchor\" href=\"#简单案例\">#</a> 简单案例</h4>\n<p>这里采用 Python 的 Sklearn 包为例 (取自网上 Demo).</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#导入特征提取包，第一个用于计数，第二个用于计算词频</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>feature_extraction<span class=\"token punctuation\">.</span>text <span class=\"token keyword\">import</span> CountVectorizer</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>feature_extraction<span class=\"token punctuation\">.</span>text <span class=\"token keyword\">import</span> TfidfTransformer</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>x_train <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'TF-IDF 主要 思想 是'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>           <span class=\"token string\">'算法 一个 重要 特点 可以 脱离 语料库 背景'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>           <span class=\"token string\">'如果 一个 网页 被 很多 其他 网页 链接 说明 网页 重要'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>x_test<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'原始 文本 进行 标记'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token string\">'主要 思想'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre> </pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#该类会将文本中的词语转换为词频矩阵，矩阵元素 a [i][j] 表示 j 词在 i 类文本下的词频</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>vectorizer <span class=\"token operator\">=</span> CountVectorizer<span class=\"token punctuation\">(</span>max_features<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">#该类会统计每个词语的 tf-idf 权值</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>tf_idf_transformer <span class=\"token operator\">=</span> TfidfTransformer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">#将文本转为词频矩阵并计算 tf-idf</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>tf_idf <span class=\"token operator\">=</span> tf_idf_transformer<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>vectorizer<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">#将 tf-idf 矩阵抽取出来，元素 a [i][j] 表示 j 词在 i 类文本中的 tf-idf 权重</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>x_train_weight <span class=\"token operator\">=</span> tf_idf<span class=\"token punctuation\">.</span>toarray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre> </pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#对测试集进行 tf-idf 权重计算</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>tf_idf <span class=\"token operator\">=</span> tf_idf_transformer<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>vectorizer<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>x_test_weight <span class=\"token operator\">=</span> tf_idf<span class=\"token punctuation\">.</span>toarray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 测试集 TF-IDF 权重矩阵</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\"># 获取关键词集</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">get_keywords</span><span class=\"token punctuation\">(</span>matrixArray<span class=\"token punctuation\">,</span> keywordsArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>keywordsArray<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> index <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>matrixArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> matrixArray<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'输出x_train文本向量：'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x_train_weight<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'输出x_test文本向量：'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x_test_weight<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x_test_weight<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'测试集第</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>i<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">个文本的关键词是'</span></span><span class=\"token punctuation\">,</span>get_keywords<span class=\"token punctuation\">(</span>x_test_weight<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> vectorizer<span class=\"token punctuation\">.</span>get_feature_names_out<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>这里 x_train 代表我们采用了三个文本，x_test 用于测试.</p>\n<ol>\n<li>首先我们载入包和训练集和测试集</li>\n<li>接着采用计数类，将词语转化为词频矩阵。然后初始化一个用于计算 tf-idf 的类</li>\n<li>将训练集导入其中进行训练。最后输出测试集中的关键词.</li>\n</ol>\n<p><img data-src=\"http://pic.ddddhm.cn/TF-IDF/image-20220226224241971.png\" alt=\"image-20220226224241971\"></p>\n<h4 id=\"项目实战\"><a class=\"anchor\" href=\"#项目实战\">#</a> 项目实战</h4>\n<h5 id=\"项目背景\"><a class=\"anchor\" href=\"#项目背景\">#</a> 项目背景:</h5>\n<p>采集 http://www.safehoo.com/Case/Case/Collapse 网站的数据，收集每段事故的标题，事故概况，事故原因，采取 TFIDF 算法计算出关键词.</p>\n<h5 id=\"数据采集\"><a class=\"anchor\" href=\"#数据采集\">#</a> 数据采集</h5>\n<h6 id=\"网址分析\"><a class=\"anchor\" href=\"#网址分析\">#</a> 网址分析:</h6>\n<p>首先进入网址发现总共包含 668 条数据要采集，每页包含 30 条数据，通过翻页发现，该网站是由页码来控制网站展示的内容，在这里<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5zYWZlaG9vLmNvbS9DYXNlL0Nhc2UvQ29sbGFwc2UvTGlzdF8yMy5zaHRtbA==\">坍塌事故 - 案例分析 - 安全管理网 (safehoo.com)</span> 表示的是携带最新数据的页码，其网址中包含的页码为 23, 进一步分析，发现其尾页的页码为 1. 同时，页面是通过 a 标签的 href 链接进行跳转到事故的详情页的，在详情页中数据都是保存在类名为 c_content_text 的 div 标签中。针对如上网站，设计如下爬取思路:</p>\n<ol>\n<li>对携带页面的页面进行请求，解析网页，获取指向详情页的链接，将其保存在 EXCEL 中</li>\n<li>对第一步爬取的详情页链接发起请求，对网页进行解析，将解析的结果以 EXCEL 保存.</li>\n</ol>\n<h6 id=\"爬虫程序撰写\"><a class=\"anchor\" href=\"#爬虫程序撰写\">#</a> 爬虫程序撰写</h6>\n<p>这里使用 Python 撰写爬虫.</p>\n<p>模块介绍:requests+re+etree+pandas+tqdm</p>\n<ul>\n<li><strong>requests:</strong> 爬虫模块，主要用于向网站发起请求，获取网址的 HTML 文本</li>\n<li>**re:** 正则表达式模块，用于文本进行处理等操作</li>\n<li>**etree:** 将 HTML 文本转化为解析树的形式，以用于对网页的解析</li>\n<li>**pandas:** 数据处理模块，可将数据存入 EXCEL</li>\n<li><strong>tqdm</strong>: 进度条</li>\n</ul>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 详情页爬取</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># requests 爬取网页</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 解析网页 </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">from</span> lxml <span class=\"token keyword\">import</span> etree</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 正则表达式</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 将 dataframe (数据框) 导出成 excel</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># 将代码执行过程以进度条展示</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">from</span> tqdm <span class=\"token keyword\">import</span> tqdm</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>tempdict <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">#     存储的标题</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token string\">'title'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">#     没用</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token string\">'dtype'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">#     目标网址链接</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token string\">'urlhref'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token string\">'User-Agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36 Edg/98.0.1108.56'</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">#对网址发起请求</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> tqdm<span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    baseurl <span class=\"token operator\">=</span> <span class=\"token string\">'http://www.safehoo.com'</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    url <span class=\"token operator\">=</span> baseurl <span class=\"token operator\">+</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'/Case/Case/Collapse/List_</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>i<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.shtml'</span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token comment\">#网址先包含了对浏览器的检测，要加入 headers</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    res <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token comment\">#转化格式，防止乱码出现</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    res<span class=\"token punctuation\">.</span>encoding <span class=\"token operator\">=</span> <span class=\"token string\">'utf-8'</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    html <span class=\"token operator\">=</span> etree<span class=\"token punctuation\">.</span>HTML<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    a <span class=\"token operator\">=</span> html<span class=\"token punctuation\">.</span>xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'//div[@class=\"childclass_content\"]/li'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token comment\"># 标题，进行异常检测</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            tempdict<span class=\"token punctuation\">[</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'./a/text()'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            tempdict<span class=\"token punctuation\">[</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'./a/font/text()'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token comment\"># 类型</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        tempdict<span class=\"token punctuation\">[</span><span class=\"token string\">'dtype'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>re<span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span>re<span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span><span class=\"token string\">'[A-Za-z0-9\\!\\%\\[\\]\\,\\。]'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">.</span>xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'./text()'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token comment\"># 地址</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        tempdict<span class=\"token punctuation\">[</span><span class=\"token string\">'urlhref'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>baseurl<span class=\"token operator\">+</span>i<span class=\"token punctuation\">.</span>xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'./a/@href'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token comment\">#将数据转化为数据框格式</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>tempdict<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token comment\">#将数据保存到 excel 里面</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>df<span class=\"token punctuation\">.</span>to_excel<span class=\"token punctuation\">(</span><span class=\"token string\">'output.xlsx'</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 内容爬取</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">from</span> tqdm <span class=\"token keyword\">import</span> tqdm</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">from</span> lxml <span class=\"token keyword\">import</span> etree</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_excel<span class=\"token punctuation\">(</span><span class=\"token string\">'output.xlsx'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>url <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">'urlhref'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>df<span class=\"token punctuation\">[</span><span class=\"token string\">'result'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token string\">'User-Agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36 Edg/98.0.1108.56'</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> tqdm<span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    res <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    res<span class=\"token punctuation\">.</span>encoding <span class=\"token operator\">=</span> <span class=\"token string\">'utf-8'</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    html <span class=\"token operator\">=</span> etree<span class=\"token punctuation\">.</span>HTML<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        item <span class=\"token operator\">=</span> html<span class=\"token punctuation\">.</span>xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'//*[@id=\"prt2\"]/div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'string(.)'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        result <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> re<span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span><span class=\"token string\">'\\r\\n '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        result <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    df<span class=\"token punctuation\">[</span><span class=\"token string\">'result'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> result</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>df<span class=\"token punctuation\">.</span>to_excel<span class=\"token punctuation\">(</span><span class=\"token string\">'result.xlsx'</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>总共获取了 648 条数据.</p>\n<h6 id=\"数据预处理\"><a class=\"anchor\" href=\"#数据预处理\">#</a> 数据预处理</h6>\n<p>到这里，我们获得了 如图所示数据，但是其中仍然包含大量的 HTML 文本，同时暂时还没将原因区分</p>\n<p><img data-src=\"http://pic.ddddhm.cn/TF-IDF/image-20220226231431029.png\" alt=\"image-20220226231431029\"></p>\n<p>出来，因此，接下来需要采取正则的操作将文本规范化，同时将事故原因抽取出来。由于该网站的数据是以文档加 pdf 的形式展示的，因此在第一步先对 pdf 形式的文本进行一个去除.</p>\n<p>直接采用 pandas 中 notnull () 的方法。去除后还剩下 617 条文本.</p>\n<p>根据网站结构，我们可以知道，这里面的包含了很多结构化的信息，同时也包含了对原因的展示，在这里定义了一个函数，对网站的空字符，换行符以及 Unicode 编码进行了一个去除，接着针对标题所带的索引进行分块，然后依次遍历检索，若其中包含原因，那么该快就是对于该事故的原因解释.</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">split_function</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    type_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"一\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"二\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"三\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"四\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"五\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"六\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"七\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"八\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"九\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"十\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    result <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    text <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'\\r'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'\\t'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'\\u3000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>type_list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            temptext <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>type_list<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">、(.*?)</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>type_list<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">、\"</span></span><span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token string\">\"概况\"</span> <span class=\"token keyword\">in</span> temptext <span class=\"token keyword\">or</span> <span class=\"token string\">\"结果\"</span> <span class=\"token keyword\">in</span> temptext<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                result <span class=\"token operator\">=</span> result <span class=\"token operator\">+</span> <span class=\"token string\">\"事故概况:\"</span> <span class=\"token operator\">+</span> temptext<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'。'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token string\">\"原因\"</span> <span class=\"token keyword\">in</span> temptext<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                result <span class=\"token operator\">=</span> result <span class=\"token operator\">+</span> <span class=\"token string\">\"事故原因\"</span> <span class=\"token operator\">+</span> temptext</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token string\">\"概况\"</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> result<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            result <span class=\"token operator\">=</span> <span class=\"token string\">\"事故概况：\"</span> <span class=\"token operator\">+</span> text<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"。\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> result</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token string\">\"原因\"</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> result<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            result <span class=\"token operator\">=</span> result <span class=\"token operator\">+</span> <span class=\"token string\">\"事故原因\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"。\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">return</span> result</pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">get_reason</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token keyword\">return</span> text<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token keyword\">return</span> text<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">None</span></pre></td></tr></table></figure><p><img data-src=\"http://pic.ddddhm.cn/TF-IDF/image-20220226233355724.png\" alt=\"image-20220226233355724\"></p>\n<p>这里已经成功的将原因抽取出来了.</p>\n<p>接着对筛取的结果进行进一步处理，最后将其转化为 EXCEL 存储.</p>\n<h6 id=\"分词与词典构建\"><a class=\"anchor\" href=\"#分词与词典构建\">#</a> 分词与词典构建</h6>\n<p>由于中文在处理时，首先第一步是要对其进行分词操作，同时由于新词的出现，因此需要用到行业相关的专用词典.</p>\n<p>由于 python 在分词时需要用到 txt 格式的文件作为分词，目录，所以这里需要先将.scel 格式的文件转化为 txt 格式的文件</p>\n<p>.scel 格式采用 Unicode 编码了汉字、拼音.</p>\n<p>这里直接采取别人的解析程序:</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># -*- coding: utf-8 -*-</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> struct</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 拼音表偏移</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>startPy <span class=\"token operator\">=</span> <span class=\"token number\">0x1540</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 汉语词组表偏移</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>startChinese <span class=\"token operator\">=</span> <span class=\"token number\">0x2628</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># 全局拼音表</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>GPy_Table <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># 解析结果</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># 元组 (词频，拼音，中文词组) 的列表</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># 原始字节码转为字符串</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">byte2str</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    pos <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">while</span> pos <span class=\"token operator\">&lt;</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        c <span class=\"token operator\">=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>struct<span class=\"token punctuation\">.</span>unpack<span class=\"token punctuation\">(</span><span class=\"token string\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>pos <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">if</span> c <span class=\"token operator\">!=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token builtin\">str</span> <span class=\"token operator\">+=</span> c</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        pos <span class=\"token operator\">+=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token builtin\">str</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre> </pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\"># 获取拼音表</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">getPyTable</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    pos <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">while</span> pos <span class=\"token operator\">&lt;</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        index <span class=\"token operator\">=</span> struct<span class=\"token punctuation\">.</span>unpack<span class=\"token punctuation\">(</span><span class=\"token string\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>data<span class=\"token punctuation\">[</span>pos <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        pos <span class=\"token operator\">+=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        lenPy <span class=\"token operator\">=</span> struct<span class=\"token punctuation\">.</span>unpack<span class=\"token punctuation\">(</span><span class=\"token string\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>pos <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        pos <span class=\"token operator\">+=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        py <span class=\"token operator\">=</span> byte2str<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">:</span>pos <span class=\"token operator\">+</span> lenPy<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        GPy_Table<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> py</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        pos <span class=\"token operator\">+=</span> lenPy</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token comment\"># 获取一个词组的拼音</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">getWordPy</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    pos <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    ret <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">while</span> pos <span class=\"token operator\">&lt;</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        index <span class=\"token operator\">=</span> struct<span class=\"token punctuation\">.</span>unpack<span class=\"token punctuation\">(</span><span class=\"token string\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>pos <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        ret <span class=\"token operator\">+=</span> GPy_Table<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        pos <span class=\"token operator\">+=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">return</span> ret</pre></td></tr><tr><td data-num=\"49\"></td><td><pre> </pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token comment\"># 读取中文表</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">getChinese</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    GTable <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    pos <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">while</span> pos <span class=\"token operator\">&lt;</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token comment\"># 同音词数量</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        same <span class=\"token operator\">=</span> struct<span class=\"token punctuation\">.</span>unpack<span class=\"token punctuation\">(</span><span class=\"token string\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>pos <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token comment\"># 拼音索引表长度</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        pos <span class=\"token operator\">+=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        py_table_len <span class=\"token operator\">=</span> struct<span class=\"token punctuation\">.</span>unpack<span class=\"token punctuation\">(</span><span class=\"token string\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>pos <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token comment\"># 拼音索引表</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        pos <span class=\"token operator\">+=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        py <span class=\"token operator\">=</span> getWordPy<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">:</span> pos <span class=\"token operator\">+</span> py_table_len<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token comment\"># 中文词组</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>        pos <span class=\"token operator\">+=</span> py_table_len</pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>same<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>            <span class=\"token comment\"># 中文词组长度</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>            c_len <span class=\"token operator\">=</span> struct<span class=\"token punctuation\">.</span>unpack<span class=\"token punctuation\">(</span><span class=\"token string\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>pos <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>            <span class=\"token comment\"># 中文词组</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            pos <span class=\"token operator\">+=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>            word <span class=\"token operator\">=</span> byte2str<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">:</span> pos <span class=\"token operator\">+</span> c_len<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>            <span class=\"token comment\"># 扩展数据长度</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>            pos <span class=\"token operator\">+=</span> c_len</pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            ext_len <span class=\"token operator\">=</span> struct<span class=\"token punctuation\">.</span>unpack<span class=\"token punctuation\">(</span><span class=\"token string\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>pos <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>            <span class=\"token comment\"># 词频</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            pos <span class=\"token operator\">+=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>            count <span class=\"token operator\">=</span> struct<span class=\"token punctuation\">.</span>unpack<span class=\"token punctuation\">(</span><span class=\"token string\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">[</span>pos<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>pos <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>            <span class=\"token comment\"># 保存</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>            GTable<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>count<span class=\"token punctuation\">,</span> py<span class=\"token punctuation\">,</span> word<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>            <span class=\"token comment\"># 到下个词的偏移位置</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>            pos <span class=\"token operator\">+=</span> ext_len</pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    <span class=\"token keyword\">return</span> GTable</pre></td></tr><tr><td data-num=\"82\"></td><td><pre> </pre></td></tr><tr><td data-num=\"83\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">scel2txt</span><span class=\"token punctuation\">(</span>file_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-'</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>file_name<span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        data <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"词库名：\"</span><span class=\"token punctuation\">,</span> byte2str<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">0x130</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x338</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># .encode('GB18030')</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"词库类型：\"</span><span class=\"token punctuation\">,</span> byte2str<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">0x338</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x540</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"描述信息：\"</span><span class=\"token punctuation\">,</span> byte2str<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">0x540</span><span class=\"token punctuation\">:</span><span class=\"token number\">0xd40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"词库示例：\"</span><span class=\"token punctuation\">,</span> byte2str<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">0xd40</span><span class=\"token punctuation\">:</span>startPy<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>    getPyTable<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span>startPy<span class=\"token punctuation\">:</span>startChinese<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>    getChinese<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span>startChinese<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    <span class=\"token keyword\">return</span> getChinese<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span>startChinese<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre></pre></td></tr><tr><td data-num=\"95\"></td><td><pre><span class=\"token comment\"># scel 所在文件夹路径</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>in_path <span class=\"token operator\">=</span> <span class=\"token string\">'./专业词词库'</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre><span class=\"token comment\"># 输出词典所在文件夹路径</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>out_path <span class=\"token operator\">=</span> <span class=\"token string\">'./词库'</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>fin <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>fname <span class=\"token keyword\">for</span> fname <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>in_path<span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> fname<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">\".scel\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre><span class=\"token keyword\">for</span> f <span class=\"token keyword\">in</span> fin<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>        <span class=\"token keyword\">for</span> word <span class=\"token keyword\">in</span> scel2txt<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>in_path<span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>            file_path<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>out_path<span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">'.txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>            <span class=\"token comment\"># 保存结果</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>            <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>file_path<span class=\"token punctuation\">,</span><span class=\"token string\">'a+'</span><span class=\"token punctuation\">,</span>encoding<span class=\"token operator\">=</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token keyword\">as</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>                <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>        os<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>in_path<span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>    <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>        <span class=\"token keyword\">pass</span></pre></td></tr></table></figure><p>接着在对上述生成的 txt 文本进行一个合并操作，最终生成了一个自定义词典.</p>\n<p>然后采用 jieba 分词，将其转化为词的形式.</p>\n<h6 id=\"数据集处理\"><a class=\"anchor\" href=\"#数据集处理\">#</a> 数据集处理</h6>\n<p>采取上述爬取的数据集和人工收集到的第二份数据集进行合并，由于分析对象选取的是 2007 年以后，所以针对其进行了进一步的筛选操作。还剩余 425 条数据.</p>\n<h6 id=\"模型导入\"><a class=\"anchor\" href=\"#模型导入\">#</a> 模型导入</h6>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#TfidfVectorizer 为上述 CountVectorizer,TfidfTransformer 的集合</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>vector <span class=\"token operator\">=</span> TfidfVectorizer<span class=\"token punctuation\">(</span>stop_words<span class=\"token operator\">=</span>stoplist<span class=\"token punctuation\">,</span> vocabulary <span class=\"token operator\">=</span> vocab<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>tf_idf <span class=\"token operator\">=</span> vector<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>corpus<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>由于文章包含大量描述性的话语，同时存在多个词语指代同一词语的现象，因此，在此基础上，对停用词词典进行进一步调整，然后根据 top50 的词频，将其跟原因相关的词汇进行分类，将原因分为如下四类:</p>\n<ul>\n<li>安全因素:' 安全生产 ',' 安全管理 ',' 安全隐患 ',' 培训 ',' 安全生产工作 ',' 现场安全管理 ',' 教育'</li>\n<li>管理因素:' 管理 ',' 监理 ',' 组织 ',' 落实 ',' 履行 ',' 监督 ',' 协调 ',' 混乱 ',' 监督管理 ',' 审批'</li>\n<li>工作因素:' 检查 ',' 排查 ',' 违反 ',' 整改 ', ' 拆除 ',' 调查 ',' 发现 ',' 验收'</li>\n<li>其他因素 ' 隐患 ',' 分包 ',' 救援 ',' 临时'</li>\n</ul>\n<p>同时将其词频分布以词云图的形式展现。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/TF-IDF/image-20220227153628664.png\" alt=\"image-20220227153628664\"></p>\n<p><img data-src=\"http://pic.ddddhm.cn/TF-IDF/image-20220227161321175.png\" alt=\"image-20220227161321175\"></p>\n<p>最后将其结果以上述关键词进行一个分类。</p>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/02/25/js%E5%8A%A0%E5%AF%86/",
            "url": "http://yida506.github.io/2022/02/25/js%E5%8A%A0%E5%AF%86/",
            "title": "js加密",
            "date_published": "2022-02-25T14:25:27.000Z",
            "content_html": "<h4 id=\"编码混淆\"><a class=\"anchor\" href=\"#编码混淆\">#</a> 编码混淆</h4>\n<h5 id=\"base系列\"><a class=\"anchor\" href=\"#base系列\">#</a> base 系列</h5>\n<h6 id=\"base64\"><a class=\"anchor\" href=\"#base64\">#</a> base64</h6>\n<p>以目前来看，最为常见的是 base64，结尾一般来讲都有一到 2 个等号，明文过短的时候就没有。</p>\n<p>js 端 (base64)：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 明文：123</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">btoa</span><span class=\"token punctuation\">(</span><span class=\"token string\">'123'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 密文:'MTIz'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// 解密</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">atob</span><span class=\"token punctuation\">(</span><span class=\"token string\">'MTIz'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>python 端:</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> base64</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>test_str <span class=\"token operator\">=</span> <span class=\"token string\">'123'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>encode_str <span class=\"token operator\">=</span> base64<span class=\"token punctuation\">.</span>encodebytes<span class=\"token punctuation\">(</span><span class=\"token string\">b'123'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#编码</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>encode_str<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">#解码</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>decode_str <span class=\"token operator\">=</span> base64<span class=\"token punctuation\">.</span>decodebytes<span class=\"token punctuation\">(</span>encode_str<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>decode_str<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote>\n<p>这里要输入加密字符串的二进制码，然后其输出的结果也是一个二进制码，要对其进行一个 decode () 操作。</p>\n</blockquote>\n<h6 id=\"unicode编码\"><a class=\"anchor\" href=\"#unicode编码\">#</a> Unicode 编码</h6>\n<p>以  <code>\\u</code> 、 <code>&amp;#</code>  或  <code>&amp;#x</code>  开头，后面是数字加字母组合。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/js%E5%8A%A0%E5%AF%86/image-20220225225020052.png\" alt=\"image-20220225225020052\"></p>\n<h5 id=\"算法加密\"><a class=\"anchor\" href=\"#算法加密\">#</a> 算法加密</h5>\n<h6 id=\"md5\"><a class=\"anchor\" href=\"#md5\">#</a> MD5</h6>\n<p>本质上是一种信息摘要算法，对应关系为 n 对 1，也就是不同的数有相同的加密结果，但是一个数只会有唯一的加密值。密文一般是 16 或 32 位。</p>\n<p>md5 加密特征：</p>\n<ol>\n<li>0123456789ABCDEF、0123456789abcdef 的出现</li>\n<li>1732584193、-271733879、-1732584194、271733878 的出现</li>\n</ol>\n<blockquote>\n<p>至于为什么会有上述特征，后面在研究。</p>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> hashlib</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>m <span class=\"token operator\">=</span> hashlib<span class=\"token punctuation\">.</span>md5<span class=\"token punctuation\">(</span><span class=\"token string\">b'123'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#202cb962ac59075b964b07152d234b70</span></pre></td></tr></table></figure><h6 id=\"sha系列\"><a class=\"anchor\" href=\"#sha系列\">#</a> SHA 系列</h6>\n<p>比 md5 长一些。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> hashlib</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>m <span class=\"token operator\">=</span> hashlib<span class=\"token punctuation\">.</span>sha1<span class=\"token punctuation\">(</span><span class=\"token string\">b'123'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#40bd001563085fc35165329ea1ff5c5ecbdbbeef</span></pre></td></tr></table></figure><h6 id=\"hmac系列\"><a class=\"anchor\" href=\"#hmac系列\">#</a> HMAC 系列</h6>\n<p>据说是在 md5、sha 系列的基础上引入秘钥。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> hmac</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>m <span class=\"token operator\">=</span> hmac<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span><span class=\"token string\">b'key'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'123'</span><span class=\"token punctuation\">,</span> digestmod<span class=\"token operator\">=</span><span class=\"token string\">'MD5'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#52851cb05258c8d98da1672d95729e53</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>n<span class=\"token operator\">=</span> hmac<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span><span class=\"token string\">b'key'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'123'</span><span class=\"token punctuation\">,</span> digestmod<span class=\"token operator\">=</span><span class=\"token string\">'SHA1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#d4a5b6721d75a5ac15ec698818c77fe1f6e40187</span></pre></td></tr></table></figure><h6 id=\"rsa加密\"><a class=\"anchor\" href=\"#rsa加密\">#</a> RSA 加密</h6>\n<p>非对称加密，使用公钥加密，然后用私钥解密，私钥加密的，可以用公钥解密。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> rsa</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">rsaEncrypt</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\"># 生成 512 位公钥、私钥</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">(</span>pubkey<span class=\"token punctuation\">,</span> privkey<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> rsa<span class=\"token punctuation\">.</span>newkeys<span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'公钥</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>pubkey<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">,私钥</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>privkey<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    crypto <span class=\"token operator\">=</span> rsa<span class=\"token punctuation\">.</span>encrypt<span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> pubkey<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>crypto<span class=\"token punctuation\">,</span> privkey<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">rsaDecrypt</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> rsa<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>text<span class=\"token punctuation\">,</span>pk <span class=\"token operator\">=</span> rsaEncrypt<span class=\"token punctuation\">(</span><span class=\"token string\">'123'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'密文'</span><span class=\"token punctuation\">,</span>text<span class=\"token punctuation\">,</span>pk<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>content<span class=\"token operator\">=</span>  rsaDecrypt<span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span> pk<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'明文'</span><span class=\"token punctuation\">,</span> content<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>在 js 中，有一个明显的特征就是设置公钥。</p>\n<h6 id=\"des加密\"><a class=\"anchor\" href=\"#des加密\">#</a> DES 加密</h6>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/02/21/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2/",
            "url": "http://yida506.github.io/2022/02/21/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2/",
            "title": "服务器部署",
            "date_published": "2022-02-21T13:05:26.000Z",
            "content_html": "<h4 id=\"feaplat服务器部署\"><a class=\"anchor\" href=\"#feaplat服务器部署\">#</a> feaplat 服务器部署</h4>\n<h5 id=\"服务器选择选用centos76\"><a class=\"anchor\" href=\"#服务器选择选用centos76\">#</a> 服务器选择选用 centos7.6</h5>\n<p>账号:root</p>\n<p>密码：大小写混合</p>\n<p>直接使用 FinalShell 链接，其中 IP 地址对应公网 IP，端口对应 22 (默认)，采用上述账号密码进行账号密码登录。</p>\n<h4 id=\"docker\"><a class=\"anchor\" href=\"#docker\">#</a> Docker</h4>\n<p><strong>介绍:</strong> 本质上是通过打包的方式，将环境啥的都集中到一个地方，避免配置的复杂度，做到随用随取，同时里面相当于包含独立的 linux 主机类似 bin 啥的目录</p>\n<h6 id=\"docker-pull\"><a class=\"anchor\" href=\"#docker-pull\">#</a> docker pull：</h6>\n<p>下载网上的镜像，一般选用公用镜像，私有的建立仓库啥的</p>\n<h6 id=\"docker-run\"><a class=\"anchor\" href=\"#docker-run\">#</a> docker run:</h6>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">参数</th>\n<th style=\"text-align:center\">解释</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">-d</td>\n<td style=\"text-align:center\">表示启动在后台</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-p</td>\n<td style=\"text-align:center\">8888:8888 表示端口</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-e</td>\n<td style=\"text-align:center\">环境 (对于 jupyter 镜像来说，加入 JUPYTER_ENABLE_LAB=yes 代表使用 lab 而不是 notebook)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-v</td>\n<td style=\"text-align:center\">给容器挂载存储卷，挂载到容器的某个目录 (/ 主机目录 : / 容器目录)</td>\n</tr>\n</tbody>\n</table>\n<p>内网穿透：<br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9vcGVuLmRpbmd0YWxrLmNvbS9kb2N1bWVudC9yZXNvdXJjZWRvd25sb2FkL2h0dHAtaW50cmFuZXQtcGVuZXRyYXRpb24=\">https://open.dingtalk.com/document/resourcedownload/http-intranet-penetration</span></p>\n<p>posql keyword:abc123</p>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/02/20/ti%E8%BF%98%E5%8E%9F2/",
            "url": "http://yida506.github.io/2022/02/20/ti%E8%BF%98%E5%8E%9F2/",
            "title": "ti还原2",
            "date_published": "2022-02-20T15:26:10.000Z",
            "content_html": "<h4 id=\"代码还原\"><a class=\"anchor\" href=\"#代码还原\">#</a> 代码还原</h4>\n<p>接着上一篇。</p>\n<h5 id=\"环境加载\"><a class=\"anchor\" href=\"#环境加载\">#</a> 环境加载</h5>\n<p>在上一篇，我们将加载函数抠出来了后，就可以直接保存在内存中，然后通过直接在内存里面计算拿到结果在还原，这里还原方法类似解 Ob 混淆的还原，通过遍历所有的 CallExpression 节点，找到解密函数实参，然后传参，最后将结果还原即可。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> InFuncReplace <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">CallExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>callee<span class=\"token punctuation\">,</span>arguments<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isMemberExpression</span><span class=\"token punctuation\">(</span>callee<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">let</span> func_name <span class=\"token operator\">=</span> callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>func_name <span class=\"token operator\">!==</span> <span class=\"token string\">'ff'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"补环境\"><a class=\"anchor\" href=\"#补环境\">#</a> 补环境</h4>\n<p>现在基本的混淆已经解的差不多了，开始补环境。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function-variable function\">null_function</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">val</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>location <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token string\">\"href\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://ntp.msn.cn/edge/ntp?locale=en-US&amp;title=New%20tab&amp;dsp=1&amp;sp=%E5%BF%85%E5%BA%94&amp;prerender=1\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>document <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>document<span class=\"token punctuation\">.</span>location <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>document<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>protocol <span class=\"token operator\">=</span> <span class=\"token string\">\"https:\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>document<span class=\"token punctuation\">.</span>currentScript <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>document<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">getElementsByTagName</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">val</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>val <span class=\"token operator\">===</span> <span class=\"token string\">\"script\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      src<span class=\"token operator\">:</span> <span class=\"token string\">\"/_sec/cp_challenge/sec-cpt-3-6.js\"</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>window <span class=\"token operator\">=</span> global<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>暂时运行不了，推测有加盐的地方。</p>\n</blockquote>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/02/10/ti%E8%BF%98%E5%8E%9F/",
            "url": "http://yida506.github.io/2022/02/10/ti%E8%BF%98%E5%8E%9F/",
            "title": "ti还原1",
            "date_published": "2022-02-10T12:48:15.000Z",
            "content_html": "<p>不知道为什么要还原 ti，也不知道还原了 ti 有啥用。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>aHR0cHM6Ly93d3cudGkuY29tLmNuL3JBUy0yL29Kai92cVItL2YzZ0EvdVJYbC9oWU41d1Z3NC9JQjRWUDBzRUJ3L0FGL1VkT1NrdEd5OEI<span class=\"token operator\">=</span></pre></td></tr></table></figure><h4 id=\"源码分析\"><a class=\"anchor\" href=\"#源码分析\">#</a> 源码分析</h4>\n<p>将代码放至 AST explorer 中解析。</p>\n<p>根据解析的结果可以发现几个明显的特征：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 于函数体内部的赋值表达式生成、非常规运算。</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">tv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">tv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token constant\">SQ</span> <span class=\"token operator\">=</span> <span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">// 类 OB 的运算混淆</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">xB</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">qB<span class=\"token punctuation\">,</span> <span class=\"token constant\">BB</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">return</span> qB <span class=\"token operator\">>></span> <span class=\"token constant\">BB</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span>；</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">// 隐藏 case 节点值的控制流平坦化及包含 BlockStatement 的 case 节点保护。</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">case</span> sq<span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">// 控制流调用交叉</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">val1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>val1<span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>val1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'this is 1 step'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        val1 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">return</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'inner function end'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        val1 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'this is 3 step'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token comment\">// 对象还原</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>ff<span class=\"token punctuation\">.</span><span class=\"token function\">gF</span><span class=\"token punctuation\">(</span><span class=\"token string\">\":\\v\u0015+U4\"</span><span class=\"token punctuation\">,</span> g5<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token comment\">// 函数调用</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token function\">j5</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> p0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>在对其代码有大致的了解后，可以将能还原的先还原。</p>\n<h4 id=\"代码还原\"><a class=\"anchor\" href=\"#代码还原\">#</a> 代码还原</h4>\n<h5 id=\"函数体还原\"><a class=\"anchor\" href=\"#函数体还原\">#</a> 函数体还原</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">Xv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        xP <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'gc'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// 还原后</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>xp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'gc'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">// 还原插件</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">const</span> FuncReduce <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">FunctionDeclaration</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span>params<span class=\"token punctuation\">,</span>body<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">0</span> <span class=\"token operator\">||</span> <span class=\"token function\">ReturnIdentify</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span><span class=\"token number\">1</span> <span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">let</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>binding <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>binding<span class=\"token punctuation\">.</span>referenced<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">let</span> references <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> reference <span class=\"token keyword\">of</span> references<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isCallExpression</span><span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>              <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isExpressionStatement</span><span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                reference<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>插件撰写思路：</p>\n<ol>\n<li>遍历函数声明式，只针对无形参，无返回值的函数声明式。</li>\n<li>根据其函数名，找到其调用位置，需保证调用位置的结构为 &quot;x ();&quot; 的形式。</li>\n<li>节点替换。</li>\n</ol>\n</blockquote>\n<h5 id=\"非常规运算\"><a class=\"anchor\" href=\"#非常规运算\">#</a> 非常规运算</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token constant\">SQ</span> <span class=\"token operator\">=</span> <span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> jQ <span class=\"token operator\">=</span> <span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">OQ</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">KQ</span> <span class=\"token operator\">=</span> <span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JQ</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CQ</span> <span class=\"token operator\">=</span> <span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">RQ</span> <span class=\"token operator\">=</span> <span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">DQ</span> <span class=\"token operator\">=</span> <span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">ZQ</span> <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">WQ</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> dQ <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// 还原后:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token constant\">SQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> jQ <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">OQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">KQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">RQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">DQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">ZQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">WQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> dQ <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// 插件:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">// 能计算的计算，不能计算的回填。</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">const</span> UnaryCaculator <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">BinaryExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>value<span class=\"token punctuation\">,</span>confident<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>value <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>confident<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>       <span class=\"token function\">UnaryExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>operator<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>operator <span class=\"token operator\">!==</span> <span class=\"token string\">'+'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>value<span class=\"token punctuation\">,</span>confident<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>value <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>confident<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"全局变量回填\"><a class=\"anchor\" href=\"#全局变量回填\">#</a> 全局变量回填</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token constant\">SQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> jQ <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">OQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">KQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">RQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">DQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">ZQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">WQ</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> dQ <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>bq <span class=\"token operator\">=</span> jQ <span class=\"token operator\">+</span> <span class=\"token constant\">ZQ</span> <span class=\"token operator\">*</span> <span class=\"token constant\">WQ</span> <span class=\"token operator\">+</span> <span class=\"token constant\">RQ</span> <span class=\"token operator\">*</span> <span class=\"token constant\">WQ</span> <span class=\"token operator\">*</span> <span class=\"token constant\">WQ</span> <span class=\"token operator\">+</span> <span class=\"token constant\">WQ</span> <span class=\"token operator\">*</span> <span class=\"token constant\">WQ</span> <span class=\"token operator\">*</span> <span class=\"token constant\">WQ</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// 还原后</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>bq <span class=\"token operator\">=</span> <span class=\"token number\">3</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">+</span> <span class=\"token number\">6</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">+</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">const</span> AssignReplace <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function\">AssignmentExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>left<span class=\"token punctuation\">,</span>right<span class=\"token punctuation\">,</span>operator<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">let</span> var_name <span class=\"token operator\">=</span> left<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isLiteral</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isIdentifier</span><span class=\"token punctuation\">(</span>left<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> operator<span class=\"token operator\">!==</span><span class=\"token string\">'='</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token function\">Identifier</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> var_name <span class=\"token operator\">||</span> _path<span class=\"token punctuation\">.</span>node <span class=\"token operator\">===</span> left<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isBinaryExpression</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                    _path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>var_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isSwitchCase</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                    _path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>var_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>此时还需要将还原后的基础节点进行一个计算。</p>\n</blockquote>\n<p>但是，单纯这么写有问题，假如碰到了反复调用这种情况，那么就会出现一点问题</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>a<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>b<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>c<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>d<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    m<span class=\"token operator\">=</span>a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    n<span class=\"token operator\">=</span>m<span class=\"token operator\">+</span>c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    x<span class=\"token operator\">=</span>n<span class=\"token operator\">+</span>d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>a <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> c <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  m <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  n <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  x <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">// 需要先对其进行一个替换，这样在进行上面一步就不会出现问题。</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">const</span> varExchange <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">AssignmentExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>left<span class=\"token punctuation\">,</span>right<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">let</span> var_name <span class=\"token operator\">=</span> left<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token function\">Identifier</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> var_name<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>node <span class=\"token operator\">===</span> left<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                <span class=\"token comment\">// console.log(path.toString(),'->',_path.parentPath.toString());</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                _path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"控制流还原\"><a class=\"anchor\" href=\"#控制流还原\">#</a> 控制流还原</h5>\n<p>经过更深层次的观察，我们发现，很多变量的声明位置都不在一开始的声明语句中，而是处于控制流中，同时在 case 节点处，包含了 Blockstatement (把 scope 禁用了)，这样我们就首先需要进行一个 Blockstatement 的还原。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token constant\">XXX</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  \t<span class=\"token constant\">XXX</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// 去掉控制流中的 block</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">const</span> BlockReplace <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">BlockStatement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>body<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isSwitchCase</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token keyword\">of</span> body<span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            path<span class=\"token punctuation\">.</span><span class=\"token function\">insertAfter</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">EmptyStatement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">,</span> BlockReplace<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>接下来还需要优化一下，然后将赋值语句替换进去，这里先还原部分。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> ReferenceReplace <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">AssignmentExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>left<span class=\"token punctuation\">,</span>right<span class=\"token punctuation\">,</span>operator<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">let</span> var_name <span class=\"token operator\">=</span> left<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isLiteral</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isIdentifier</span><span class=\"token punctuation\">(</span>left<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> operator<span class=\"token operator\">!==</span><span class=\"token string\">'='</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">let</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>var_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>binding<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isForStatement</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isForStatement</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">let</span> references <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">IsSwitchVar</span><span class=\"token punctuation\">(</span>references<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> reference <span class=\"token keyword\">of</span> references<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            reference<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            reference<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">crawl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>在此之后，大部分数已经被还原了，接下来就需要进一步替换函数表达式的还原。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> FuncReplace <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span>init<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isFunctionExpression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isBinaryExpression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">let</span> func_name <span class=\"token operator\">=</span> id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">let</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">let</span> operator <span class=\"token operator\">=</span> init<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">.</span>operator<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token function\">CallExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>callee<span class=\"token punctuation\">,</span>arguments<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> _path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>callee<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> func_name<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                _path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">binaryExpression</span><span class=\"token punctuation\">(</span>operator<span class=\"token punctuation\">,</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">const</span> FuncReplace2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span>init<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isFunctionExpression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isUnaryExpression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">let</span> func_name <span class=\"token operator\">=</span> id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">let</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">let</span> operator <span class=\"token operator\">=</span> init<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">.</span>operator<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token function\">CallExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>callee<span class=\"token punctuation\">,</span>arguments<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> _path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>callee<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> func_name<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                _path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">unaryExpression</span><span class=\"token punctuation\">(</span>operator<span class=\"token punctuation\">,</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>现在，我们可以看到，大部分逻辑都很清楚了，但是其中还包含了一个解密对象，同时，根据实际情况可以看到，这个解密对象肯定是隐藏在控制流中赋值的，那么接下来就需要还原控制流，由于该处采用了 call、apply、this 这些混合调用对象，需要枚举所有情况撰写插件。</p>\n<p>ok，接下来直接解控制流。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 可判断当前状态，同时这里的替换应该是当前 case 节点中的所有部分</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">get_case</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">func_name<span class=\"token punctuation\">,</span>caseNode<span class=\"token punctuation\">,</span>currentpath</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>     <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>test<span class=\"token punctuation\">,</span> consequent<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> caseNode<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     <span class=\"token keyword\">let</span> current <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token keyword\">of</span> consequent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isBreakStatement</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>               <span class=\"token keyword\">let</span> <span class=\"token punctuation\">&#123;</span>expression<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>               <span class=\"token comment\">//case 值修改</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>               <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isAssignmentExpression</span><span class=\"token punctuation\">(</span>expression<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                   <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>expression<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> func_name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                       <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token function\">generator</span><span class=\"token punctuation\">(</span>expression<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                       <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>               <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>               current<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>               <span class=\"token comment\">// console.log(generator(i).code);</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>               <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isReturnStatement</span><span class=\"token punctuation\">(</span>expression<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> current<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>         <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isBreakStatement</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">continue</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>     <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>     <span class=\"token keyword\">return</span> current</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">choose_case</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">func_name<span class=\"token punctuation\">,</span> all_case_nodes</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">let</span> case_value <span class=\"token operator\">=</span> <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token keyword\">of</span> all_case_nodes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>value <span class=\"token operator\">==</span> case_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token keyword\">return</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\">// 这里传入调用节点 path</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">GetCurrentValue</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>callee<span class=\"token punctuation\">,</span>arguments<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isMemberExpression</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'call'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isThisExpression</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                <span class=\"token keyword\">return</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                <span class=\"token keyword\">return</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span><span class=\"token string\">'apply'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isThisExpression</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                <span class=\"token keyword\">return</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                <span class=\"token keyword\">return</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isIdentifier</span><span class=\"token punctuation\">(</span>callee<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token keyword\">return</span> arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">ValueFileter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token punctuation\">,</span>value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token keyword\">let</span> currentbody <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token keyword\">of</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">==</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">continue</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        currentbody<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token keyword\">return</span> currentbody</pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token comment\">// 通过遍历替换值，这里每次替换会重新赋值，在这里基本上以第一个为基础节点，然后把所有的参数 eval 进内存</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token keyword\">const</span> SwitchReplace <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span>init<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isFunctionExpression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token keyword\">let</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>        <span class=\"token keyword\">let</span> references <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'while'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        <span class=\"token keyword\">let</span> tempdict <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>        binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token function\">CallExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path_</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isIdentifier</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>                    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>name<span class=\"token operator\">!==</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isMemberExpression</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>                    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name<span class=\"token operator\">!==</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>                <span class=\"token keyword\">let</span> now_value <span class=\"token operator\">=</span> <span class=\"token function\">GetCurrentValue</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isNumericLiteral</span><span class=\"token punctuation\">(</span>now_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>                <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token operator\">+</span><span class=\"token string\">'='</span><span class=\"token operator\">+</span><span class=\"token function\">generator</span><span class=\"token punctuation\">(</span>now_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>                <span class=\"token keyword\">let</span> currentbody <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>                path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>                    <span class=\"token function\">WhileStatement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>                        <span class=\"token keyword\">const</span> testpath <span class=\"token operator\">=</span> _path<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>                        <span class=\"token keyword\">let</span> func_name <span class=\"token operator\">=</span> testpath<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>                        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>func_name <span class=\"token operator\">!==</span> init<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>                        <span class=\"token keyword\">let</span> cases <span class=\"token operator\">=</span> _path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>cases<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>                        <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>testpath<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>                            <span class=\"token keyword\">let</span> result <span class=\"token operator\">=</span> <span class=\"token function\">get_case</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">,</span> <span class=\"token function\">choose_case</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">,</span> cases<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> _path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>                            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> j <span class=\"token keyword\">of</span> result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>                                currentbody<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>                            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>                            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isReturnStatement</span><span class=\"token punctuation\">(</span>currentbody<span class=\"token punctuation\">[</span>currentbody<span class=\"token punctuation\">.</span>length<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>                        tempdict<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">.</span>name<span class=\"token operator\">+</span><span class=\"token string\">'_'</span><span class=\"token operator\">+</span>now_value<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> types<span class=\"token punctuation\">.</span><span class=\"token function\">functionExpression</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">identifier</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">.</span>name<span class=\"token operator\">+</span><span class=\"token string\">'_'</span><span class=\"token operator\">+</span>now_value<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span>init<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">blockStatement</span><span class=\"token punctuation\">(</span>currentbody<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>                        <span class=\"token comment\">// 去掉节点</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>                        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isMemberExpression</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>                            _path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> id<span class=\"token punctuation\">.</span>name<span class=\"token operator\">+</span><span class=\"token string\">'_'</span><span class=\"token operator\">+</span>now_value<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>                            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'apply'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>                                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isThisExpression</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>                                    _path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>elements <span class=\"token operator\">=</span> <span class=\"token function\">ValueFileter</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">,</span>now_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>                                <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>                                    _path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>elements <span class=\"token operator\">=</span> <span class=\"token function\">ValueFileter</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">,</span>now_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>                                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>                            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>                                _path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments <span class=\"token operator\">=</span> <span class=\"token function\">ValueFileter</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">,</span>now_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>                            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>                            _path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> id<span class=\"token punctuation\">.</span>name<span class=\"token operator\">+</span><span class=\"token string\">'_'</span><span class=\"token operator\">+</span>now_value<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>                            _path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments <span class=\"token operator\">=</span> <span class=\"token function\">ValueFileter</span><span class=\"token punctuation\">(</span>_path_<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">,</span>now_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token keyword\">in</span> tempdict<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>            path<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span><span class=\"token function\">insertBefore</span><span class=\"token punctuation\">(</span>tempdict<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>因为函数调用这一部分，都是采用的第一个形参作为控制流的变量，因此，我们这里采用将形参取出来，用于对控制流进行节点合并，然后单独生成一个对应这个形参包含的流程的控制流，接着把这个封装成一个函数 (命名包含形参的值为区分)，接着把函数调用处的变量名称改为与函数对应的形式，然后将实参结构调整，最后再将大控制流删除。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token operator\">...</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function\">j5_32</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vl</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>       <span class=\"token function\">j5_24</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token function\">j5_57</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token function\">j5_22</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        qH <span class=\"token operator\">=</span> <span class=\"token function\">j5_7</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        lH <span class=\"token operator\">=</span> <span class=\"token function\">j5_39</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token function\">j5_9</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token function\">j5_14</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token function\">j5_5</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token operator\">...</span><span class=\"token operator\">...</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token operator\">...</span><span class=\"token operator\">...</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token function\">j5_32</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>这里我们可以看到，整个的流程其实是从j5_32进去，然后调用其中的很多控制流啥的，同时注意到，这里面的参数为字面量，因此可以进一步还原。</pre></td></tr></table></figure><p>接下来就对类似这种 j5_24 ([]) 的进行一个还原。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> FuncChange <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">FunctionDeclaration</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span>params<span class=\"token punctuation\">,</span>body<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>id <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">let</span> func_name <span class=\"token operator\">=</span> id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">let</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">let</span> references <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> reference <span class=\"token keyword\">of</span> references<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isCallExpression</span><span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isArrayExpression</span><span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> reference<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">.</span>length<span class=\"token operator\">===</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">.</span>length<span class=\"token operator\">===</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isVariableDeclarator</span><span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>length<span class=\"token operator\">></span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token keyword\">of</span> body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                            reference<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span><span class=\"token function\">insertBefore</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                        reference<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isReturnStatement</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                            reference<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                        reference<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token comment\">// path.remove();</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这时候，我们就发现上述流程变成了这种形式</p>\n<p><img data-src=\"http://pic.ddddhm.cn/ti%E8%BF%98%E5%8E%9F/image-20220220192508585.png\" alt=\"image-20220220192508585\"></p>\n<p>跟进去 j5_57 这个函数，以及 j5_14 这个函数。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">j5_57</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">RW</span> <span class=\"token operator\">=</span> vl<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> Dg <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> Dg <span class=\"token operator\">&lt;</span> <span class=\"token constant\">RW</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> Dg <span class=\"token operator\">=</span> Dg <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      ff<span class=\"token punctuation\">[</span><span class=\"token constant\">RW</span><span class=\"token punctuation\">[</span>Dg<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">var</span> <span class=\"token constant\">CW</span> <span class=\"token operator\">=</span> <span class=\"token constant\">RW</span><span class=\"token punctuation\">[</span>Dg<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">JW</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">OW</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>          <span class=\"token keyword\">var</span> <span class=\"token constant\">WW</span> <span class=\"token operator\">=</span> <span class=\"token function\">j5_52</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token constant\">JW</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">OW</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>          ff<span class=\"token punctuation\">[</span><span class=\"token constant\">CW</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token constant\">WW</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>          <span class=\"token keyword\">return</span> <span class=\"token constant\">WW</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token function\">j5_14</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">var</span> Rg <span class=\"token operator\">=</span> vl<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> Dg <span class=\"token operator\">=</span> Rg<span class=\"token punctuation\">[</span>cH<span class=\"token punctuation\">[</span><span class=\"token constant\">U5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> Dg <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">--</span>Dg<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      ff<span class=\"token punctuation\">[</span>Rg<span class=\"token punctuation\">[</span>Dg<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">var</span> Cg <span class=\"token operator\">=</span> Rg<span class=\"token punctuation\">[</span>Dg<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">Jg<span class=\"token punctuation\">,</span> Og<span class=\"token punctuation\">,</span> Wg</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token keyword\">var</span> Pg <span class=\"token operator\">=</span> <span class=\"token constant\">HB_7</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>Jg<span class=\"token punctuation\">,</span> Og<span class=\"token punctuation\">,</span> Wg<span class=\"token punctuation\">,</span> qH<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          ff<span class=\"token punctuation\">[</span>Cg<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token keyword\">return</span> Pg<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>          <span class=\"token keyword\">return</span> Pg<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>我们可以看到。这里就是对 ff 对象赋予方法的地方，本质上是通过传入的数组，对其采取一个 for 循环遍历，然后生成一个函数。</p>\n<p>在控制台打印 j5_57 这个里面 for 循环生成的函数：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Sh <span class=\"token operator\">===</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">JW</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">OW</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>          <span class=\"token keyword\">var</span> <span class=\"token constant\">WW</span> <span class=\"token operator\">=</span> <span class=\"token function\">j5_52</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token constant\">JW</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">OW</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>          ff<span class=\"token punctuation\">[</span><span class=\"token constant\">CW</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token constant\">WW</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>          <span class=\"token keyword\">return</span> <span class=\"token constant\">WW</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">//Sh 指代数组中对应索引的参数，这里的 CW 指代的就是 Sh。</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">// 修改一下</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>ff<span class=\"token punctuation\">[</span><span class=\"token string\">'Sh'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">JW</span><span class=\"token punctuation\">,</span><span class=\"token constant\">OW</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">WW</span> <span class=\"token operator\">=</span> <span class=\"token function\">j5_52</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token constant\">JW</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">OW</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    ff<span class=\"token punctuation\">[</span><span class=\"token string\">'Sh'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token constant\">WW</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token constant\">WW</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>接着观察源代码，<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1mZi1zMDRjOTJnZzFmdnNkZjZlb3E4ZGtsZmp1MGYuU2g=\">发现其存在大量的 ff.Sh</span> ('a',b) 类似这种形式的调用。也就是说传入了一个字面量和一个变量，跟栈进行观察，可以发现这个这个变量其实是在 j5_24 ([]) 这个流程中生成的，批量替换一次即可。同时，发现了这里的异常点，就是在初始化完成后，传入一次形参，然后这个函数的结果就会一直为该形参，后续在更改任何参数都不会改变其值。</p>\n<p>接下来看 j5_52 流程中在干啥。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">j5_52</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">MP</span> <span class=\"token operator\">=</span> vl<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">var</span> zP <span class=\"token operator\">=</span> vl<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">LP</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\\\\K2[Ja:r=jVn&#123;L!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">GP</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> Dg <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> Dg <span class=\"token operator\">&lt;</span> <span class=\"token constant\">MP</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>Dg<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token keyword\">var</span> <span class=\"token constant\">EP</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Dg <span class=\"token operator\">+</span> zP<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token constant\">LP</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token keyword\">var</span> <span class=\"token constant\">IP</span> <span class=\"token operator\">=</span> <span class=\"token constant\">MP</span><span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span>Dg<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token constant\">LP</span><span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token constant\">EP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token constant\">GP</span> <span class=\"token operator\">+=</span> <span class=\"token constant\">HB_42</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token constant\">IP</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">GP</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">// 首先传入了一个数组，包含两个参数，分别赋值给 MP,zP, 然后通过对 MP 的长度进行遍历，接着对索引以及第二个参数进行一个求和，在除以 LP 的长度，接着对 MP 以及 LP 返回一个 Unicode 编码，最后将该参数传入 HB_42 这个流程与开头的 GP 加和。</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">HB_42</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dB</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">F5</span> <span class=\"token operator\">=</span> dB<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">F5</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">65535</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token keyword\">return</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token constant\">F5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token constant\">F5</span> <span class=\"token operator\">-=</span> <span class=\"token number\">65536</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token keyword\">return</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token constant\">F5</span> <span class=\"token operator\">>></span> sB<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">55296</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">F5</span> <span class=\"token operator\">%</span> <span class=\"token number\">1024</span> <span class=\"token operator\">+</span> <span class=\"token number\">56320</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">//HB_42 中是对传入的阐述进行了一个判断，将 Unicode 编码转化为了字符。</span></pre></td></tr></table></figure><p>接着看 j5_14 这个流程与 j5_57 有什么不同，由于该流程中包含大量的其他部分的调用，因此，先对字面量进行一个简单的还原。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> ZvarRepalce <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">AssignmentExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>left<span class=\"token punctuation\">,</span>operator<span class=\"token punctuation\">,</span>right<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">let</span> ass_name <span class=\"token operator\">=</span> left<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>operator <span class=\"token operator\">!==</span> <span class=\"token string\">'='</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isExpressionStatement</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isIdentifier</span><span class=\"token punctuation\">(</span>left<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isNumericLiteral</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>path<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">.</span>id <span class=\"token operator\">||</span> path<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> <span class=\"token string\">'j5_32'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">let</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>ass_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>binding<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">let</span> references <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> reference <span class=\"token keyword\">of</span> references<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                reference<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isArrayExpression</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isAssignmentExpression</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">let</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>ass_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>binding<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">let</span> references <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>binding<span class=\"token punctuation\">.</span>referenced<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> reference <span class=\"token keyword\">of</span> references<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isMemberExpression</span><span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> types<span class=\"token punctuation\">.</span><span class=\"token function\">isNumericLiteral</span><span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                    reference<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">[</span>reference<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                    reference<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token comment\">// path.remove();</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>接着看流程：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">j5_14</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">var</span> Rg <span class=\"token operator\">=</span> vl<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token comment\">// 与上述流程类似</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> Dg <span class=\"token operator\">=</span> Rg<span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> Dg <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">--</span>Dg<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      ff<span class=\"token punctuation\">[</span>Rg<span class=\"token punctuation\">[</span>Dg<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">var</span> Cg <span class=\"token operator\">=</span> Rg<span class=\"token punctuation\">[</span>Dg<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">Jg<span class=\"token punctuation\">,</span> Og<span class=\"token punctuation\">,</span> Wg</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>          <span class=\"token keyword\">var</span> Pg <span class=\"token operator\">=</span> <span class=\"token constant\">HB_7</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>Jg<span class=\"token punctuation\">,</span> Og<span class=\"token punctuation\">,</span> Wg<span class=\"token punctuation\">,</span> qH<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>          ff<span class=\"token punctuation\">[</span>Cg<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">return</span> Pg<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>          <span class=\"token keyword\">return</span> Pg<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">HB_7</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dB</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">var</span> kl <span class=\"token operator\">=</span> dB<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">QH</span> <span class=\"token operator\">=</span> dB<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">var</span> kH <span class=\"token operator\">=</span> dB<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">var</span> xH <span class=\"token operator\">=</span> dB<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">BH</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    nH <span class=\"token operator\">=</span> kl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token comment\">// 只有当第三个参数大于 0 才进入流程</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>kH <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>       <span class=\"token comment\">// 对第二个参数进行判断，若符合进入 117 流程</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"constructor\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> wf<span class=\"token punctuation\">[</span><span class=\"token string\">\"Array\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token constant\">QH</span> <span class=\"token operator\">>=</span> xH<span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>xH <span class=\"token operator\">==</span> <span class=\"token punctuation\">[</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">55</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">54</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">27</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">58</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">27</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">84</span><span class=\"token punctuation\">,</span> <span class=\"token number\">52</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">73</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">42</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">51</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">27</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">89</span><span class=\"token punctuation\">,</span> <span class=\"token number\">81</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">63</span><span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">57</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">84</span><span class=\"token punctuation\">,</span> <span class=\"token number\">67</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">76</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">67</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">73</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>          <span class=\"token constant\">BH</span> <span class=\"token operator\">+=</span> <span class=\"token function\">j5_117</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>nH<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token constant\">BH</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"constructor\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> wf<span class=\"token punctuation\">[</span><span class=\"token string\">\"Array\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">var</span> <span class=\"token constant\">HH</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>xH<span class=\"token punctuation\">[</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">var</span> gH <span class=\"token operator\">=</span> <span class=\"token constant\">HB_7</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>nH<span class=\"token punctuation\">,</span> <span class=\"token constant\">QH</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> kH<span class=\"token punctuation\">,</span> <span class=\"token constant\">HH</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token constant\">BH</span> <span class=\"token operator\">+=</span> gH<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token constant\">QH</span> <span class=\"token operator\">=</span> <span class=\"token constant\">QH</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        kH <span class=\"token operator\">-=</span> <span class=\"token function\">j5_728</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>gH<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>xH<span class=\"token punctuation\">[</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"constructor\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> wf<span class=\"token punctuation\">[</span><span class=\"token string\">\"Array\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token keyword\">var</span> <span class=\"token constant\">HH</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>xH<span class=\"token punctuation\">[</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">var</span> gH <span class=\"token operator\">=</span> <span class=\"token constant\">HB_7</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>nH<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> kH<span class=\"token punctuation\">,</span> <span class=\"token constant\">HH</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token constant\">BH</span> <span class=\"token operator\">+=</span> gH<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        kH <span class=\"token operator\">-=</span> <span class=\"token function\">j5_728</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>gH<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token constant\">BH</span> <span class=\"token operator\">+=</span> <span class=\"token function\">j5_117</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>nH<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        nH <span class=\"token operator\">+=</span> xH<span class=\"token punctuation\">[</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token operator\">--</span>kH<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>      <span class=\"token operator\">++</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">BH</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>进入 117 流程发现，其实也还是将其转化为一个 unicode 编码的形式，本质上这两个过程都是将传入的参数进行编码解码操作。</p>\n<p>试着把这些全抠出来。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 环境加载</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ff <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>window <span class=\"token operator\">=</span> global<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>wf <span class=\"token operator\">=</span> window<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">j5_57</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">RW</span> <span class=\"token operator\">=</span> vl<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> Dg <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> Dg <span class=\"token operator\">&lt;</span> <span class=\"token constant\">RW</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> Dg <span class=\"token operator\">=</span> Dg <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      ff<span class=\"token punctuation\">[</span><span class=\"token constant\">RW</span><span class=\"token punctuation\">[</span>Dg<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">var</span> <span class=\"token constant\">CW</span> <span class=\"token operator\">=</span> <span class=\"token constant\">RW</span><span class=\"token punctuation\">[</span>Dg<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">JW</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">OW</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>          <span class=\"token keyword\">var</span> <span class=\"token constant\">WW</span> <span class=\"token operator\">=</span> <span class=\"token function\">j5_52</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token constant\">JW</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">OW</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>          ff<span class=\"token punctuation\">[</span><span class=\"token constant\">CW</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token constant\">WW</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token keyword\">return</span> <span class=\"token constant\">WW</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">j5_52</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">MP</span> <span class=\"token operator\">=</span> vl<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">var</span> zP <span class=\"token operator\">=</span> vl<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">LP</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\\\\K2[Ja:r=jVn&#123;L!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">GP</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> Dg <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> Dg <span class=\"token operator\">&lt;</span> <span class=\"token constant\">MP</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>Dg<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      <span class=\"token keyword\">var</span> <span class=\"token constant\">EP</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Dg <span class=\"token operator\">+</span> zP<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token constant\">LP</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token keyword\">var</span> <span class=\"token constant\">IP</span> <span class=\"token operator\">=</span> <span class=\"token constant\">MP</span><span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span>Dg<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token constant\">LP</span><span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token constant\">EP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token constant\">GP</span> <span class=\"token operator\">+=</span> <span class=\"token constant\">HB_42</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token constant\">IP</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">GP</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">HB_42</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dB</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">F5</span> <span class=\"token operator\">=</span> dB<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">F5</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">65535</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>      <span class=\"token keyword\">return</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token constant\">F5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>      <span class=\"token constant\">F5</span> <span class=\"token operator\">-=</span> <span class=\"token number\">65536</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>      <span class=\"token keyword\">return</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token constant\">F5</span> <span class=\"token operator\">>></span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">55296</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">F5</span> <span class=\"token operator\">%</span> <span class=\"token number\">1024</span> <span class=\"token operator\">+</span> <span class=\"token number\">56320</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">j5_14</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token keyword\">var</span> Rg <span class=\"token operator\">=</span> vl<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> Dg <span class=\"token operator\">=</span> Rg<span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> Dg <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">--</span>Dg<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>      ff<span class=\"token punctuation\">[</span>Rg<span class=\"token punctuation\">[</span>Dg<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token keyword\">var</span> Cg <span class=\"token operator\">=</span> Rg<span class=\"token punctuation\">[</span>Dg<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">Jg<span class=\"token punctuation\">,</span> Og<span class=\"token punctuation\">,</span> Wg</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>          <span class=\"token keyword\">var</span> Pg <span class=\"token operator\">=</span> <span class=\"token constant\">HB_7</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>Jg<span class=\"token punctuation\">,</span> Og<span class=\"token punctuation\">,</span> Wg<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">55</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">54</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">27</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">58</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">27</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">84</span><span class=\"token punctuation\">,</span> <span class=\"token number\">52</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">73</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">42</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">51</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">27</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">89</span><span class=\"token punctuation\">,</span> <span class=\"token number\">81</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">63</span><span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">57</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">84</span><span class=\"token punctuation\">,</span> <span class=\"token number\">67</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">76</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">67</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">73</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>          ff<span class=\"token punctuation\">[</span>Cg<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>            <span class=\"token keyword\">return</span> Pg<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>          <span class=\"token keyword\">return</span> Pg<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">j5_117</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">DP</span> <span class=\"token operator\">=</span> vl<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">DP</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">65535</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>      <span class=\"token keyword\">return</span> wf<span class=\"token punctuation\">[</span><span class=\"token string\">\"String\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"fromCharCode\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>      <span class=\"token constant\">DP</span> <span class=\"token operator\">-=</span> <span class=\"token number\">65536</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>      <span class=\"token keyword\">return</span> wf<span class=\"token punctuation\">[</span><span class=\"token string\">\"String\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"fromCharCode\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"apply\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DP</span> <span class=\"token operator\">>></span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">55296</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">DP</span> <span class=\"token operator\">%</span> <span class=\"token number\">1024</span> <span class=\"token operator\">+</span> <span class=\"token number\">56320</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">j5_728</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">RP</span> <span class=\"token operator\">=</span> vl<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">CP</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> <span class=\"token constant\">JP</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token constant\">JP</span> <span class=\"token operator\">&lt;</span> <span class=\"token constant\">RP</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span><span class=\"token constant\">JP</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>      <span class=\"token keyword\">var</span> <span class=\"token constant\">OP</span> <span class=\"token operator\">=</span> <span class=\"token constant\">RP</span><span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">OP</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">55296</span> <span class=\"token operator\">||</span> <span class=\"token constant\">OP</span> <span class=\"token operator\">></span> <span class=\"token number\">56319</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">CP</span> <span class=\"token operator\">=</span> <span class=\"token constant\">CP</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">CP</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">HB_7</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dB</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>    <span class=\"token keyword\">var</span> kl <span class=\"token operator\">=</span> dB<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">QH</span> <span class=\"token operator\">=</span> dB<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>    <span class=\"token keyword\">var</span> kH <span class=\"token operator\">=</span> dB<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>    <span class=\"token keyword\">var</span> xH <span class=\"token operator\">=</span> dB<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">BH</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    nH <span class=\"token operator\">=</span> kl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>kH <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"constructor\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> wf<span class=\"token punctuation\">[</span><span class=\"token string\">\"Array\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token constant\">QH</span> <span class=\"token operator\">>=</span> xH<span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>xH <span class=\"token operator\">==</span> <span class=\"token punctuation\">[</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">55</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">54</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">27</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">58</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">27</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">84</span><span class=\"token punctuation\">,</span> <span class=\"token number\">52</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">73</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">42</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">51</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">27</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">89</span><span class=\"token punctuation\">,</span> <span class=\"token number\">81</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">63</span><span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">57</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">84</span><span class=\"token punctuation\">,</span> <span class=\"token number\">67</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">76</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">67</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">73</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>          <span class=\"token constant\">BH</span> <span class=\"token operator\">+=</span> <span class=\"token function\">j5_117</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>nH<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token constant\">BH</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"constructor\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> wf<span class=\"token punctuation\">[</span><span class=\"token string\">\"Array\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>        <span class=\"token keyword\">var</span> <span class=\"token constant\">HH</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>xH<span class=\"token punctuation\">[</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>        <span class=\"token keyword\">var</span> gH <span class=\"token operator\">=</span> <span class=\"token constant\">HB_7</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>nH<span class=\"token punctuation\">,</span> <span class=\"token constant\">QH</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> kH<span class=\"token punctuation\">,</span> <span class=\"token constant\">HH</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>        <span class=\"token constant\">BH</span> <span class=\"token operator\">+=</span> gH<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>        <span class=\"token constant\">QH</span> <span class=\"token operator\">=</span> <span class=\"token constant\">QH</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>        kH <span class=\"token operator\">-=</span> <span class=\"token function\">j5_728</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>gH<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>xH<span class=\"token punctuation\">[</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"constructor\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> wf<span class=\"token punctuation\">[</span><span class=\"token string\">\"Array\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>        <span class=\"token keyword\">var</span> <span class=\"token constant\">HH</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>xH<span class=\"token punctuation\">[</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>        <span class=\"token keyword\">var</span> gH <span class=\"token operator\">=</span> <span class=\"token constant\">HB_7</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>nH<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> kH<span class=\"token punctuation\">,</span> <span class=\"token constant\">HH</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>        <span class=\"token constant\">BH</span> <span class=\"token operator\">+=</span> gH<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>        kH <span class=\"token operator\">-=</span> <span class=\"token function\">j5_728</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>gH<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>        <span class=\"token constant\">BH</span> <span class=\"token operator\">+=</span> <span class=\"token function\">j5_117</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>nH<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>        nH <span class=\"token operator\">+=</span> xH<span class=\"token punctuation\">[</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>        <span class=\"token operator\">--</span>kH<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>      <span class=\"token operator\">++</span><span class=\"token constant\">QH</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">BH</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre></pre></td></tr><tr><td data-num=\"127\"></td><td><pre><span class=\"token function\">j5_57</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"cF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Tk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Sh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"KX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"q2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Xm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"nk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Ih\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Zh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Zk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"s2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"xh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Bh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Gh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"nh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"th\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"qh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Hh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Mh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Qh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"jh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Yh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Eh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"zh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ph\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Th\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Ck\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Dk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"W2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"P2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Dh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Lh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Wh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"qF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"B2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Pk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"IX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"EX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"WG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"w2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"MN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Sm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"DG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"IN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"RF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Tm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Oh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Bk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Xk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"U2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"zX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Qm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"zk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"jX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"NX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"EN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Nh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"l9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Yk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"RG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"KN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"qG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"zN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"V9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"LN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Hm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Lm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"qm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"YN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ZG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"IG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Ok\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Jk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"xX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ZX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Ph\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Ah\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"VN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"F9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"FN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Vk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Rh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"c2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Nm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"jm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Wk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"H9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"PN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Kk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Ch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"nG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"jF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"K2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"I2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"JG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Gm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"z2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"L2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"xF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"OX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"k2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"HF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"xQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"MG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"LG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"A2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"UG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"XG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Z2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"M2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"VX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"YX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"v9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"K9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"h9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Zm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"MF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"VF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Z9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"QX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"xN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"QG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"g2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"WN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Km\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"XN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"c9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"PG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Mm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"G9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Ym\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"KG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"P9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"UX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"N2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"OF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Fk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"B9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"q9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ZN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"l2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"C9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Ek\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Em\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"A9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"JX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"HX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"UN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"DN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"FX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"X9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ck\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"R2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"x9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"d2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"D2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Ik\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Sk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"nm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"E2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Cm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Bm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Jm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"p9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Lk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Om\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"qX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"t9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"NF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"O2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"EF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"J2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"WF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"OG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"GN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Rm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"nF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"E9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"HN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"zG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"NN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"xG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"J9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"HG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"w9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"x2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Gk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"O9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"N9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"j9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"G2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"HQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"PF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Rk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"jk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"L9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"LF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Wm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Q2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"JN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"X2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"m2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"qQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Pm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Vm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"MX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"H2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"PX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"S2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"W9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"RN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"QN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"jN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"zQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"LQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"QQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"NQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"GQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Uk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"EG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"v2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"V2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Am\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"T9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"nQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"WX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"EQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Hk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"C2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"R9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"YF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"XX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Y9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"DX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"D9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Uh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"h2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"s9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"j2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"nX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"m9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"YG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Mk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Fh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Xh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"z9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Ak\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"DF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"t2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ZF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"xm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"nN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"jG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ON\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"qN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"JF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"zF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Kh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Im\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"F2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"GG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Dm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"g9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"n9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Q9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"d9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"S9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"GX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"zm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Um\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"b9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"f2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"NG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"f9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"U9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"QF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"XQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"FQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"UQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"n2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"GF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"RX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"IF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"KF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Qk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"MQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"I9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"km\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"M9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"YQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"VG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"p2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Fm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"k9\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"LX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"T2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Y2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Nk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"b2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"xk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"qk\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Vh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Jh\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre><span class=\"token function\">j5_14</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"QU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"xU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"qU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"nU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"HU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"If\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Kf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"MU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"zU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"WU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"zf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"nf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Af\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"DU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"xf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"LU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"jU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"OU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Bf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Rf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"KU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Pf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Zf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"RU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Yf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Tf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Vf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Wf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Of\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"GU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"XF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"YU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ZU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Sf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"FU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Lf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Jf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"EU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"UF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"PU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"FF\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Mf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"IU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"JU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Cf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"df\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Ef\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Hf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"qf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Df\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"UU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"XU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"jf\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"NU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"VU\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这样就把其全部抠出来了。</p>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/01/22/sm%E6%BB%91%E5%9D%97/",
            "url": "http://yida506.github.io/2022/01/22/sm%E6%BB%91%E5%9D%97/",
            "title": "sm滑块",
            "date_published": "2022-01-21T16:12:58.000Z",
            "content_html": "<h4 id=\"sm滑块\"><a class=\"anchor\" href=\"#sm滑块\">#</a> sm 滑块</h4>\n<h5 id=\"受害对象网址滑块验证-xiaohongshucom\"><a class=\"anchor\" href=\"#受害对象网址滑块验证-xiaohongshucom\">#</a> 受害对象网址:\t<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cueGlhb2hvbmdzaHUuY29tL3dlYi1sb2dpbi9jYXB0Y2hhP3JlZGlyZWN0UGF0aD1odHRwJTNBJTJGJTJGd3d3LnhpYW9ob25nc2h1LmNvbSUyRmRpc2NvdmVyeSUyRml0ZW0lMkY2MDVlYjQ5MjAwMDAwMDAwMjEwMzZhYjU=\">滑块验证 (xiaohongshu.com)</span></h5>\n<h6 id=\"step1-网站请求分析\"><a class=\"anchor\" href=\"#step1-网站请求分析\">#</a> STEP1 网站请求分析:</h6>\n<p>加载内容如下:</p>\n<ol>\n<li>加载 HTML (这一部分会 set-cookie 发送 304 请求)，加载一部分 js、css</li>\n<li>发送第一个 web?callback 请求</li>\n<li>发送 conf?callback 请求</li>\n<li>在加载一部分 js</li>\n<li>发送 register 请求</li>\n</ol>\n<blockquote>\n<p>这里发送 register 请求后就拿到了滑块背景以及滑块、同时观察，貌似只有个携带时间戳的参数，以及 organization，</p>\n<p>经测试，register 请求可以直接请求，但是每次请求返回的结果都不一样，</p>\n</blockquote>\n<h6 id=\"step2-滑块分析\"><a class=\"anchor\" href=\"#step2-滑块分析\">#</a> STEP2 滑块分析</h6>\n<p><img data-src=\"http://pic.ddddhm.cn/sm%E6%BB%91%E5%9D%97/image-20220122002747400.png\" alt=\"image-20220122002747400\"></p>\n<p>这里采用倒推分析的方式，对网站进行分析。</p>\n<p>从流程上来看，fverify 是通过一系列参数，返回了一个 success, 然后 captcha 这个请求，返回了一个 fail，因为我们这里是刻意的滑的失败的，那么可以推断出这个接口是对滑块的判断。但是观察 fverify 的请求，里面返回了一个 reject，是拒绝的意思，同时通过堆栈分析，我们发现这个参数其实就 fail 其实一开始貌似就返回了。无论如何，这玩意都指向了 captcha 这段被混淆的 js 文件中。</p>\n<h6 id=\"step3-ast反混淆\"><a class=\"anchor\" href=\"#step3-ast反混淆\">#</a> STEP3 AST 反混淆</h6>\n<p>放入在线网站解析，随便解一下就可以看了。</p>\n<h6 id=\"step4-参数分析\"><a class=\"anchor\" href=\"#step4-参数分析\">#</a> STEP4 参数分析</h6>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>params <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token comment\"># 动</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token string\">\"rid\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"20220225200442d1ad44e138bff05707\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token string\">\"callback\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sm_1645791947136\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token comment\"># 定</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token string\">\"je\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"J95iyFR+B34=\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token comment\"># 定</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token string\">\"vm\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"z7pjc00My60=\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token comment\"># 定</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token string\">\"organization\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"eR46sBuqF0fdw7KWFLYa\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token comment\"># 动</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token string\">\"ub\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"mc4K3qTht9Q=\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token comment\"># 定</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token string\">\"zj\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"YXtzSGH4Kx4=\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token comment\"># 定</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token string\">\"tb\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"jbIXAuW9ClU=\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token comment\"># 定</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token string\">\"fp\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"7syw7ja705o=\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token comment\"># 定</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token string\">\"ox\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AfC9Zsyz+qQ=\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token comment\"># 定</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token string\">\"rr\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"yYCBEY0C7PQ=\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token comment\"># 定</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token string\">\"cn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"4gX7HfzFoIE=\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token comment\"># 定</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token string\">\"ostype\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token comment\"># 动</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token string\">\"zs\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"wV0WZb+HzwwOdciC2PHUjh3F4Z88m1vszY3VkYNhbGI=\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token comment\"># 定</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token string\">\"tq\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"O5y0Gz8bnDY=\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token string\">\"act.os\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"web_pc\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token string\">\"rversion\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1.0.1\"</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>经过分析，上述参数只有 rid,ub,zs 是变化的。</p>\n<ol>\n<li>rid: 上一个命令返回</li>\n<li></li>\n</ol>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/01/18/python%E5%BC%80%E5%8F%91/",
            "url": "http://yida506.github.io/2022/01/18/python%E5%BC%80%E5%8F%91/",
            "title": "python开发",
            "date_published": "2022-01-18T15:42:18.000Z",
            "content_html": "<h3 id=\"基础知识篇\"><a class=\"anchor\" href=\"#基础知识篇\">#</a> 基础知识篇</h3>\n<h4 id=\"多线程\"><a class=\"anchor\" href=\"#多线程\">#</a> 多线程</h4>\n<h5 id=\"basic\"><a class=\"anchor\" href=\"#basic\">#</a> Basic</h5>\n<p>线程为程序的最小执行单位，在 python 中用 Thread 库来控制线程。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> threading</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> time </pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 通过类携带 target 参数，直接生成线程类，同时，current_thread ().name 可以返回当前类的名称，线程的实例化可以通过调用 is_alive () 来判断线程是否存在。</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">test1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>threading<span class=\"token punctuation\">.</span>current_thread<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">test2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>threading<span class=\"token punctuation\">.</span>current_thread<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1.5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>thread1 <span class=\"token operator\">=</span> threading<span class=\"token punctuation\">.</span>Thread<span class=\"token punctuation\">(</span>target<span class=\"token operator\">=</span>test1<span class=\"token punctuation\">,</span> daemon<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># thread2 = threading.Thread(target=test2)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># thread2.start()</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>thread1<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#join 用于对当前线程阻塞</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>thread1<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>threading<span class=\"token punctuation\">.</span>current_thread<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>name<span class=\"token operator\">+</span><span class=\"token string\">' main '</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> thread1<span class=\"token punctuation\">.</span>is_alive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote>\n<p>daemon 设置为 True, 可以在主线程结束时，结束当前线程。</p>\n</blockquote>\n<p>对线程类继承</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">NewThread</span><span class=\"token punctuation\">(</span>threading<span class=\"token punctuation\">.</span>Thread<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span>name<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>threading<span class=\"token punctuation\">.</span>current_thread<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>thread <span class=\"token operator\">=</span> NewThread<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>thread<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"线程池\"><a class=\"anchor\" href=\"#线程池\">#</a> 线程池</h4>\n<p>要想批量创建线程，同时给与每个线程分配任务，就需要线程池。</p>\n<p>主要功能：</p>\n<ol>\n<li>提前性，在分配任务前，就提前创建好线程，供给分配。</li>\n<li>复用性，结束任务的线程放回线程池，供给下一次使用。</li>\n</ol>\n<p>要满足创造线程的数量恒定，以及线程结束后的复用，那么就需要用到队列。</p>\n<h5 id=\"quene\"><a class=\"anchor\" href=\"#quene\">#</a> quene</h5>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> threading</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> time</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> queue <span class=\"token keyword\">import</span> Queue</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Mythread</span><span class=\"token punctuation\">(</span>threading<span class=\"token punctuation\">.</span>Thread<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> que<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        threading<span class=\"token punctuation\">.</span>Thread<span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        self<span class=\"token punctuation\">.</span>queue <span class=\"token operator\">=</span> que</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>queue<span class=\"token punctuation\">.</span>empty<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 判断放到 get 前面，这样可以，否则队列最后一个取完后就空了，直接 break，走不到 print</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'队列的长度'</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>queue<span class=\"token punctuation\">.</span>qsize<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            item <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>queue<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">,</span> <span class=\"token string\">'!'</span><span class=\"token punctuation\">,</span> threading<span class=\"token punctuation\">.</span>current_thread<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token comment\"># 队列包含内置运行状态 unfinished_tasks 表示剩余任务队列的状态，假如队列中没有任务则停止</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            self<span class=\"token punctuation\">.</span>queue<span class=\"token punctuation\">.</span>task_done<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\"># 貌似会先吧 join 前的任务全放入队列</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>que <span class=\"token operator\">=</span> Queue<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\"># 创建线程队列，这里创建了 2 个线程</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>tasks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>Mythread<span class=\"token punctuation\">(</span>que<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">#指定任务队列，用于生产任务，这里生产了 5 个任务</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    que<span class=\"token punctuation\">.</span>put<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 快速生产</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> tasks<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    x<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 把同一个队列传入 2 个线程</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    que<span class=\"token punctuation\">.</span>put<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>que<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'success'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>上述已经展示了任务队列以及多线程的简单使用。</p>\n<h4 id=\"类\"><a class=\"anchor\" href=\"#类\">#</a> 类</h4>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/01/09/%E9%AA%8C%E8%AF%81%E7%A0%81/",
            "url": "http://yida506.github.io/2022/01/09/%E9%AA%8C%E8%AF%81%E7%A0%81/",
            "title": "验证码",
            "date_published": "2022-01-09T12:18:41.000Z",
            "content_html": "<h4 id=\"验证码概述\"><a class=\"anchor\" href=\"#验证码概述\">#</a> 验证码概述</h4>\n<p>所谓验证码，就是采取一定的手段，对爬虫采集数据增加一定的难度，要想从 js 端突破这个问题，就需要对验证码的传输过程有一定的了解，这里仍然以 jy 滑块为例。</p>\n<h4 id=\"jy滑块\"><a class=\"anchor\" href=\"#jy滑块\">#</a> JY 滑块</h4>\n<h5 id=\"流程分析\"><a class=\"anchor\" href=\"#流程分析\">#</a> 流程分析</h5>\n<h6 id=\"页面初始化\"><a class=\"anchor\" href=\"#页面初始化\">#</a> 页面初始化</h6>\n<p><img data-src=\"http://pic.ddddhm.cn/%E9%AA%8C%E8%AF%81%E7%A0%81/image-20220109214733411.png\" alt=\"image-20220109214733411\"></p>\n<p>首先 F12 对网页进行抓包可以看到，这里首先是加载了一个 html 页面，然后加载了 2 个 js，接着，向服务器发送了一个 register 请求，这里的 t 参数是时间戳，然后返回了 gt,challenge 这两个主要参数，然后是 geetype 请求，主要是用于请求 Js, 然后加载了 fullpage 这个 js，之后是向服务器发送了一个 get 请求，这里使用了 gt、challenge、lang、pt、client_type、w、callback，这几个参数。</p>\n<p>其中 callback 后携带了一个时间戳，w 这个参数包含了一系列的加密操作，gt、challenge 这两个参数由之前的 register 请求获取，剩下的可以写死。</p>\n<blockquote>\n<p>此处 w 值主要是通过三个流程：</p>\n<ol>\n<li>u 值：生成随机数作为公钥，对其进行加密。</li>\n<li>l 值：对一个初始对象以及公钥进行组合加密成一个数组</li>\n<li>h 值：对 l 值进行一个处理。</li>\n<li>w=h+u;</li>\n</ol>\n</blockquote>\n<p>然后，这个 get 请求会返回一系列参数其中包含一个 s 参数 (后续会用到)。</p>\n<h6 id=\"提交过程\"><a class=\"anchor\" href=\"#提交过程\">#</a> 提交过程</h6>\n<p>在点击页面的提交按钮的时候，会返回如下数据。</p>\n<p><img data-src=\"http://pic.ddddhm.cn/%E9%AA%8C%E8%AF%81%E7%A0%81/image-20220109221913141.png\" alt=\"image-20220109221913141\"></p>\n<p>首先提交了一个 ajax 请求，然后，就可以触发下面那个 get.php 请求，就可以获取到包含滑块等数据的包，但是，这个 w 值的加密与上述有所不同。</p>\n<blockquote>\n<ol>\n<li>首先初始化一系列参数，包含对鼠标轨迹初始化的流程、空数组初始化、长字符串生成 (包含时间戳)、随机生成的字符串、大对象 (包含 gt、challenge、aeskey、时间戳、s 等).</li>\n<li>接下来对上述参数进行一系列处理，然后在初始化一个对象 (对象中包含鼠标开始位置数据、鼠标结束数据、显卡类型等一系列参数) 和一个包含时间戳的大字符串。</li>\n<li>将这些参数进行一个拼接，然后使用公钥进行加密，得到 w 值。</li>\n</ol>\n</blockquote>\n<h6 id=\"滑动过程\"><a class=\"anchor\" href=\"#滑动过程\">#</a> 滑动过程</h6>\n<p>​</p>\n<p>滑动滑块，会弹出一个请求，这里的 w 为加密轨迹后的参数。由于进入了另一个 js，所以生成了新的公钥，这里的加密过程与页面初始化的流程一模一样，唯一不同的是这里第二步传入的参数和包含鼠标轨迹，不过多赘述。</p>\n<h5 id=\"轨迹生成\"><a class=\"anchor\" href=\"#轨迹生成\">#</a> 轨迹生成</h5>\n<h4 id=\"顶象滑块\"><a class=\"anchor\" href=\"#顶象滑块\">#</a> 顶象滑块</h4>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9tLmFpcmNoaW5hLmNvbS5jbi9hYy9jL2ludm9rZS9yZXNldC9jaGVja1Bob25lQHBn\">https://m.airchina.com.cn/ac/c/invoke/reset/checkPhone@pg</span></p>\n<h4 id=\"数美滑块\"><a class=\"anchor\" href=\"#数美滑块\">#</a> 数美滑块</h4>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cueGlhb2hvbmdzaHUuY29tL3dlYi1sb2dpbi9jYXB0Y2hhP3JlZGlyZWN0UGF0aD1odHRwJTNBJTJGJTJGd3d3LnhpYW9ob25nc2h1LmNvbSUyRmRpc2NvdmVyeSUyRml0ZW0lMkY2MDVlYjQ5MjAwMDAwMDAwMjEwMzZhYjU=\">滑块验证 (xiaohongshu.com)</span></p>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2022/01/01/ast%E6%80%9D%E6%83%B3/",
            "url": "http://yida506.github.io/2022/01/01/ast%E6%80%9D%E6%83%B3/",
            "title": "ast思想",
            "date_published": "2022-01-01T14:43:33.000Z",
            "content_html": "<h4 id=\"ast思考\"><a class=\"anchor\" href=\"#ast思考\">#</a> AST 思考</h4>\n<p>本篇重在介绍关于 ast 还原代码的一些逻辑。</p>\n<p>首先，我们知道，以目前常见的混淆来讲，大部分其实是通过不断地调用一个类似生成函数的地方，来调用。</p>\n<p>我们在分析时，往往想看到其直接调用的位置，那么，我们就需要将所谓的生成入口写入内存中，然后直接调用进而达到直接将调用的结果展示出来。</p>\n<p>通常，普通的混淆生成入口有如下四种：</p>\n<ul>\n<li>数组型</li>\n<li>函数形</li>\n<li>对象型</li>\n<li>组合型</li>\n</ul>\n<h5 id=\"数组型\"><a class=\"anchor\" href=\"#数组型\">#</a> 数组型</h5>\n<p>所谓数组型，就是类似以数组的形式，通过数组下标访问。例如：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> arrlist <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> arrlist<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>对于该种情况，我们抽象为如下四步：</p>\n<ul>\n<li>确定要遍历的对象，这里是 VariableDeclarator。</li>\n<li>接下来是判断 init 部分的类型，因为可能还有许多声明其他变量的部分，我们希望的是只遍历右边是数组类型的。</li>\n<li>然后是将其写入内存，直接采用 eval 的方式 (最好将其写入全局变量中)。</li>\n<li>最后是访问数组的作用域，找到其引用，然后直接替换节点即可。</li>\n</ul>\n<h5 id=\"函数形\"><a class=\"anchor\" href=\"#函数形\">#</a> 函数形</h5>\n<p>所谓函数形，即声明的类型是函数，通过函数访问。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 类型 1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">add1</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span>b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// 类型 2</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">add2</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span>b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">var</span> c <span class=\"token operator\">=</span> <span class=\"token function\">add1</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">add2</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>该类情况与数组大致相同，只不过在遍历时候还需考虑第二种情况：</p>\n<ul>\n<li>确定要遍历的对象，这里是 FunctionExpression，针对情况 1，可以直接通过 path.parent.id.name 获取函数昵称，针对情况 2，可以通过 path.node.id.name 获取函数昵称。</li>\n<li>接下来是对函数体结构的判断，必须要有该函数的引用，其次，该函数可以通过传入的值，直接计算出结果。</li>\n<li>然后是将其写入内存，直接采用 eval 的方式 (最好将其写入全局变量中)。</li>\n<li>最后是访问函数的作用域，找到其引用，然后直接替换节点即可。</li>\n</ul>\n<h5 id=\"对象型\"><a class=\"anchor\" href=\"#对象型\">#</a> 对象型</h5>\n<p>所谓对象型，就是声明了一个大对象，通过调用的方式访问。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token string\">'a'</span><span class=\"token operator\">:</span><span class=\"token number\">123</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token string\">'b'</span><span class=\"token operator\">:</span><span class=\"token number\">456</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">var</span> c <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这个的本质与数组可以说是一模一样，在此不做赘述。</p>\n<h5 id=\"组合型\"><a class=\"anchor\" href=\"#组合型\">#</a> 组合型</h5>\n<p>所谓的组合型，就是通过对象、数组、函数的组合方式，使得其变得复杂化，进而加大一键脱混淆的难度，进而使得我们需要针对型的修改插件，才能使得混淆得以脱掉。</p>\n<blockquote>\n<p>补充：其实上述也可以通过访问调用然后遍历其作用域，进而找到其声明部分替换，但是假如引用作用域中包含了对原对象的修改，那么在遍历时，可能会造成一定的难度。</p>\n</blockquote>\n<p>目前来讲个人的解混淆思路倾向于写入式：</p>\n<p>针对不同的情况，若是一个对象、函数、变量，经常被调用，那么我会将其写入内存，然后直接通过访问内存中的属性来修改节点。</p>\n",
            "tags": [
                "ast"
            ]
        },
        {
            "id": "http://yida506.github.io/2021/12/29/ast%E8%BF%9B%E9%98%B6/",
            "url": "http://yida506.github.io/2021/12/29/ast%E8%BF%9B%E9%98%B6/",
            "title": "ast进阶",
            "date_published": "2021-12-29T14:35:31.000Z",
            "content_html": "<h4 id=\"ast基本命令\"><a class=\"anchor\" href=\"#ast基本命令\">#</a> AST 基本命令</h4>\n<h5 id=\"path\"><a class=\"anchor\" href=\"#path\">#</a> path</h5>\n<p>path 为 AST 解析后的产物，在解析时，先将所有代码解析为一个大 file, 其中拥有 path 属性，若是针对一种表达式解析 (例如 VariableDeclarator 赋值表达式)，那么 path 指代的就为赋值表达式所在的路径，其中又包含很多属性，主要的有：</p>\n<ul>\n<li>type: 表示表达式类型</li>\n<li>node 表示该节点、为一个对象、包含很多属性</li>\n<li>parent: 该路径的父路径，这里指代的是 node 类型，若要获取 path 类型需要 path.parentPath.</li>\n</ul>\n<blockquote>\n<p>如 var a = b; 那么 a=b 为赋值表达式当前路径、var a = b 为父路径。</p>\n</blockquote>\n<ul>\n<li>scope: 作用域</li>\n</ul>\n<blockquote>\n<p>path.toString () 可以打印出当前代码位置.</p>\n</blockquote>\n<h5 id=\"node\"><a class=\"anchor\" href=\"#node\">#</a> node</h5>\n<p>node 本质上是一个对象，内置属性如下 (仍以 VariableDeclarator 为例)：</p>\n<ul>\n<li>type: 表示表达式类型</li>\n<li>start: 开始位置</li>\n<li>end: 结束位置</li>\n<li>id: 对应左半部分，也为节点类型</li>\n<li>init: 对应右半部分，也为节点类型</li>\n</ul>\n<blockquote>\n<p>node 可以采用 generator (path.node).code 的方式获取当前代码位置.</p>\n</blockquote>\n<h5 id=\"binding\"><a class=\"anchor\" href=\"#binding\">#</a> binding</h5>\n<p>绑定，为 scope 中的属性，要使用 path.scope.getBinding (name) 得到，其中 name 为想要绑定对象昵称。</p>\n<p>block: 指代整体 path?</p>\n<p>binding.constant：Boolean (表示是否被修改过值),constantViolations 表示修改值的位置。</p>\n<p>referencePaths: 绑定对象所在区域，例如：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> a <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>在对第一个表达式遍历的时候，a 对应的 referencePaths 为 var b = a+ 1 其中的 a，即我们可以通过该方式替换节点的值，达到批量修改的目的。</p>\n<h5 id=\"浅层检查\"><a class=\"anchor\" href=\"#浅层检查\">#</a> 浅层检查</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>t<span class=\"token punctuation\">.</span><span class=\"token function\">isIdentifier</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"n\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>等价于</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>left <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">\"Identifier\"</span> <span class=\"token operator\">&amp;&amp;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> <span class=\"token string\">\"n\"</span></pre></td></tr></table></figure><h5 id=\"get方法\"><a class=\"anchor\" href=\"#get方法\">#</a> get 方法</h5>\n<p>使用 path.get ('target')，可以获得对应的 path 路径，相比于直接获取 node 节点，在确定作用域的时候更有效，比如：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span>b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 对于上述自执行函数，我们通过遍历 CallExpression 节点，然后通过 path.scope.getBinding ('a') 的方法只能获取到 undefined, 这是由于，当前的 path 指代的是外部作用域，不能指向自执行函数内部，因此，想要获取到 'a' 的 binding, 就需要通过 path.get ('callee') 的方法，获取内部函数的作用域，这样一来就可以通过遍历的方式 j</span></pre></td></tr></table></figure><h4 id=\"插件优化\"><a class=\"anchor\" href=\"#插件优化\">#</a> 插件优化</h4>\n<h5 id=\"变量替换\"><a class=\"anchor\" href=\"#变量替换\">#</a> 变量替换</h5>\n<p>目的：将赋值表达式值为字面量、数字的直接批量替换</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> visitor <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span>init<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token comment\">// 获取对应变量的绑定</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">var</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">// 获取绑定作用域</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        referpaths <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 如果变量没引用，则返回</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>referpaths<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 保证变量的 init 部分值唯一，数字、字符类型直接替换，函数定义也可直接替换，前提是引用部分为单引用，若为函数调用，可考虑直接计算值。</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">// 遍历绑定作用域</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>referpath <span class=\"token keyword\">of</span> referpaths<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token comment\">// 节点值替换</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            referpath<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>init<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\">// 节点删除</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"数组对象还原\"><a class=\"anchor\" href=\"#数组对象还原\">#</a> 数组对象还原</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>var b = ['asdad'].concat(function()&#123;return arguments&#125;);</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>var c = b[1];</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>b.shift();</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>var d = b[0];</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>*/</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// 通过遍历声明节点，找到数组命名的位置，然后将其写入内存，接着在将</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">const</span> visitor12 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span> init<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">var</span> func_name <span class=\"token operator\">=</span> id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">var</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">var</span> referpaths <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\">// 如果变量没引用，则返回</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>referpaths<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token comment\">// 保证变量的 init 部分值唯一，数字、字符类型直接替换，函数定义也可直接替换，前提是引用部分为单引用，若为函数调用，可考虑直接计算值。</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token comment\">// 单独针对这种情况，不考虑单纯的数组。</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isCallExpression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> types<span class=\"token punctuation\">.</span><span class=\"token function\">isArrayExpression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token comment\">// 将数组中的内容直接写入内存</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> <span class=\"token string\">'concat'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">var</span> old_arr <span class=\"token operator\">=</span> init<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            global<span class=\"token punctuation\">[</span>func_name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> old_arr<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token comment\">// 遍历作用域，获取修改值的地址</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token function\">MemberExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                    <span class=\"token comment\">// 后面可能还要确保只修改一次的情况</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                        <span class=\"token keyword\">let</span> index_value <span class=\"token operator\">=</span> _path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                        _path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>index_value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                    <span class=\"token comment\">// 若包含 shift 操作</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property <span class=\"token operator\">&amp;&amp;</span> _path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'shift'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                        global<span class=\"token punctuation\">[</span>func_name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"自执行函数还原\"><a class=\"anchor\" href=\"#自执行函数还原\">#</a> 自执行函数还原</h5>\n<h6 id=\"思路1使用referencepath对其进行回填\"><a class=\"anchor\" href=\"#思路1使用referencepath对其进行回填\">#</a> 思路 1: 使用 referencePath 对其进行回填。</h6>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>(function (a,b)&#123;console.log (a+b)&#125;)(3,4)------->console.log (3+4)</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>自执行函数为 CallExpression 块，callee 指向 FunctionExpression, 需要做的就是将 block 块中提取，然后将变量值回填，</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>简单来讲，假如这个值没有被修改啥的，直接遍历即可</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>*/</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span>b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">var</span> arr <span class=\"token operator\">=</span> arguments<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">!==</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        arr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    a <span class=\"token operator\">=</span> a<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">var</span> c <span class=\"token operator\">=</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">// 自执行函数回填</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">const</span> self_func_replace <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">CallExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">let</span> callee <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'callee'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>arguments<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isFunctionExpression</span><span class=\"token punctuation\">(</span>callee<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">var</span> <span class=\"token punctuation\">&#123;</span>params<span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> callee<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token comment\">// 遍历形参数组，进行回填</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>arguments<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            binding <span class=\"token operator\">=</span> callee<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            references <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token comment\">// 遍历当前形参的 Binding 节点，并替换。</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>binding<span class=\"token punctuation\">.</span>constantViolations<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>binding <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>binding<span class=\"token punctuation\">.</span>constant<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>reference <span class=\"token keyword\">of</span> references<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                reference<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span>arguments<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  <span class=\"token keyword\">var</span> arr <span class=\"token operator\">=</span> arguments<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">!==</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    arr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  a <span class=\"token operator\">=</span> a <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  <span class=\"token keyword\">var</span> c <span class=\"token operator\">=</span> a <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>可以看到，由于 a 在作用域中的值被改变了，所以并没有进行回填。</p>\n<p>但是，从实际上来看，这两个值其实都被修改了，所以说，要想用 referencePath 来对其自执行函数进行回填有一定的局限性。</p>\n</blockquote>\n<p><strong>既然我们知道了，是通过一个 for 循环来对传入的 arguments 进行的处理，那么，我们只要把这个 for 循环的算法封装成一个函数，直接输出一个新的 arguments 数组，这样一来，后面替换的时候，就采用新的数组替换不就完了么。</strong></p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">get_arr_node</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">arguments</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token keyword\">of</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        arr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// 对字符的一个处理</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        arr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">return</span> arr</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">// 自执行函数回填</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">const</span> self_func_replace <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token function\">CallExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">let</span> callee <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'callee'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>arguments<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">var</span> new_arguments <span class=\"token operator\">=</span> <span class=\"token function\">get_arr_node</span><span class=\"token punctuation\">(</span>arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isFunctionExpression</span><span class=\"token punctuation\">(</span>callee<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">var</span> <span class=\"token punctuation\">&#123;</span>params<span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> callee<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token comment\">// 遍历形参数组，进行回填</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>arguments<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            binding <span class=\"token operator\">=</span> callee<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            references <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token comment\">// 遍历当前形参的 Binding 节点，并替换。</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>binding <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>binding<span class=\"token punctuation\">.</span>constant<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>reference <span class=\"token keyword\">of</span> references<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                reference<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span>new_arguments<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">!==</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    arguments<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>  a <span class=\"token operator\">=</span> a <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  <span class=\"token keyword\">var</span> c <span class=\"token operator\">=</span> a <span class=\"token operator\">+</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><strong>可以看到，这里已经成功的把 b 填进去，同时也为正确的数了，要做到完全还原，也只需要遍历 a 进行回填即可。</strong></p>\n",
            "tags": [
                "ast"
            ]
        },
        {
            "id": "http://yida506.github.io/2021/12/28/%E5%8F%8D%E8%B0%83%E8%AF%95/",
            "url": "http://yida506.github.io/2021/12/28/%E5%8F%8D%E8%B0%83%E8%AF%95/",
            "title": "js反调试",
            "date_published": "2021-12-28T14:34:35.000Z",
            "content_html": "<h4 id=\"反调试\"><a class=\"anchor\" href=\"#反调试\">#</a> 反调试</h4>\n<p>所谓反调试就是在网站中嵌入 debugger，然后对控制台进行检测，若打开了控制台则进入无限 debugger;</p>\n<p>解决方案:</p>\n<ul>\n<li>直接右键 never pause here</li>\n<li>若采用定时器的形式调用，将其置空</li>\n</ul>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function-variable function\">setInterval</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">//f12 打开断住后输入，再跳过 debugg，就不卡了</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">99999</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><ul>\n<li>\n<p>若在原型链上</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>f<span class=\"token operator\">=</span>Function<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function-variable function\">Function</span><span class=\"token operator\">=</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">!==</span><span class=\"token string\">'debugger'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">Function</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>constructor_<span class=\"token operator\">=</span><span class=\"token class-name\">Function</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>constructor<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">Function</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">constructor</span><span class=\"token operator\">=</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">!==</span><span class=\"token string\">'debugger'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> <span class=\"token class-name\">Function</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">constructor_</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></li>\n<li>\n<p>若位 eval 调用，hook 一下即可</p>\n</li>\n</ul>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>eval_<span class=\"token operator\">=</span>eval<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function-variable function\">eval</span><span class=\"token operator\">=</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">==</span><span class=\"token string\">'debugger'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> <span class=\"token function\">eval_</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2021/12/28/js%E5%8F%8D%E8%B0%83%E8%AF%95/",
            "url": "http://yida506.github.io/2021/12/28/js%E5%8F%8D%E8%B0%83%E8%AF%95/",
            "title": "js反调试",
            "date_published": "2021-12-28T14:34:35.000Z",
            "content_html": "<h4 id=\"反调试\"><a class=\"anchor\" href=\"#反调试\">#</a> 反调试</h4>\n<p>所谓反调试就是在网站中嵌入 debugger，然后对控制台进行检测，若打开了控制台则进入无限 debugger;</p>\n<p>解决方案:</p>\n<ul>\n<li>直接右键 never pause here</li>\n<li>若采用定时器的形式调用，将其置空</li>\n</ul>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function-variable function\">setInterval</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">//f12 打开断住后输入，再跳过 debugg，就不卡了</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">99999</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><ul>\n<li>\n<p>若在原型链上</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>f<span class=\"token operator\">=</span>Function<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function-variable function\">Function</span><span class=\"token operator\">=</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">!==</span><span class=\"token string\">'debugger'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">Function</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>constructor_<span class=\"token operator\">=</span><span class=\"token class-name\">Function</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>constructor<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">Function</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">constructor</span><span class=\"token operator\">=</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">!==</span><span class=\"token string\">'debugger'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> <span class=\"token class-name\">Function</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">constructor_</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></li>\n<li>\n<p>若位 eval 调用，hook 一下即可</p>\n</li>\n</ul>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>eval_<span class=\"token operator\">=</span>eval<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function-variable function\">eval</span><span class=\"token operator\">=</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">==</span><span class=\"token string\">'debugger'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> <span class=\"token function\">eval_</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2021/12/26/jy%E6%BB%91%E5%9D%97/",
            "url": "http://yida506.github.io/2021/12/26/jy%E6%BB%91%E5%9D%97/",
            "title": "jy滑块",
            "date_published": "2021-12-26T05:40:25.000Z",
            "content_html": "<h3 id=\"极验滑块\"><a class=\"anchor\" href=\"#极验滑块\">#</a> 极验滑块：</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ2VldGVzdC5jb20vZGVtby9zbGlkZS1iaW5kLmh0bWw=\">https://www.geetest.com/demo/slide-bind.html</span></p>\n<h4 id=\"登录参数w值\"><a class=\"anchor\" href=\"#登录参数w值\">#</a> 登录参数 w 值</h4>\n<p>F12，点击登录，弹出滑块界面，出现滑块图和背景图，拖动滑块，会发送请求：</p>\n<p>参数如下:gt\\challenge\\w\\callback (其余的貌似不为加密)</p>\n<p>明显，在该请求中生成了这些参数。</p>\n<p>跟值，找到生成参数的位置。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>u <span class=\"token operator\">=</span> r<span class=\"token punctuation\">[</span><span class=\"token function\">$_CAGEe</span><span class=\"token punctuation\">(</span><span class=\"token number\">750</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>                  <span class=\"token punctuation\">,</span> l <span class=\"token operator\">=</span> <span class=\"token constant\">V</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_CAGEe</span><span class=\"token punctuation\">(</span><span class=\"token number\">342</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>gt<span class=\"token punctuation\">[</span><span class=\"token function\">$_CAGEe</span><span class=\"token punctuation\">(</span><span class=\"token number\">209</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">[</span><span class=\"token function\">$_CAGEe</span><span class=\"token punctuation\">(</span><span class=\"token number\">742</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                  <span class=\"token punctuation\">,</span> h <span class=\"token operator\">=</span> m<span class=\"token punctuation\">[</span><span class=\"token function\">$_CAGEe</span><span class=\"token punctuation\">(</span><span class=\"token number\">733</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                  <span class=\"token punctuation\">,</span> f <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                    <span class=\"token string\">\"\\u0067\\u0074\"</span><span class=\"token operator\">:</span> i<span class=\"token punctuation\">[</span><span class=\"token function\">$_CAGEe</span><span class=\"token punctuation\">(</span><span class=\"token number\">147</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                    <span class=\"token string\">\"\\u0063\\u0068\\u0061\\u006c\\u006c\\u0065\\u006e\\u0067\\u0065\"</span><span class=\"token operator\">:</span> i<span class=\"token punctuation\">[</span><span class=\"token function\">$_CAGDp</span><span class=\"token punctuation\">(</span><span class=\"token number\">154</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                    <span class=\"token string\">\"\\u006c\\u0061\\u006e\\u0067\"</span><span class=\"token operator\">:</span> o<span class=\"token punctuation\">[</span><span class=\"token function\">$_CAGDp</span><span class=\"token punctuation\">(</span><span class=\"token number\">119</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                    <span class=\"token string\">\"\\u0024\\u005f\\u0042\\u0042\\u0046\"</span><span class=\"token operator\">:</span> r<span class=\"token punctuation\">[</span><span class=\"token function\">$_CAGEe</span><span class=\"token punctuation\">(</span><span class=\"token number\">623</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                    <span class=\"token string\">\"\\u0063\\u006c\\u0069\\u0065\\u006e\\u0074\\u005f\\u0074\\u0079\\u0070\\u0065\"</span><span class=\"token operator\">:</span> r<span class=\"token punctuation\">[</span><span class=\"token function\">$_CAGEe</span><span class=\"token punctuation\">(</span><span class=\"token number\">648</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                    <span class=\"token string\">\"\\u0077\"</span><span class=\"token operator\">:</span> h <span class=\"token operator\">+</span> u</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>&quot;\\u0077&quot;：为所需的 w 值。</p>\n<p>下面就需要去寻找其生成逻辑，可以直观的看到，其是由 h,u 拼接而成的。</p>\n<p>接下来就需要分析 u、l、h 的逻辑即可。</p>\n<blockquote>\n<p>首先明确一个观点，这里一定有一个值为定值，因为滑块拖动的轨迹是一定的</p>\n</blockquote>\n<h5 id=\"u值\"><a class=\"anchor\" href=\"#u值\">#</a> u 值</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>u <span class=\"token operator\">=</span> r<span class=\"token punctuation\">[</span><span class=\"token function\">$_CAGEe</span><span class=\"token punctuation\">(</span><span class=\"token number\">750</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>u 运行了一个函数，未传参数进去、直接自执行。经过测试，发现其不为定值。</p>\n<p>内部逻辑：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>                <span class=\"token keyword\">var</span> $_CBEDU <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span>$_CX</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                  <span class=\"token punctuation\">,</span> $_CBECg <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'$_CBEGr'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>$_CBEDU<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                  <span class=\"token punctuation\">,</span> $_CBEEc <span class=\"token operator\">=</span> $_CBECg<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                $_CBECg<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                <span class=\"token keyword\">var</span> $_CBEFV <span class=\"token operator\">=</span> $_CBECg<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>     <span class=\"token comment\">// 前面属于初始化的步骤</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token keyword\">var</span> e <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">X</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_CBEEc</span><span class=\"token punctuation\">(</span><span class=\"token number\">342</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_CBEEc</span><span class=\"token punctuation\">(</span><span class=\"token number\">742</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>e <span class=\"token operator\">||</span> <span class=\"token number\">256</span> <span class=\"token operator\">!==</span> e<span class=\"token punctuation\">[</span><span class=\"token function\">$_CBEEc</span><span class=\"token punctuation\">(</span><span class=\"token number\">182</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                    e <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">X</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_CBEDU</span><span class=\"token punctuation\">(</span><span class=\"token number\">342</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_CBEDU</span><span class=\"token punctuation\">(</span><span class=\"token number\">742</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token keyword\">return</span> e<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">$_CBEEc</span><span class=\"token punctuation\">(</span><span class=\"token number\">342</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token string\">'encrypt'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_CBEEc</span><span class=\"token punctuation\">(</span><span class=\"token number\">742</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Ot <span class=\"token operator\">=</span> <span class=\"token function\">rt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                <span class=\"token keyword\">var</span> $_CBDIs <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span>$_CX</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                  <span class=\"token punctuation\">,</span> $_CBDHp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'$_CBEBa'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>$_CBDIs<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                  <span class=\"token punctuation\">,</span> $_CBDJA <span class=\"token operator\">=</span> $_CBDHp<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                $_CBDHp<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                <span class=\"token keyword\">var</span> $_CBEAd <span class=\"token operator\">=</span> $_CBDHp<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token operator\">!</span><span class=\"token number\">0</span> <span class=\"token operator\">===</span> t <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>Ot <span class=\"token operator\">=</span> <span class=\"token function\">rt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                Ot<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">rt</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    \t\t<span class=\"token comment\">// 初始化操作</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token keyword\">var</span> $_BFBDL <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span>$_CX</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>              <span class=\"token punctuation\">,</span> $_BFBCi <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'$_BFBGO'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>$_BFBDL<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>              <span class=\"token punctuation\">,</span> $_BFBEt <span class=\"token operator\">=</span> $_BFBCi<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            $_BFBCi<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token keyword\">var</span> $_BFBFk <span class=\"token operator\">=</span> $_BFBCi<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token keyword\">function</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                <span class=\"token keyword\">var</span> $_DBFAh <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span><span class=\"token function\">$_DP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> $_DBFAh <span class=\"token operator\">!==</span> lTloj<span class=\"token punctuation\">.</span><span class=\"token function\">$_DP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>$_DBFAh<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                    <span class=\"token keyword\">case</span> lTloj<span class=\"token punctuation\">.</span><span class=\"token function\">$_DP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token number\">65536</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">[</span><span class=\"token function\">$_BFBDL</span><span class=\"token punctuation\">(</span><span class=\"token number\">75</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_BFBDL</span><span class=\"token punctuation\">(</span><span class=\"token number\">396</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_BFBDL</span><span class=\"token punctuation\">(</span><span class=\"token number\">476</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                </pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                <span class=\"token keyword\">var</span> $_BFBIl <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span>$_CX</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                  <span class=\"token punctuation\">,</span> $_BFBHs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'$_BFCBY'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>$_BFBIl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                  <span class=\"token punctuation\">,</span> $_BFBJq <span class=\"token operator\">=</span> $_BFBHs<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                $_BFBHs<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>                <span class=\"token keyword\">var</span> $_BFCAQ <span class=\"token operator\">=</span> $_BFBHs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                </pre></td></tr><tr><td data-num=\"54\"></td><td><pre>                </pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>            <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>t <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">65536</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">[</span><span class=\"token string\">'random'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'toString'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'substring'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>首先运行了 rt 函数，接着看 rt 函数内部，内部包含两次初始化操作，貌似没啥用。我们可以看到其中真实的返回值为 4 个 t () 函数运行之和，那么接着我们只需要分析 t 函数即可，</p>\n<p>本质上 t 其实是先通过 random 了一个随机数，然后位运算，在经过 toString、substring 将其转化为一个 4 位字符、接着 4 次拼接，就生成了 16 位随机字符。</p>\n<p>接下来，就就可以还原成如下形式：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">decode_u</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token number\">65536</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">[</span><span class=\"token string\">'random'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'toString'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'substring'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">var</span> u_decode <span class=\"token operator\">=</span> <span class=\"token function\">decode_u</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">decode_u</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">decode_u</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">decode_u</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>接下来再看 e 的整体部分</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//$_CBEEc(342) = 'encrypt';</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">var</span> e <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">X</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_CBEEc</span><span class=\"token punctuation\">(</span><span class=\"token number\">342</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_CBEEc</span><span class=\"token punctuation\">(</span><span class=\"token number\">742</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>e <span class=\"token operator\">||</span> <span class=\"token number\">256</span> <span class=\"token operator\">!==</span> e<span class=\"token punctuation\">[</span><span class=\"token function\">$_CBEEc</span><span class=\"token punctuation\">(</span><span class=\"token number\">182</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                    e <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">X</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_CBEDU</span><span class=\"token punctuation\">(</span><span class=\"token number\">342</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_CBEDU</span><span class=\"token punctuation\">(</span><span class=\"token number\">742</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token keyword\">return</span> e<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// 还原 e</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">var</span> e <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">X</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'encrypt'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>u_decode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>while 那部分 e 貌似经过调试也不经过那里，因此可以不用管，将 e 简单的还原，明显，我们只需要知道这个 X () 是啥不就行了吗，从字面意思上来看，就是对随机的 u_decode 的一个加密操作，跟进去：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">E</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>                <span class=\"token keyword\">var</span> $_DBDBL <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span><span class=\"token function\">$_DP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> $_DBDBL <span class=\"token operator\">!==</span> lTloj<span class=\"token punctuation\">.</span><span class=\"token function\">$_DP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>$_DBDBL<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                    <span class=\"token keyword\">case</span> lTloj<span class=\"token punctuation\">.</span><span class=\"token function\">$_DP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHJn</span><span class=\"token punctuation\">(</span><span class=\"token number\">310</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHJn</span><span class=\"token punctuation\">(</span><span class=\"token number\">319</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHIO</span><span class=\"token punctuation\">(</span><span class=\"token number\">392</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHIO</span><span class=\"token punctuation\">(</span><span class=\"token number\">365</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHJn</span><span class=\"token punctuation\">(</span><span class=\"token number\">352</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHJn</span><span class=\"token punctuation\">(</span><span class=\"token number\">358</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHIO</span><span class=\"token punctuation\">(</span><span class=\"token number\">395</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHIO</span><span class=\"token punctuation\">(</span><span class=\"token number\">329</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                        <span class=\"token comment\">//$_HHIO(349) = 'setpublic'</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHIO</span><span class=\"token punctuation\">(</span><span class=\"token number\">349</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token function\">$_HHJn</span><span class=\"token punctuation\">(</span><span class=\"token number\">370</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">$_HHIO</span><span class=\"token punctuation\">(</span><span class=\"token number\">354</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                        $_DBDBL <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span><span class=\"token function\">$_DP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">// E['prototype']['setpublic']</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token constant\">E</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHJn</span><span class=\"token punctuation\">(</span><span class=\"token number\">261</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHIO</span><span class=\"token punctuation\">(</span><span class=\"token number\">349</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">ut</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t<span class=\"token punctuation\">,</span> e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                <span class=\"token keyword\">var</span> $_JIId <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span>$_CX</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                  <span class=\"token punctuation\">,</span> $_JIHf <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'$_JJBk'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>$_JIId<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                  <span class=\"token punctuation\">,</span> $_JIJy <span class=\"token operator\">=</span> $_JIHf<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                $_JIHf<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token keyword\">var</span> $_JJAX <span class=\"token operator\">=</span> $_JIHf<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token keyword\">null</span> <span class=\"token operator\">!=</span> t <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">!=</span> e <span class=\"token operator\">&amp;&amp;</span> <span class=\"token number\">0</span> <span class=\"token operator\">&lt;</span> t<span class=\"token punctuation\">[</span><span class=\"token function\">$_JIJy</span><span class=\"token punctuation\">(</span><span class=\"token number\">182</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token number\">0</span> <span class=\"token operator\">&lt;</span> e<span class=\"token punctuation\">[</span><span class=\"token function\">$_JIId</span><span class=\"token punctuation\">(</span><span class=\"token number\">182</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_JIId</span><span class=\"token punctuation\">(</span><span class=\"token number\">310</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">n</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t<span class=\"token punctuation\">,</span> e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                    <span class=\"token keyword\">var</span> $_JJDX <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span>$_CX</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                      <span class=\"token punctuation\">,</span> $_JJCE <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'$_JJGq'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>$_JJDX<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                      <span class=\"token punctuation\">,</span> $_JJEo <span class=\"token operator\">=</span> $_JJCE<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                    $_JJCE<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                    <span class=\"token keyword\">var</span> $_JJFy <span class=\"token operator\">=</span> $_JJCE<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">y</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_JIJy</span><span class=\"token punctuation\">(</span><span class=\"token number\">319</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> console <span class=\"token operator\">&amp;&amp;</span> console<span class=\"token punctuation\">[</span><span class=\"token function\">$_JIJy</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> console<span class=\"token punctuation\">[</span><span class=\"token function\">$_JIId</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token function\">$_JIId</span><span class=\"token punctuation\">(</span><span class=\"token number\">348</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token comment\">// E['prototype']['encrypt']</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token constant\">E</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHIO</span><span class=\"token punctuation\">(</span><span class=\"token number\">261</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_HHJn</span><span class=\"token punctuation\">(</span><span class=\"token number\">342</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">lt</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>                <span class=\"token keyword\">var</span> $_JJI_ <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span>$_CX</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>                  <span class=\"token punctuation\">,</span> $_JJHt <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'$_BAABI'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>$_JJI_<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                  <span class=\"token punctuation\">,</span> $_JJJB <span class=\"token operator\">=</span> $_JJHt<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                $_JJHt<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                <span class=\"token keyword\">var</span> $_BAAAC <span class=\"token operator\">=</span> $_JJHt<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                <span class=\"token keyword\">var</span> <span class=\"token function-variable function\">e</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t<span class=\"token punctuation\">,</span> e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                    <span class=\"token keyword\">var</span> $_BAADI <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span>$_CX</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                      <span class=\"token punctuation\">,</span> $_BAACi <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'$_BAAGL'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>$_BAADI<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                      <span class=\"token punctuation\">,</span> $_BAAEP <span class=\"token operator\">=</span> $_BAACi<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>                    $_BAACi<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                    <span class=\"token keyword\">var</span> $_BAAFA <span class=\"token operator\">=</span> $_BAACi<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e <span class=\"token operator\">&lt;</span> t<span class=\"token punctuation\">[</span><span class=\"token function\">$_BAAEP</span><span class=\"token punctuation\">(</span><span class=\"token number\">182</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                        <span class=\"token keyword\">return</span> console <span class=\"token operator\">&amp;&amp;</span> console<span class=\"token punctuation\">[</span><span class=\"token function\">$_BAADI</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> console<span class=\"token punctuation\">[</span><span class=\"token function\">$_BAADI</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token function\">$_BAADI</span><span class=\"token punctuation\">(</span><span class=\"token number\">312</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                        <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>                    <span class=\"token keyword\">var</span> n <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>                      <span class=\"token punctuation\">,</span> r <span class=\"token operator\">=</span> t<span class=\"token punctuation\">[</span><span class=\"token function\">$_BAADI</span><span class=\"token punctuation\">(</span><span class=\"token number\">182</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>                    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token operator\">&lt;=</span> r <span class=\"token operator\">&amp;&amp;</span> <span class=\"token number\">0</span> <span class=\"token operator\">&lt;</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>                        <span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> t<span class=\"token punctuation\">[</span><span class=\"token function\">$_BAADI</span><span class=\"token punctuation\">(</span><span class=\"token number\">137</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>                        i <span class=\"token operator\">&lt;</span> <span class=\"token number\">128</span> <span class=\"token operator\">?</span> n<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>e<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> i <span class=\"token operator\">:</span> <span class=\"token number\">127</span> <span class=\"token operator\">&lt;</span> i <span class=\"token operator\">&amp;&amp;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">2048</span> <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>e<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">63</span> <span class=\"token operator\">&amp;</span> i <span class=\"token operator\">|</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                        n<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>e<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> i <span class=\"token operator\">>></span> <span class=\"token number\">6</span> <span class=\"token operator\">|</span> <span class=\"token number\">192</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>e<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">63</span> <span class=\"token operator\">&amp;</span> i <span class=\"token operator\">|</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>                        n<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>e<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> i <span class=\"token operator\">>></span> <span class=\"token number\">6</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span> <span class=\"token operator\">|</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>                        n<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>e<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> i <span class=\"token operator\">>></span> <span class=\"token number\">12</span> <span class=\"token operator\">|</span> <span class=\"token number\">224</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>                    n<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>e<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>                    <span class=\"token keyword\">var</span> o <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">l</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>                      <span class=\"token punctuation\">,</span> s <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>                    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">&lt;</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>                        s<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token operator\">==</span> s<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                            o<span class=\"token punctuation\">[</span><span class=\"token function\">$_BAADI</span><span class=\"token punctuation\">(</span><span class=\"token number\">276</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>                        n<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>e<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> s<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>                    <span class=\"token keyword\">return</span> n<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>e<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>                    n<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>e<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>                    <span class=\"token keyword\">new</span> <span class=\"token class-name\">y</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_JJJB</span><span class=\"token punctuation\">(</span><span class=\"token number\">310</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_JJI_</span><span class=\"token punctuation\">(</span><span class=\"token number\">353</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">7</span> <span class=\"token operator\">>></span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span> <span class=\"token operator\">==</span> e<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>                    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>                <span class=\"token keyword\">var</span> n <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token function\">$_JJJB</span><span class=\"token punctuation\">(</span><span class=\"token number\">388</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span> <span class=\"token operator\">==</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>                    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>                <span class=\"token keyword\">var</span> r <span class=\"token operator\">=</span> n<span class=\"token punctuation\">[</span><span class=\"token function\">$_JJJB</span><span class=\"token punctuation\">(</span><span class=\"token number\">396</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token number\">0</span> <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&amp;</span> r<span class=\"token punctuation\">[</span><span class=\"token function\">$_JJJB</span><span class=\"token punctuation\">(</span><span class=\"token number\">182</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> r <span class=\"token operator\">:</span> <span class=\"token function\">$_JJJB</span><span class=\"token punctuation\">(</span><span class=\"token number\">44</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> r<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>总的来说，对于 u 值的生成有如下几步：</p>\n<ol>\n<li>首先 new 一个 X 对象，其中 X 指向 E ()。</li>\n<li>在 new 的时候，首先获取两个定参数，然后根据两个定参数设置一个 public。</li>\n<li>接着调用原型链上的 encrypt 方法，同时传入了一个 16 位的随机数。</li>\n<li>最后生成 256 位结果。</li>\n</ol>\n<h5 id=\"l值\"><a class=\"anchor\" href=\"#l值\">#</a> l 值</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>l <span class=\"token operator\">=</span> <span class=\"token constant\">V</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"encrypt\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>gt<span class=\"token punctuation\">[</span><span class=\"token string\">\"stringify\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CBFG\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 手动还原</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>r<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CBFG\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// 这个会生成一个值，每次刷新都不一样，伪动态，同时跟进去分析发现，这个值其实返回的就是一个一开始初始化的值，逻辑就是 u 值的 Ot, 可改写为 u_decode。</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">//gt [\"stringify\"](o) 这一部分会返回一个对象，</span></pre></td></tr></table></figure><p>通过对比可以发现 o，传入了一系列参数，这也是导致两次运行结果不一致的主要原因，其中最后生成的 rp 也是一个不一致的参数。</p>\n<p>那么我们主要分析点就是 o 是如何生成的。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>r <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>i <span class=\"token operator\">=</span> r<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CIY\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>o <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>          <span class=\"token string\">\"lang\"</span><span class=\"token operator\">:</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">\"lang\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token string\">\"zh-cn\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>          <span class=\"token string\">\"userresponse\"</span><span class=\"token operator\">:</span> <span class=\"token constant\">H</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">\"challenge\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>          <span class=\"token string\">\"passtime\"</span><span class=\"token operator\">:</span> n<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>          <span class=\"token string\">\"imgload\"</span><span class=\"token operator\">:</span> r<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_BJHF\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>          <span class=\"token string\">\"aa\"</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>          <span class=\"token string\">\"ep\"</span><span class=\"token operator\">:</span> r<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CBD_\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>在这部分中，我们可以看到，使用了 n、e、t 这三个传进来的参数，貌似看起来和鼠标轨迹有关。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token string\">\"$_CGHV\"</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">t<span class=\"token punctuation\">,</span> e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">var</span> n <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            r <span class=\"token operator\">=</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_BAHt\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            i <span class=\"token operator\">=</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_BBGR\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            o <span class=\"token operator\">=</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CIY\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            s <span class=\"token operator\">=</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_HA_\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> $t<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CHHW\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string\">\"pointerup\"</span> <span class=\"token operator\">!=</span> t<span class=\"token punctuation\">[</span><span class=\"token string\">\"type\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>          <span class=\"token function\">v</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            o<span class=\"token punctuation\">[</span><span class=\"token string\">\"link\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">s</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".link\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CBV\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>              <span class=\"token string\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"_blank\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>              <span class=\"token string\">\"href\"</span><span class=\"token operator\">:</span> o<span class=\"token punctuation\">[</span><span class=\"token string\">\"link\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_BGDK\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_GJD\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"lock\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\t<span class=\"token comment\">//u 生成的位置</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CFDP\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>              _ <span class=\"token operator\">=</span> e <span class=\"token operator\">?</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"lastPoint\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">:</span> t<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_BGBX\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> a <span class=\"token operator\">-</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CHJg\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>              c <span class=\"token operator\">=</span> e <span class=\"token operator\">?</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"lastPoint\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"y\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">:</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CIAc\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> t<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_BGCq\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> a<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>          n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CECK\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">$_HP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CHIF\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CIBw\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"$_BBBF\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>Math<span class=\"token punctuation\">[</span><span class=\"token string\">\"round\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> Math<span class=\"token punctuation\">[</span><span class=\"token string\">\"round\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CECK\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          <span class=\"token keyword\">var</span> u <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>              l <span class=\"token operator\">=</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CIBw\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"$_BBCA\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CIBw\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"$_GEy\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CIY\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"c\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CIY\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"s\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>          r<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CBCM\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>u<span class=\"token punctuation\">,</span> l<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CECK\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_CFGp\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"$_EFJ\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          r<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_DAK\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>在这里 n、e、t 分别对应 u、l、n [&quot;$_CECK&quot;]，通过调试可以发现这三个估计分别对应距离、轨迹、时间。</p>\n<h6 id=\"小u\"><a class=\"anchor\" href=\"#小u\">#</a> 小 u:</h6>\n<p>这里的小 u 向上看，由于传进来的 e 为 undefined，所以这里的流程只走向了后面一部分，同时，通过对滑块添加 pointermove 事件发现，这里的 t [&quot;$_BGBX&quot;] 为滑块停止的位置，在经过反复调试后，貌似 a 是个可以写死的东西，最后一项为初始位置，基本上该部分就是计算了一下偏移路径。</p>\n<h6 id=\"小l\"><a class=\"anchor\" href=\"#小l\">#</a> 小 l：</h6>\n<p>根据分析可知，该部分由一个函数传入了三个参数构成，后面两个参数为服务器返回，第一个参数为一个三维数组，第一维为一个 x 轴偏移，第二个为 y 轴偏移，第三个为时间戳偏移。</p>\n<h6 id=\"n_ceck\"><a class=\"anchor\" href=\"#n_ceck\">#</a> n[&quot;$_CECK&quot;]:</h6>\n<p>这项就是个时间戳之差，用结束时间戳减去开始的时间戳。</p>\n<h6 id=\"vencrypt\"><a class=\"anchor\" href=\"#vencrypt\">#</a> V[&quot;encrypt&quot;]</h6>\n<p>这部分可以直接导出。</p>\n<h5 id=\"h值\"><a class=\"anchor\" href=\"#h值\">#</a> h 值</h5>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>h <span class=\"token operator\">=</span> m<span class=\"token punctuation\">[</span><span class=\"token string\">\"$_GFm\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token string\">\"$_GFm\"</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">var</span> e <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"$_GDR\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">return</span> e<span class=\"token punctuation\">[</span><span class=\"token string\">\"res\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> e<span class=\"token punctuation\">[</span><span class=\"token string\">\"end\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr></table></figure><p>这部分也可直接导出。</p>\n<h5 id=\"ast解混淆\"><a class=\"anchor\" href=\"#ast解混淆\">#</a> AST 解混淆</h5>\n<p>观察代码，我们可以发现，存在大量混淆，增加了阅读难度，所以首先使用 AST 解混淆。</p>\n<p>将代码放入在线网站解析，发现分为 6 块。</p>\n<ol>\n<li>ExpressionStatement</li>\n<li>ExpressionStatement</li>\n<li>ExpressionStatement</li>\n<li>ExpressionStatement</li>\n<li>FunctionDeclaration</li>\n<li>ExpressionStatement</li>\n</ol>\n<blockquote>\n<p>其中前四部分可以看作解密函数，第五部分可以看做一个类似声明对象的过程。与之前解的 OB 混淆原理不太一样，这里面采用了大量的重赋值操作。</p>\n</blockquote>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> $_DBIV <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span>$_CX</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">,</span> $_DBHX <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'$_DCBv'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>$_DBIV<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">,</span> $_DBJB <span class=\"token operator\">=</span> $_DBHX<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>$_DBHX<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">var</span> $_DCAU <span class=\"token operator\">=</span> $_DBHX<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>我们可以看到，其显示通过一个变量修饰器，将一个解密函数赋值过来，然后通过数组拼合的方式生成了一个新数组，再通过数组取值的操作，将其中的值取出来，接着对数组首元素进行去除，在取值。</p>\n<p>简单来讲，就是把解密函数赋值过去，数组一开始携带的参数貌似没什么用。</p>\n<h6 id=\"step1-ascii码还原\"><a class=\"anchor\" href=\"#step1-ascii码还原\">#</a> STEP1 ASCII 码还原:</h6>\n<p>ASCII 码还原，增加可读性，没啥好讲的。</p>\n<h6 id=\"step2-解密函数部分还原\"><a class=\"anchor\" href=\"#step2-解密函数部分还原\">#</a> STEP2 解密函数部分还原:</h6>\n<p>由于在后面中，存在变量声明调用解密函数的过程，这里为了方便先直接进行一部分替换。</p>\n<p>通过分析我们可以知道，第三个和第四个解密函数，才为真正的解密函数，因为在后续的代码中，很大一部分都是通过该部分才进行了操作，那么我们只需要遍历 MemberExpression 节点，同时限制其父节点为声明表达式即可将遍历条件限定在前几个，然后通过遍历作用域，将有变量赋值的部分替换。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>a.b = function ()&#123;return val&#125;;</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>var c = a.b;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>转化为</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>a.b = function ()&#123;return val&#125;;</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>var c = function ()&#123;return val&#125;;</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>*/</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">const</span> visitor1 <span class=\"token operator\">=</span>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>     <span class=\"token function\">MemberExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>object<span class=\"token punctuation\">,</span>property<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>scope<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">var</span> func_name <span class=\"token operator\">=</span> object<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>pro_name <span class=\"token operator\">=</span> property<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">// 只遍历声明式的部分，防止反复调用</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isAssignmentExpression</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>func_name <span class=\"token operator\">!==</span> func_all<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token function\">MemberExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> func_name <span class=\"token operator\">&amp;&amp;</span> _path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> property<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                    <span class=\"token comment\">// 对于变量赋值</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isVariableDeclarator</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                        _path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">.</span>right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>这一步主要是为后一步生成数组做铺垫。</p>\n</blockquote>\n<h6 id=\"step3-解密函数内存写入\"><a class=\"anchor\" href=\"#step3-解密函数内存写入\">#</a> STEP3 解密函数内存写入:</h6>\n<p>紧接着我们将前 5 部分全部压入内存中，这样的好处就是后面在有调用的部分处，可以直接通过 eval 结合解密函数运行出值，直接用于替换。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 解密函数对象昵称</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">let</span> descrypt_strfun_js <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;=</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// 加入代码</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    descrypt_strfun_js <span class=\"token operator\">+=</span> <span class=\"token function\">generator</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">.</span>program<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>compact<span class=\"token operator\">:</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>code</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">delete</span> ast_code<span class=\"token punctuation\">.</span>program<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">// 运行数组</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>descrypt_strfun_js<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h6 id=\"step4-赋值表达式替换\"><a class=\"anchor\" href=\"#step4-赋值表达式替换\">#</a> STEP4 赋值表达式替换:</h6>\n<p>由于后续的针对数组变化的插件需要能将数组写入内存中，而 concat 部分又包含了数组的调用，所以我们要将该部分还原成其原型。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>var b = function ()&#123;return arguments&#125;;</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>var a = ['as'].concat (b)</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>还原后</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>var a = ['as'].concat (function ()&#123;return arguments&#125;)</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>*/</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">const</span> var_visitor  <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\">// 查找赋值表达式</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span> init<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">var</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        references <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isFunctionExpression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> init<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>reference <span class=\"token keyword\">of</span> references<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'concat'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                reference<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h6 id=\"step-5-数组还原-临时变量还原\"><a class=\"anchor\" href=\"#step-5-数组还原-临时变量还原\">#</a> STEP 5 数组还原 + 临时变量还原：</h6>\n<p>该部分就是对先前提到的数组进行的还原，临时变量其实指代的也是解密函数。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 变量替换</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">const</span> arr_change_visitor <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">// 数组替换</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span> init<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">var</span> func_name <span class=\"token operator\">=</span> id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">var</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">var</span> referpaths <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\">// 如果变量没引用，则返回</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>referpaths<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">// 保证变量的 init 部分值唯一，数字、字符类型直接替换，函数定义也可直接替换，前提是引用部分为单引用，若为函数调用，可考虑直接计算值。</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// 单独针对这种情况，不考虑单纯的数组。</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isCallExpression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> types<span class=\"token punctuation\">.</span><span class=\"token function\">isArrayExpression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token comment\">// 将数组中的内容直接写入内存</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> <span class=\"token string\">'concat'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">var</span> old_arr <span class=\"token operator\">=</span> init<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            global<span class=\"token punctuation\">[</span>func_name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> old_arr<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token comment\">// 遍历作用域，获取修改值的地址</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token function\">MemberExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                    <span class=\"token comment\">// 后面可能还要确保只修改一次的情况</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                    <span class=\"token comment\">// console.log(_path.toString());</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> func_name<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                        <span class=\"token keyword\">let</span> index_value <span class=\"token operator\">=</span> _path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                        _path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>global<span class=\"token punctuation\">[</span>func_name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>index_value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                    <span class=\"token comment\">// 若包含 shift 操作</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property <span class=\"token operator\">&amp;&amp;</span> _path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'shift'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                        global<span class=\"token punctuation\">[</span>func_name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token comment\">// 这部分主要是通过将还原后的部分写入内存，在遍历，接着对包含 shift () 的代码删除，由于该部分的解密体为函数，所以遍历的是 CallExpression 节点。</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token keyword\">const</span> var_write <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span>init<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token keyword\">var</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        references <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isFunctionExpression</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> init<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token function\">CallExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                 _path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token comment\">// 遍历替换结束，删除原节点</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token function\">MemberExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>object<span class=\"token punctuation\">,</span>property<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>property<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> <span class=\"token string\">'shift'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        path<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h6 id=\"step-6-解密函数批量还原\"><a class=\"anchor\" href=\"#step-6-解密函数批量还原\">#</a> STEP 6 解密函数批量还原</h6>\n<p>到了这一步，将解密函数全部运行替换即可。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> visitor_sec <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// 遍历 call 节点，将内存中的函数直接计算</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">CallExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>callee<span class=\"token punctuation\">,</span>arguments<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">// 如果于内存中存在</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>callee<span class=\"token punctuation\">.</span>object <span class=\"token operator\">&amp;&amp;</span> global<span class=\"token punctuation\">[</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> global<span class=\"token punctuation\">[</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>arguments<span class=\"token punctuation\">.</span>length<span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>arguments<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token comment\">// 由于该处的数组是个无限递归，推测该部分应该只是一个用于比较的逻辑，即判断数组下标即可。</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isMemberExpression</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isMemberExpression</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                    <span class=\"token comment\">// var args1 = path.parent.property.value,args2 = path.parentPath.parent.prototype.value;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                    <span class=\"token comment\">//console.log(path.parentPath.parentPath.toString());</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                    <span class=\"token comment\">//path.replaceInline(types.valueToNode(eval(path.parentPath.parentPath.toString())))</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h6 id=\"step-7-控制流平坦化\"><a class=\"anchor\" href=\"#step-7-控制流平坦化\">#</a> STEP 7 控制流平坦化：</h6>\n<p>通过上述步骤，已经将代码还原到了一个可以阅读的程度了，但是在整体的代码中还包含着一个及其特殊的部分。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">$_BFf</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>      <span class=\"token keyword\">var</span> $_DAIEJ <span class=\"token operator\">=</span> lTloj<span class=\"token punctuation\">.</span><span class=\"token function\">$_DP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> $_DAIEJ <span class=\"token operator\">!==</span> lTloj<span class=\"token punctuation\">.</span><span class=\"token function\">$_DP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>$_DAIEJ<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>          <span class=\"token keyword\">case</span> lTloj<span class=\"token punctuation\">.</span><span class=\"token function\">$_DP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>              <span class=\"token string\">\".popup_ghost\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>              <span class=\"token string\">\".popup_box\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token string\">\".popup_header\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                  <span class=\"token string\">\"span.popup_tip\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                  <span class=\"token string\">\"span.popup_close\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token string\">\".popup_wrap\"</span><span class=\"token operator\">:</span> t</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>              <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>由于 lTloj.$_DP () 这个解密函数解出来是一个无限套娃的玩意，同时，我们可以看到，其在代码流程中好像除了做判断，就没啥用了，也就是说，对于上述函数的流程中，我们只需要关注 case 中的那一部分即可，因为 for 循环貌似给整体加上了个无限循环，但是有 return 的话，就直接跳出去了。</p>\n<blockquote>\n<p>其实还原到这一步了，代码的可读性已经很大程度提高了，其检测了什么环境已经一目了然，接下来就是去补环境了。</p>\n</blockquote>\n<h5 id=\"canvas\"><a class=\"anchor\" href=\"#canvas\">#</a> canvas</h5>\n<p>canvas 为画布，在过验证码的过程中，我们发现服务器没返回图片，而是返回了两张 webp 格式的散乱图，也就是说，在代码中一定存在操作，使得返回的散乱图拼合成一个完整的图片，那么我们首先要做的就是找到其生成参数的位置。</p>\n<blockquote>\n<p>在该例中图片的格式为 312*160</p>\n</blockquote>\n<h6 id=\"step1-观察图片生成原理\"><a class=\"anchor\" href=\"#step1-观察图片生成原理\">#</a> STEP1 观察图片生成原理:</h6>\n<p>在事件断点中打上 canvas 断点，调试，发现该位置貌似是生成参数的位置，观察 l 发现，其 width = 10、height = 80，我们将其 webp 格式的图片打开可以发现，其是将图片划分为了两层，也就是说，这里的操作实际上是对一个 52 块的图片进行一个拼合，而且这里也只循环了 52 次，接下来只需要搞清楚里面在干什么就能对整体进行还原了。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> r <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> _ <span class=\"token operator\">&lt;</span> <span class=\"token number\">52</span><span class=\"token punctuation\">;</span> _ <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>       \t\t\t\t\t<span class=\"token comment\">// 这里应该是确定图片位置</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                        <span class=\"token keyword\">var</span> c <span class=\"token operator\">=</span> Ut<span class=\"token punctuation\">[</span>_<span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">26</span> <span class=\"token operator\">*</span> <span class=\"token number\">12</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                          <span class=\"token punctuation\">,</span> u <span class=\"token operator\">=</span> <span class=\"token number\">25</span> <span class=\"token operator\">&lt;</span> Ut<span class=\"token punctuation\">[</span>_<span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> a <span class=\"token operator\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                          <span class=\"token punctuation\">,</span> l <span class=\"token operator\">=</span> o<span class=\"token punctuation\">[</span><span class=\"token function\">$_CJET</span><span class=\"token punctuation\">(</span><span class=\"token number\">69</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> u<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>       \t\t\t\t\t<span class=\"token comment\">// 这里是拼图的过程</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                        s<span class=\"token punctuation\">[</span><span class=\"token function\">$_CJET</span><span class=\"token punctuation\">(</span><span class=\"token number\">66</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">%</span> <span class=\"token number\">26</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span> <span class=\"token operator\">&lt;</span> _ <span class=\"token operator\">?</span> a <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>目前思路是，先拼上面的 26 张，在拼下面的 26 张，这里的 l 是将分割的图片一个个展示在画布上，c 是 x 轴坐标，u 是 y 轴坐标，a 为 y 轴高度。</p>\n<p>也就是说我们只需要将图片分割后，一快快的按顺序拼起来即可。</p>\n<blockquote>\n<p>这里每一小块的大小为 12 * 80 然后在展示的时候只展示了 10 * 80 的大小，最后拼成一张 260 * 160 的图片，其中展示的顺序与传入的那个数组一样，数组中的值为其对应的位置，左上角为 0，然后 26 代表从左下角开始。</p>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">//</span>a 为传入的大数组</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>new_img <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span><span class=\"token string\">'RGB'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">260</span><span class=\"token punctuation\">,</span> <span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span> idx <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">#获取当前位置的真实图的区域</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    x <span class=\"token operator\">=</span> _Ge<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">26</span> <span class=\"token operator\">*</span> <span class=\"token number\">12</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    y <span class=\"token operator\">=</span> h_sep <span class=\"token keyword\">if</span> a<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">25</span> <span class=\"token keyword\">else</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\">#图像裁剪</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    img_cut <span class=\"token operator\">=</span> _img<span class=\"token punctuation\">.</span>crop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> x <span class=\"token operator\">+</span> w_sep<span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> h_sep<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   \tnew_x <span class=\"token operator\">=</span> idx <span class=\"token operator\">%</span> <span class=\"token number\">26</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    new_y <span class=\"token operator\">=</span> h_sep <span class=\"token keyword\">if</span> idx <span class=\"token operator\">></span> <span class=\"token number\">25</span> <span class=\"token keyword\">else</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\">#将真实图回填</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    new_img<span class=\"token punctuation\">.</span>paste<span class=\"token punctuation\">(</span>img_cut<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>new_x<span class=\"token punctuation\">,</span> new_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h6 id=\"step2-缺口识别\"><a class=\"anchor\" href=\"#step2-缺口识别\">#</a> STEP2 缺口识别：</h6>\n<p>原理上是通过检测二值化的边界，与滑块图进行比对 (代码来源网上)。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">show</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token triple-quoted-string string\">'''展示圈出来的位置'''</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    cv2<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span><span class=\"token string\">'Show'</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    cv2<span class=\"token punctuation\">.</span>waitKey<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    cv2<span class=\"token punctuation\">.</span>destroyAllWindows<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">_tran_canny</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token triple-quoted-string string\">\"\"\"消除噪声\"\"\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    image <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>GaussianBlur<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> cv2<span class=\"token punctuation\">.</span>Canny<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">150</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">detect_displacement</span><span class=\"token punctuation\">(</span>img_slider_path<span class=\"token punctuation\">,</span> image_background_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token triple-quoted-string string\">\"\"\"detect displacement</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    \tparams: img_slider_path 滑块图片</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    \tparmas: image_background_path 带缺口的滑块图片</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    \"\"\"</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\"># # 参数 0 是灰度模式</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    image <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>img_slider_path<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    template <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>image_background_path<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token comment\"># 寻找最佳匹配</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    res <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>matchTemplate<span class=\"token punctuation\">(</span>_tran_canny<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> _tran_canny<span class=\"token punctuation\">(</span>template<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>TM_CCOEFF_NORMED<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token comment\"># 最小值，最大值，并得到最小值，最大值的索引</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    min_val<span class=\"token punctuation\">,</span> max_val<span class=\"token punctuation\">,</span> min_loc<span class=\"token punctuation\">,</span> max_loc <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>minMaxLoc<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    top_left <span class=\"token operator\">=</span> max_loc<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 横坐标</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token comment\"># 展示圈出来的区域</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    x<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> max_loc  <span class=\"token comment\"># 获取 x,y 位置坐标</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    w<span class=\"token punctuation\">,</span> h <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 宽高</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    cv2<span class=\"token punctuation\">.</span>rectangle<span class=\"token punctuation\">(</span>template<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">+</span> w<span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    show<span class=\"token punctuation\">(</span>template<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">return</span> top_left</pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>top_left <span class=\"token operator\">=</span> detect_displacement<span class=\"token punctuation\">(</span><span class=\"token string\">\"b.png\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"a.jpg\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h6 id=\"step3-轨迹模拟\"><a class=\"anchor\" href=\"#step3-轨迹模拟\">#</a> STEP3 轨迹模拟：</h6>\n<p>通过随机数，模拟轨迹。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">get_random_arr</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token triple-quoted-string string\">'''</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    :param num: 图片的路径差</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    :return: 三维数组,x轴,y轴,时间戳</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    '''</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    x_arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">50</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    y_arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    time_arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    i <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    temp_x <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    temp_y <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    temp_time <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>num<span class=\"token operator\">-</span>i <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        temp_x <span class=\"token operator\">+=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        temp_y <span class=\"token operator\">+=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        temp_time <span class=\"token operator\">+=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        x_arr<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>temp_x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        y_arr<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>temp_y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        time_arr<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>temp_time<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        i <span class=\"token operator\">+=</span> temp_x</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    result <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>x_arr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>y_arr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>time_arr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x_arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> result</pre></td></tr></table></figure><h4 id=\"初始化页面w值\"><a class=\"anchor\" href=\"#初始化页面w值\">#</a> 初始化页面 w 值</h4>\n<h5 id=\"加密逻辑\"><a class=\"anchor\" href=\"#加密逻辑\">#</a> 加密逻辑</h5>\n<p>咋分析页面的时候，我们发现，整体的流程如下：</p>\n<p>首先访问页面，初始化，生成一个随机数，随机数生成 gt、challage 两个参数，然后通过 fullpage.js 生成 w 值，接着传入 w、gt、challage 获取一串 json (包含初始化以及返回的验证码图片)，接着拖动滑块在在在 slider.js 中获取轨迹参数 w，最终通过校验。</p>\n<p>页面初始化的逻辑只有 l 值不同，因为它传进去的不是轨迹，而是一系列参数。</p>\n<h5 id=\"参数分析\"><a class=\"anchor\" href=\"#参数分析\">#</a> 参数分析</h5>\n<p>逻辑与上面类似。</p>\n<h4 id=\"补充\"><a class=\"anchor\" href=\"#补充\">#</a> 补充</h4>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2021/12/18/%E8%A1%A5%E7%8E%AF%E5%A2%83/",
            "url": "http://yida506.github.io/2021/12/18/%E8%A1%A5%E7%8E%AF%E5%A2%83/",
            "title": "补环境",
            "date_published": "2021-12-18T11:49:26.000Z",
            "content_html": "<h3 id=\"补环境介绍\"><a class=\"anchor\" href=\"#补环境介绍\">#</a> 补环境介绍</h3>\n<p>对于存在 js 加密的网站，我们往往通过分析网站 js，了解到其加密 js 的逻辑，然后通过本地运行的方式，获取加密后的参数，达到获取 Js 的目的。</p>\n<p>对于加密代码量较少，亦或者是扣取复杂度较低的代码，我们可以通过扣代码，缺什么补什么，进而在本地扣取一个完整的加密算法，最终在本地运行。但是，对于加密量大，同时运行流程错纵复杂的代码，扣取其加密流程的复杂度呈几何倍的增长，因此，我们希望通过直接运行整个 js 代码，进而达到获取其结果的目的。</p>\n<p>试想，为什么我们在浏览器中运行 js 可以直接成功，但是在本地运行就不行了呢？</p>\n<p>首先，本地运行的时候，我们大部分是采用的 node 直接运行的，node 可以看作是浏览器引擎的一个子集，只包含其中的一部分内容，因此，对于加密算法破解，就抽象到找寻函数入口，比较环境差异。</p>\n<p>如何找寻函数入口在此不做赘述，而比较环境差异主要是为了知晓其缺什么浏览器环境，进而我们在本地对其进行补充，以达到本地成功运行 js 的目的。</p>\n<h3 id=\"环境检测\"><a class=\"anchor\" href=\"#环境检测\">#</a> 环境检测</h3>\n<p>之前已经提到，node 可以看作浏览器的子集，那么最直白的环境检测就是调用 node 中没有的对象，进而导致在本地运行抛出错误，但是现实往往不会这么美好，有些环境检测隐含在很深的地方，而且采取的隐式调用的方法，即使不存在该对象运行流程也不会出错。因此，这里将环境检测主要分为两类：</p>\n<ol>\n<li>显式检测</li>\n<li>隐式检测</li>\n</ol>\n<h4 id=\"显式检测\"><a class=\"anchor\" href=\"#显式检测\">#</a> 显式检测</h4>\n<p>** 定义：** 以 A ['B']、A.function (val), 这种方式调用，同时，A、B、function 都可能为检测的对象。</p>\n<p>以下面这段 js 为例:</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">_N</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token string\">'location.href=location.pathname+location.search.replace(/[\\?|&amp;]captcha-challenge/,\\'\\')'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    document<span class=\"token punctuation\">.</span>cookie <span class=\"token operator\">=</span> <span class=\"token string\">'__jsl_clearance=1640094880.604|0|'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">var</span> _t <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_N</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token keyword\">return</span> _N</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_t</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                <span class=\"token keyword\">return</span> _t</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token keyword\">var</span> _N <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                _N<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;a href=\\'/\\'>_1H&lt;/a>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                _N <span class=\"token operator\">=</span> _N<span class=\"token punctuation\">.</span>firstChild<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token keyword\">var</span> _t <span class=\"token operator\">=</span> _N<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">https?:\\/\\/</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                _N <span class=\"token operator\">=</span> _N<span class=\"token punctuation\">.</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span>_t<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_t</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> _1H <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> _1H <span class=\"token operator\">&lt;</span> _t<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> _1H<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                        _t<span class=\"token punctuation\">[</span>_1H<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _N<span class=\"token punctuation\">.</span><span class=\"token function\">charAt</span><span class=\"token punctuation\">(</span>_t<span class=\"token punctuation\">[</span>_1H<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    <span class=\"token keyword\">return</span> _t<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_N</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> _t <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> _t <span class=\"token operator\">&lt;</span> _N<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> _t<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                    _N<span class=\"token punctuation\">[</span>_t<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>_N<span class=\"token punctuation\">[</span>_t<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token number\">36</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                <span class=\"token keyword\">return</span> _N<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            _N <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'clD'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'fq'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token operator\">~</span><span class=\"token operator\">!</span><span class=\"token operator\">/</span><span class=\"token operator\">!</span><span class=\"token operator\">/</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'LBWywKW'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">-</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'%2FZyf'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'6'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'_b938d514e58d7772015c7ad84677513a'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token operator\">-</span><span class=\"token operator\">~</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'D'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> _1H <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> _1H <span class=\"token operator\">&lt;</span> _N<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> _1H<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            _N<span class=\"token punctuation\">[</span>_1H<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _t<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>_1H<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_N<span class=\"token punctuation\">[</span>_1H<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">return</span> _N<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">';Expires=Tue, 12-Dec-30 09:50:26 GMT;Path=/;'</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>window<span class=\"token punctuation\">.</span>addEventListener<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    document<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'DOMContentLoaded'</span><span class=\"token punctuation\">,</span> _N<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    document<span class=\"token punctuation\">.</span><span class=\"token function\">attachEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">'onreadystatechange'</span><span class=\"token punctuation\">,</span> _N<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>在上述代码中，我们可以看到形如 document、window 这些对象，在 node 中是不包含这种对象的，因此我们需要构造一个和浏览器一样的对象出来。</p>\n<p>很明显，这里的 Window 指代全局对象，document 指代的是网页源码，DOM 对象在 node 中无法完全模拟，因此我们换一种思路，只需要补到其不报错不就行了嘛？</p>\n<h5 id=\"step1-整体代码分析\"><a class=\"anchor\" href=\"#step1-整体代码分析\">#</a> STEP1 整体代码分析:</h5>\n<p>先看第一个位置，setTimeout 创建了一个定时器，我们在这里直接置空即可。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function-variable function\">setTimeout</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>由于在 node 中的全局为 global, 那么我们需要对其进行一个赋值操作，把 window 构建出来。</p>\n<p>同时由于后面还调用了 document, 我们先创建一个空对象。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>window <span class=\"token operator\">=</span> global<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>document <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"step2-环境搭建\"><a class=\"anchor\" href=\"#step2-环境搭建\">#</a> STEP2 环境搭建:</h5>\n<p>对于 document.createElement ('div')，createElement ('div') 明显是一个方法，在网页端返回了一个 dom 对象，同时我们发现其后续创建了 innerHTML 属性，然后通过 firstChild.href 重新赋值。这样一来，我们在网页中运行_N.firstChild.href, 发现，打印的结果为'<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucHl0aG9uLXNwaWRlci5jb20v\">https://www.python-spider.com/</span>', 后续还跟上了对其的操作。也就是说，我们只需要把 href 补出来，同时让 innerHTML 属性存在即可。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> _N <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>_N<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;a href=\\'/\\'>_1H&lt;/a>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>_N <span class=\"token operator\">=</span> _N<span class=\"token punctuation\">.</span>firstChild<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">var</span> _t <span class=\"token operator\">=</span> _N<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">https?:\\/\\/</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>document<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createElement</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        innerHTML<span class=\"token operator\">:</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        firstChild<span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            href<span class=\"token operator\">:</span><span class=\"token string\">'https://www.python-spider.com/'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>在末尾我们还看到了形如 addEventListener 的这种调用，对于这种方法，我们不知道其返回了什么，那么我们就需要去 https://developer.mozilla.org/zh-CN/docs/Web/JavaScript 官方文档里查找。</p>\n<p>最后补出来如下：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">addEventListener</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>document<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">addEventListener</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">,</span>c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> <span class=\"token function\">b</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>document<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">attachEvent</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span>b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"隐式检测\"><a class=\"anchor\" href=\"#隐式检测\">#</a> 隐式检测</h4>\n<p>以显示检测的补环境来看，在代码结构清晰的情况下，我们可以很轻易的找到补环境入口，但是假使代码流程复杂，同时调用方法不是以上述形式调用，那么单纯的看代码几乎找不到补环境入口。</p>\n<p>先看如下例子：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//type1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>window<span class=\"token punctuation\">[</span><span class=\"token string\">'hr'</span><span class=\"token operator\">+</span><span class=\"token string\">'ef'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">//type2</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token constant\">S</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>window<span class=\"token punctuation\">,</span><span class=\"token string\">'hr'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ef'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">var</span> <span class=\"token constant\">A</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token constant\">S</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token constant\">S</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>第一种为稍微明显的调用，但是假如被 ASCII 码混淆了呢，假如被 Ob 混淆了呢，当然，针对这种情况，我们可以直接放到 node 中运行，让其报错后在比对即可。但是，假如我们这里采用第二种方法检测环境，这样，即使在 node 中运行也不会报错，返回的是 undefined，那么这样在运行的流程中就发生了变化，进而导致最终的结果与我们想要的所差甚远。</p>\n<p>我们想要知道到底缺少什么环境，可以通过插桩 (logpoint) 的方式去寻找。</p>\n<h4 id=\"奇yin巧计\"><a class=\"anchor\" href=\"#奇yin巧计\">#</a> 奇 yin 巧计</h4>\n<p>补环境可以通过半置空函数，判断其操作。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function-variable function\">nullfunction</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>代理环境 proxy.</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>test <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Proxy</span><span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'获取了'</span><span class=\"token operator\">+</span>key<span class=\"token operator\">+</span><span class=\"token string\">'属性'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">return</span> target<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>本质上是通过截取 window.a，这种操作，把 a 打印到控制台，然后判断到底做了什么。</p>\n",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2021/11/28/ast/",
            "url": "http://yida506.github.io/2021/11/28/ast/",
            "title": "AST语法树",
            "date_published": "2021-11-28T13:38:27.000Z",
            "content_html": "<h3 id=\"ast语法树介绍\"><a class=\"anchor\" href=\"#ast语法树介绍\">#</a> AST 语法树介绍</h3>\n<p>AST 全称 Abstract Syntax Tree, 中文名称为抽象语法树，主要原理就是把代码通过词法分析和句法分析转化为一颗树的形式，对于树来讲又包含很多节点，其中包含了变量的位置，类别，值等一些参数。</p>\n<p>例如：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>对应的 AST 解析结果为 (采用 Babel 解析，结果只取 body.declarations 中的内容):</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Node <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  type<span class=\"token operator\">:</span> 'VariableDeclarator'<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  start<span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  end<span class=\"token operator\">:</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  loc<span class=\"token operator\">:</span> SourceLocation <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    start<span class=\"token operator\">:</span> Position <span class=\"token punctuation\">&#123;</span> line<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> column<span class=\"token operator\">:</span> <span class=\"token number\">4</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    end<span class=\"token operator\">:</span> Position <span class=\"token punctuation\">&#123;</span> line<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> column<span class=\"token operator\">:</span> <span class=\"token number\">9</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    filename<span class=\"token operator\">:</span> undefined<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    identifierName<span class=\"token operator\">:</span> undefined</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  id<span class=\"token operator\">:</span> Node <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    type<span class=\"token operator\">:</span> 'Identifier'<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    start<span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    end<span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    loc<span class=\"token operator\">:</span> SourceLocation <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      start<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>Position<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      end<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>Position<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      filename<span class=\"token operator\">:</span> undefined<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      identifierName<span class=\"token operator\">:</span> 'a'</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    name<span class=\"token operator\">:</span> 'a'</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  init<span class=\"token operator\">:</span> Node <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    type<span class=\"token operator\">:</span> 'NumericLiteral'<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    start<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    end<span class=\"token operator\">:</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    loc<span class=\"token operator\">:</span> SourceLocation <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      start<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>Position<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      end<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>Position<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      filename<span class=\"token operator\">:</span> undefined<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      identifierName<span class=\"token operator\">:</span> undefined</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    extra<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> rawValue<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> raw<span class=\"token operator\">:</span> '<span class=\"token number\">3</span>' <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    value<span class=\"token operator\">:</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>上述将代码解析为了三块，第一块的 type 为 'VariableDeclarator'，对应 var, 第二块为 Identifier 为对应的变量 a, 第三块为 NumericLiteral，为对应的数字 3。</p>\n<p>这样就把 js 代码解析成了树的结构，然后就可以根据遍历的方式，提取，修改其中的值。</p>\n<h3 id=\"本地运行babel\"><a class=\"anchor\" href=\"#本地运行babel\">#</a> 本地运行 babel</h3>\n<p>运行 babel 首先需要安装 babel 的库。</p>\n<pre><code>npm install @babel/parser\nnpm install @babel/traverse\nnpm install @babel/generator\n</code></pre>\n<p>parser 主要是用于将代码解析成语法树的形式，traverse 主要是用于遍历语法树节点，generator 主要是用于将语法树解析回 js 代码。</p>\n<h4 id=\"parser用法\"><a class=\"anchor\" href=\"#parser用法\">#</a> parser 用法</h4>\n<p>导包：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>parse<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@babel/parser'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>由于我们需要用的是 parser 这个包中的 parse 函数，而 parser 又是一个对象，所以我们采用 {} 的方式只导入 parse 方法。</p>\n<p>然后我们就可以直接的采用以下方式，就可以直接将 js 代码转化为 ast 树。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token string\">'js_code'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"traverse用法\"><a class=\"anchor\" href=\"#traverse用法\">#</a> traverse 用法</h4>\n<p>导包：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> traverse <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@babel/traverse\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这里是取出的 traverse 包中的默认方法.</p>\n<p>traverse 方法需要两个参数，一个是 ast 树的对象，一个是要遍历对象。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> visitor <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">NumericLiteral</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">,</span> visitor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>上述通过将 ast 树中的属性为 NumericLiteral 的节点的值批量替换成了 100。</p>\n<h4 id=\"generator用法\"><a class=\"anchor\" href=\"#generator用法\">#</a> generator 用法</h4>\n<p>导包:</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> generator <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@babel/generator\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>与 traverse 类似，调用的包中的默认方法。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">generator</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>code</pre></td></tr></table></figure><p>这样就把语法树修改回 js 的代码样式，然后再另存即可。</p>\n<h4 id=\"types用法\"><a class=\"anchor\" href=\"#types用法\">#</a> types 用法</h4>\n<p>导包：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> types <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@babel/types\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>types 主要用于判断节点类型。</p>\n<blockquote>\n<p>example: types.isStringLiteral (Node) 判断该节点是不是字符类型.</p>\n</blockquote>\n<h4 id=\"补充\"><a class=\"anchor\" href=\"#补充\">#</a> 补充</h4>\n<p>node 和 path 的区别:</p>\n<p>path 代表的是 traverse 的路径之类的东西，node 是 path 中的一个属性，代表的是具体遍历到的位置，通常我们直接使用 node 就可以对节点进行增删查改的操作。</p>\n<p>scope 解释</p>\n<ul>\n<li>path.scope 可以输出当前作用域</li>\n<li>path.scope.dumps 可以输出当前作用域以及其节点的作用域。</li>\n<li>在 path.scope 中包含多种属性，我们通常关注 binding。</li>\n</ul>\n<p>对于每一个变量的 binding 包括 4 种信息，constant 是否会被修改，refererces 被修改的次数，violations 被重新定义的次数，Kind 表明类型。</p>\n<h3 id=\"ast插件\"><a class=\"anchor\" href=\"#ast插件\">#</a> AST 插件</h3>\n<h4 id=\"常量混淆\"><a class=\"anchor\" href=\"#常量混淆\">#</a> 常量混淆</h4>\n<p>所谓常量混淆主要指的是，将变量的属性用 ASCII 码，16 进制码的方式代替，由于 Js 的特性，在运行时，会自动的将其解析成实际的值，但是在我们看来，会造成分析的不便。</p>\n<p>在 ast 语法树中，类似的 StringLiteral 节点中包含 extra 节点，其中 extra 中包含了 rawvalue,raw 的属性，rawvalue 对应的是其展示的值，与 value 的值相对应，raw 包含的是 ASCII 码、Unicode 编码类似的，输入的值。在该处 extra 节点是无意义的，删掉就可以返回实际的 value.</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">StringLiteral</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>extra<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>extra<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token comment\">// 将其直接置换为未定义，即可删除该节点。</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>extra <span class=\"token operator\">=</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"常量折叠\"><a class=\"anchor\" href=\"#常量折叠\">#</a> 常量折叠</h4>\n<p>对于常量折叠来讲，在解除了常量混淆后，我们希望看到类似的 'par'+'se' 直接变成 'parse' 的形式，这样就需要用到常量折叠的方式。</p>\n<p>常量折叠可以抽象为如下几个步骤：</p>\n<ol>\n<li>筛选操作节点</li>\n<li>声明节点属性</li>\n<li>判断节点类型</li>\n<li>计算</li>\n<li>替换</li>\n</ol>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 对于字符串类型的常量堆叠</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">BinaryExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   \t\t<span class=\"token comment\">// 筛选操作节点</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">let</span> left <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">let</span> right <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>right<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">// 字符串类型判断</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isStringLiteral</span><span class=\"token punctuation\">(</span>left<span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isStringLiteral</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token comment\">// console.log(left.value + right.value);</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token comment\">//path.evaluate () 为节点计算，自动相加里面的 value, 得出三个参数：confident:true 为可相加，deopt: 暂时不清楚，value: 加后的值</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token comment\">// 计算</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>value<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token comment\">// console.log(path.evaluate());</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token comment\">// 替换</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"函数还原\"><a class=\"anchor\" href=\"#函数还原\">#</a> 函数还原</h4>\n<p>所谓函数还原，就是针对只包含 return，且作用域中只包含传入的参数的函数进行替换的操作，达到减少分析量的作用。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span>b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  \t<span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">var</span> c <span class=\"token operator\">=</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>最终目的是将其直接还原成 let c = 3 + 4 + 4 + 5; 的形式。</p>\n<p>将上述代码通过 babel 解析后，发现，上述是由两个部分构成的，</p>\n<p>1.FunctionDeclaration</p>\n<p>2.VariableDeclaration</p>\n<p>由于函数作用域的特性，我们在对函数还原的时候，往往需要遍历函数表达式，函数表达式的关联节点为对应的调用位置（对 scope 中的 binding 调用 referencePaths 方法）, 然后上述对应的指向为 add，接着就需要将其转移到父节点（add (3,4)) 的位置进行还原。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> fast_run <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">FunctionDeclaration</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span>body<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token comment\">// 获取函数作用域集</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">const</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">// 获取作用域关联集 (函数调用集)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">let</span> referpaths <span class=\"token operator\">=</span> binding<span class=\"token punctuation\">.</span>referencePaths<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// console.log(referpaths.toString());</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\">// 单个选中</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 将函数表达式加入内存中</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> referpath <span class=\"token keyword\">of</span> referpaths<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token comment\">// 作用域关联到的对象只有调用对象，不包含具体的调用表达式，所以需要获取其父节点，然后就可已得到调用表达式，接着就是将调用表达式中的内容直接还原</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">let</span> callExpression <span class=\"token operator\">=</span> referpath<span class=\"token punctuation\">.</span>parentPath<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token comment\">// 直接调用函数表达式，获取其值</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>callExpression<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token comment\">// console.log(callExpression.toString()+'->'+value);</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            callExpression<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"控制流平坦化\"><a class=\"anchor\" href=\"#控制流平坦化\">#</a> 控制流平坦化</h4>\n<p>所谓控制流平坦化，就是将类 while|switch、case 的结构平坦化，可以直接的看到运行流程，这里以一个简要的平坦化过程为例。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">[</span>a<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\t\t<span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t\t<span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>上述 AST 解析后，由 3 块构成:</p>\n<ol>\n<li>VariableDeclaration</li>\n<li>VariableDeclaration</li>\n<li>WhileStatement</li>\n</ol>\n<p>在这里，我们需要对 WhileStatement 中的内容进行遍历，由于顺序已经知道，这里直接采用，针对改代码的插件如下：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> switch_visitor <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">WhileStatement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 当前 while 块对应的节点</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">const</span> cur_node <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">//body 中包含两块，一块为 switch 块，另一块为 break 块，根据索引提取 switch 块，</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">var</span> switch_cell <span class=\"token operator\">=</span> cur_node<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">// 获取数组，针对不同情况需要重新定义</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">var</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\">// 获取 case 块</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">var</span> case_list <span class=\"token operator\">=</span> switch_cell<span class=\"token punctuation\">.</span>cases<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">// 建立数组用于保存后续值</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">var</span> temp_arr_switch_case <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">// 数组映射，按给定数组顺序</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        arr<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">targetIndex</span> <span class=\"token operator\">=></span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token comment\">// 获取 case 中的部分，删除 continue 节点，然后将剩余节点添加进数组</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">var</span> targetBody <span class=\"token operator\">=</span> case_list<span class=\"token punctuation\">[</span>targetIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>consequent<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isContinueStatement</span><span class=\"token punctuation\">(</span>targetBody<span class=\"token punctuation\">[</span>targetBody<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    targetBody<span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            temp_arr_switch_case <span class=\"token operator\">=</span> temp_arr_switch_case<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>targetBody<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceWithMultiple</span><span class=\"token punctuation\">(</span>temp_arr_switch_case<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>上述代码中，对于数组部分，是直接采用的已经给定的数组，若要使插件适用性增加，需要优化获取数组，以及对是否包含控制流进行判断。</p>\n<p>还原后的结果如下：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"初探ob混淆\"><a class=\"anchor\" href=\"#初探ob混淆\">#</a> 初探 OB 混淆</h3>\n<p>在此以简单的 Ob 为例。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">hi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello World!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">hi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>在<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cub2JmdXNjYXRvci5pby8=\"> JavaScript Obfuscator Tool</span> 网站经过默认的混淆后结果如下：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> _0x30bb <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'log'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Hello\\x20World!'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x38d89d<span class=\"token punctuation\">,</span> _0x30bbb2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token function-variable function\">_0xae0a32</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x2e4e9d</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">--</span>_0x2e4e9d<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            _0x38d89d<span class=\"token punctuation\">[</span><span class=\"token string\">'push'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x38d89d<span class=\"token punctuation\">[</span><span class=\"token string\">'shift'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token function\">_0xae0a32</span><span class=\"token punctuation\">(</span><span class=\"token operator\">++</span>_0x30bbb2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span>_0x30bb<span class=\"token punctuation\">,</span> <span class=\"token number\">0x153</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">_0xae0a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x38d89d<span class=\"token punctuation\">,</span> _0x30bbb2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    _0x38d89d <span class=\"token operator\">=</span> _0x38d89d <span class=\"token operator\">-</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">var</span> _0xae0a32 <span class=\"token operator\">=</span> _0x30bb<span class=\"token punctuation\">[</span>_0x38d89d<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">return</span> _0xae0a32<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">hi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    console<span class=\"token punctuation\">[</span><span class=\"token function\">_0xae0a</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0x1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0xae0a</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0x0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token function\">hi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>可以看到，一个单纯的 hello world 被混淆成了这样，为后续分析增加了难度。将代码放入 ast 在线解析网址解析，可以发现上述主要被分为了 5 给代码块，按顺序依次为：</p>\n<ol>\n<li>VariableDeclaration</li>\n<li>ExpressionStatement</li>\n<li>FunctionDeclaration</li>\n<li>FunctionDeclaration</li>\n<li>ExpressionStatement</li>\n</ol>\n<p>其中第一个声明了变量，第二个为自执行函数，最后一个为表达式，其余的为函数声明式，接下来就需要在各个部分具体发生了什么。</p>\n<p>在开头加入 debugger; 然后在浏览器中调试，首先直接运行自执行函数 (第一个表达式)，</p>\n<p>我们发现，在第一行直接定义了一个数组，接着是一个自执行函数，传入的参数有两个，第一个为之前的数组，第二个为一个字节码的数字，接着我们发现在里面又定义了一个函数，内含对传入的数组的 push,shift 操作，通过反复调用该函数达到将数组顺序改变的目的。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token string\">'Hello World!'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'log'</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>在进行顺序改变后，数组就变成了上述的形式，紧接着定义了两个函数，最后执行 hi () 函数，在 hi 函数中，我们发现它调用了之前定义的_0xae0 这个函数，传入了一个字符串，接着跟进 _0xae0a 函数中，我们发现它首先是对传入的字符进行了一个运算操作，得到了 1，然后就用得到的数去访问之前声明的数组，然后将该值作为返回值，最后 _0xae0a ('0x1') 就变成了数组中的一个值，最后就运行了这条语句，输出了结果。</p>\n<blockquote>\n<p>总结：上述主要进行了 4 部分</p>\n<p>1. 声明了一个大数组</p>\n<p>2. 对大数组的顺序进行了改变</p>\n<p>3. 定义了一个函数，用于取得大数组中的数</p>\n<p>4. 输出结果</p>\n<p>在 4 中需要调用 3 才能拿到结果，我们通常把 4 成为加密函数，3 称为解密函数。</p>\n</blockquote>\n<figure class=\"highlight flow\"><figcaption data-lang=\"flow\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>startID<span class=\"token operator\">=></span>start<span class=\"token operator\">:</span> 声明大数组</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>operation1<span class=\"token operator\">=></span>operation<span class=\"token operator\">:</span> 数组位置偏移</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>operation2<span class=\"token operator\">=></span>operation<span class=\"token operator\">:</span> 解密函数</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>endID<span class=\"token operator\">=></span>end<span class=\"token operator\">:</span> 函数入口</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>startID<span class=\"token operator\">-</span><span class=\"token operator\">></span>operation1<span class=\"token operator\">-</span><span class=\"token operator\">></span>operation2<span class=\"token operator\">-</span><span class=\"token operator\">></span>endID</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>operation2<span class=\"token operator\">-</span><span class=\"token operator\">></span>endID</pre></td></tr></table></figure><p>在第一个执行函数中，我们发现其传入了两个参数，第一个参数刚好对应的是第二块内容 (也就是第一个函数声明)，第二个参数为一个字节码的数字，可不管。在函数内部，首先声明了两个变量，分别调用第一个函数和第三个函数，调用第一个函数的返回值是一个数组，然后在 while 循环中通过第三个函数不断取数组中的值进行一个计算，接着在进行一个跳出判断，在此之间不断的对数组进行操作 (顺序改变).</p>\n<p>即第一个自执行函数和第一个函数、第三个函数为一个整体，最终会得到改变了执行顺序的数组，同时将数组写入内存中。</p>\n<p>接下来分析最后一个函数和第二个函数体，发现，最后一个函数是直接调用第二个函数体的，而且其函数名与未混淆前的一样为 hi ().</p>\n<p>在 hi 中又重新调用了第三个函数，取出了其中的参数，然后对混淆进行了解除，最终达到了解除混淆的目的。</p>\n<h4 id=\"ast解ob混淆lowlevel\"><a class=\"anchor\" href=\"#ast解ob混淆lowlevel\">#</a> AST 解 OB 混淆 (lowlevel)</h4>\n<p>还是以上述为例，在此我们采用了 lowlevel 的加密，首先还是对 AST 树进行分析。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x4becbb<span class=\"token punctuation\">,</span> _0x142d2c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">var</span> _0x4e95f5 <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    _0x5cece4 <span class=\"token operator\">=</span> <span class=\"token function\">_0x4becbb</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token keyword\">var</span> _0xada9ef <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1be</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0x1</span> <span class=\"token operator\">+</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1bc</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0x2</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1bb</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0x3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1d2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0x4</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1ca</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0x5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0x6</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0x7</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1cb</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0x8</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1d1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0x9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1d3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0xa</span> <span class=\"token operator\">+</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1d4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0xb</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_0xada9ef <span class=\"token operator\">===</span> _0x142d2c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                _0x5cece4<span class=\"token punctuation\">[</span><span class=\"token string\">'push'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x5cece4<span class=\"token punctuation\">[</span><span class=\"token string\">'shift'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>_0x52b941<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            _0x5cece4<span class=\"token punctuation\">[</span><span class=\"token string\">'push'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x5cece4<span class=\"token punctuation\">[</span><span class=\"token string\">'shift'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">(</span>_0x3b5e<span class=\"token punctuation\">,</span> <span class=\"token number\">0x373f7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">_0x3b5e</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">var</span> _0x3cd390 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'1386052gLrmrQ'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'456540taaToI'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2342241LghZeo'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'exception'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'log'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'info'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'45411uGtYTE'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2wZNffB'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'__proto__'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'172005fARfwU'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'warn'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'return\\x20(function()\\x20'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'(((.+)+)+)+$'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'apply'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'console'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'search'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'7ehYmcm'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bind'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'556752jyeSlY'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'&#123;&#125;.constructor(\\x22return\\x20this\\x22)(\\x20)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'trace'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'5zuIaAZ'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'184OzUZAg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'toString'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'prototype'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'constructor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'error'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Hello\\x20World!'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'14805EviJWK'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function-variable function\">_0x3b5e</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">return</span> _0x3cd390<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token function\">_0x3b5e</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">hi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">debugger</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">var</span> _0x12b47a <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token function-variable function\">_0xbdadaf</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">var</span> _0x22d85c <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x403758<span class=\"token punctuation\">,</span> _0x1a9953</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token keyword\">var</span> _0x48963d <span class=\"token operator\">=</span> _0x22d85c <span class=\"token operator\">?</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">var</span> _0x52f5f2 <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">;</span><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_0x1a9953<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">var</span> _0x1c3993 <span class=\"token operator\">=</span> _0x1a9953<span class=\"token punctuation\">[</span><span class=\"token function\">_0x52f5f2</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x403758<span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">return</span> _0x1a9953 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>_0x1c3993<span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>             <span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token keyword\">return</span> _0x22d85c <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            _0x48963d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    _0x5c0371 <span class=\"token operator\">=</span> <span class=\"token function\">_0xbdadaf</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">var</span> _0x36e602 <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">return</span> _0x5c0371<span class=\"token punctuation\">[</span><span class=\"token string\">'toString'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x36e602</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x36e602</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'toString'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x36e602</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1ce</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x5c0371<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x36e602</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x36e602</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token function\">_0x5c0371</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token function-variable function\">_0xa991eb</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token keyword\">var</span> _0x9d0201 <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x35b283<span class=\"token punctuation\">,</span> _0x1e4ff</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token keyword\">var</span> _0x5b9df8 <span class=\"token operator\">=</span> _0x9d0201 <span class=\"token operator\">?</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                <span class=\"token keyword\">var</span> _0x4d958a <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_0x1e4ff<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                    <span class=\"token keyword\">var</span> _0x34974c <span class=\"token operator\">=</span> _0x1e4ff<span class=\"token punctuation\">[</span><span class=\"token function\">_0x4d958a</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x35b283<span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                    <span class=\"token keyword\">return</span> _0x1e4ff <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                    _0x34974c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>             <span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            <span class=\"token keyword\">return</span> _0x9d0201 <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            _0x5b9df8<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    _0x46ef64 <span class=\"token operator\">=</span> <span class=\"token function\">_0xa991eb</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token keyword\">var</span> _0x442076 <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token function-variable function\">_0x15972f</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>            <span class=\"token keyword\">var</span> _0xa6d883 <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            _0x5ee4a3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>                _0x5ee4a3 <span class=\"token operator\">=</span> <span class=\"token function\">Function</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0xa6d883</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">_0xa6d883</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">');'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>_0x37267b<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>                _0x5ee4a3 <span class=\"token operator\">=</span> window<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            <span class=\"token keyword\">return</span> _0x5ee4a3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>        _0x52d182 <span class=\"token operator\">=</span> <span class=\"token function\">_0x15972f</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>        _0xb55846 <span class=\"token operator\">=</span> _0x52d182<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _0x52d182<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        _0x503491 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1b9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1bf</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1ba</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1cf</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1b8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'table'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> _0x2e6262 <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">;</span> _0x2e6262 <span class=\"token operator\">&lt;</span> _0x503491<span class=\"token punctuation\">[</span><span class=\"token string\">'length'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> _0x2e6262<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token keyword\">var</span> _0xade831 <span class=\"token operator\">=</span> _0xa991eb<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1ce</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1cd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0xa991eb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>            _0x202fb0 <span class=\"token operator\">=</span> _0x503491<span class=\"token punctuation\">[</span>_0x2e6262<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>            _0x33f2a4 <span class=\"token operator\">=</span> _0xb55846<span class=\"token punctuation\">[</span>_0x202fb0<span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> _0xade831<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>            _0xade831<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1bd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _0xa991eb<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0xa991eb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>            _0xade831<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1cc</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _0x33f2a4<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1cc</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x33f2a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>            _0xb55846<span class=\"token punctuation\">[</span>_0x202fb0<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _0xade831<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>    <span class=\"token function\">_0x46ef64</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    console<span class=\"token punctuation\">[</span><span class=\"token function\">_0x12b47a</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1b9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x12b47a</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1d0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">_0xcf3d</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x24ba4c<span class=\"token punctuation\">,</span> _0x435eb9</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>    <span class=\"token keyword\">var</span> _0x3efe0d <span class=\"token operator\">=</span> <span class=\"token function\">_0x3b5e</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token function-variable function\">_0xcf3d</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x2feccf<span class=\"token punctuation\">,</span> _0x4d6d2b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>        _0x2feccf <span class=\"token operator\">=</span> _0x2feccf <span class=\"token operator\">-</span> <span class=\"token number\">0x1b8</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>        <span class=\"token keyword\">var</span> _0x33ef9c <span class=\"token operator\">=</span> _0x3efe0d<span class=\"token punctuation\">[</span>_0x2feccf<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>        <span class=\"token keyword\">return</span> _0x33ef9c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    <span class=\"token function\">_0xcf3d</span><span class=\"token punctuation\">(</span>_0x24ba4c<span class=\"token punctuation\">,</span> _0x435eb9<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre><span class=\"token function\">hi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><ol>\n<li>\n<p>ExpressionStatement</p>\n</li>\n<li>\n<p>FunctionDeclaration</p>\n</li>\n<li>\n<p>FunctionDeclaration</p>\n</li>\n<li>\n<p>FunctionDeclaration</p>\n</li>\n<li>\n<p>ExpressionStatement</p>\n</li>\n</ol>\n<p>对比默认级的 ob 我们可以发现，在第一个部分，虽然这里变成了 3 个函数声明式，但是其实在第二个函数声明式中，还是包含了创建数组这一操作，在自执行函数中依旧包含了数组移位的操作。从执行流程来看，上述分别对应，数组移位，声明数组，加密函数，解密函数，调用函数。</p>\n<p>同时，相对之前的 Ob 来看，这里对数字进行了混淆操作，为了增加代码的可读性，我们先试着对其进行一个数字解混淆的操作。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x4becbb<span class=\"token punctuation\">,</span> _0x142d2c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">var</span> _0x4e95f5 <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>      _0x5cece4 <span class=\"token operator\">=</span> <span class=\"token function\">_0x4becbb</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token keyword\">var</span> _0xada9ef <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">446</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">444</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">443</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">466</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">458</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">455</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">6</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">453</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">459</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">465</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">467</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">10</span> <span class=\"token operator\">+</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x4e95f5</span><span class=\"token punctuation\">(</span><span class=\"token number\">468</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">11</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_0xada9ef <span class=\"token operator\">===</span> _0x142d2c<span class=\"token punctuation\">)</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">else</span> _0x5cece4<span class=\"token punctuation\">[</span><span class=\"token string\">\"push\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x5cece4<span class=\"token punctuation\">[</span><span class=\"token string\">\"shift\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>_0x52b941<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      _0x5cece4<span class=\"token punctuation\">[</span><span class=\"token string\">\"push\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x5cece4<span class=\"token punctuation\">[</span><span class=\"token string\">\"shift\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>_0x3b5e<span class=\"token punctuation\">,</span> <span class=\"token number\">226295</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">_0x3b5e</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token keyword\">var</span> _0x3cd390 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"1386052gLrmrQ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"456540taaToI\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2342241LghZeo\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"exception\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"log\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"info\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"45411uGtYTE\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2wZNffB\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"__proto__\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"172005fARfwU\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"warn\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"return (function() \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"(((.+)+)+)+$\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"apply\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"console\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"search\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"7ehYmcm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bind\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"556752jyeSlY\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"&#123;&#125;.constructor(\\\"return this\\\")( )\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"trace\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"5zuIaAZ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"184OzUZAg\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"toString\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"prototype\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"constructor\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Hello World!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"14805EviJWK\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token function-variable function\">_0x3b5e</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">return</span> _0x3cd390<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token function\">_0x3b5e</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">_0xcf3d</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x24ba4c<span class=\"token punctuation\">,</span> _0x435eb9</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token keyword\">var</span> _0x3efe0d <span class=\"token operator\">=</span> <span class=\"token function\">_0x3b5e</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token function-variable function\">_0xcf3d</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x2feccf<span class=\"token punctuation\">,</span> _0x4d6d2b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    _0x2feccf <span class=\"token operator\">=</span> _0x2feccf <span class=\"token operator\">-</span> <span class=\"token number\">440</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">var</span> _0x33ef9c <span class=\"token operator\">=</span> _0x3efe0d<span class=\"token punctuation\">[</span>_0x2feccf<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">return</span> _0x33ef9c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_0xcf3d</span><span class=\"token punctuation\">(</span>_0x24ba4c<span class=\"token punctuation\">,</span> _0x435eb9<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">hi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token keyword\">var</span> _0x12b47a <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token function-variable function\">_0xbdadaf</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">var</span> _0x22d85c <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x403758<span class=\"token punctuation\">,</span> _0x1a9953</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>      <span class=\"token keyword\">var</span> _0x48963d <span class=\"token operator\">=</span> _0x22d85c <span class=\"token operator\">?</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">var</span> _0x52f5f2 <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_0x1a9953<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>          <span class=\"token keyword\">var</span> _0x1c3993 <span class=\"token operator\">=</span> _0x1a9953<span class=\"token punctuation\">[</span><span class=\"token function\">_0x52f5f2</span><span class=\"token punctuation\">(</span><span class=\"token number\">450</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x403758<span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>          <span class=\"token keyword\">return</span> _0x1a9953 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> _0x1c3993<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>      <span class=\"token keyword\">return</span> _0x22d85c <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> _0x48963d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>      _0x5c0371 <span class=\"token operator\">=</span> <span class=\"token function\">_0xbdadaf</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">var</span> _0x36e602 <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token keyword\">return</span> _0x5c0371<span class=\"token punctuation\">[</span><span class=\"token string\">\"toString\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x36e602</span><span class=\"token punctuation\">(</span><span class=\"token number\">452</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x36e602</span><span class=\"token punctuation\">(</span><span class=\"token number\">449</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"toString\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x36e602</span><span class=\"token punctuation\">(</span><span class=\"token number\">462</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x5c0371<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x36e602</span><span class=\"token punctuation\">(</span><span class=\"token number\">452</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x36e602</span><span class=\"token punctuation\">(</span><span class=\"token number\">449</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>  <span class=\"token function\">_0x5c0371</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>  <span class=\"token keyword\">var</span> <span class=\"token function-variable function\">_0xa991eb</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token keyword\">var</span> _0x9d0201 <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_0x35b283<span class=\"token punctuation\">,</span> _0x1e4ff</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>      <span class=\"token keyword\">var</span> _0x5b9df8 <span class=\"token operator\">=</span> _0x9d0201 <span class=\"token operator\">?</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">var</span> _0x4d958a <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">;</span><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_0x1e4ff<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">var</span> _0x34974c <span class=\"token operator\">=</span> _0x1e4ff<span class=\"token punctuation\">[</span><span class=\"token function\">_0x4d958a</span><span class=\"token punctuation\">(</span><span class=\"token number\">450</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x35b283<span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">return</span> _0x1e4ff <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> _0x34974c<span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">return</span> _0x9d0201 <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> _0x5b9df8<span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>      _0x46ef64 <span class=\"token operator\">=</span> <span class=\"token function\">_0xa991eb</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token keyword\">var</span> _0x442076 <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token function-variable function\">_0x15972f</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>      <span class=\"token keyword\">var</span> _0xa6d883 <span class=\"token operator\">=</span> _0xcf3d<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>          _0x5ee4a3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        _0x5ee4a3 <span class=\"token operator\">=</span> <span class=\"token function\">Function</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0xa6d883</span><span class=\"token punctuation\">(</span><span class=\"token number\">448</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">_0xa6d883</span><span class=\"token punctuation\">(</span><span class=\"token number\">456</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\");\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>_0x37267b<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        _0x5ee4a3 <span class=\"token operator\">=</span> window<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>      <span class=\"token keyword\">return</span> _0x5ee4a3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>        _0x52d182 <span class=\"token operator\">=</span> <span class=\"token function\">_0x15972f</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        _0xb55846 <span class=\"token operator\">=</span> _0x52d182<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">451</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _0x52d182<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">451</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>        _0x503491 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">441</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">447</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">463</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">440</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"table\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">457</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> _0x2e6262 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> _0x2e6262 <span class=\"token operator\">&lt;</span> _0x503491<span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> _0x2e6262<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>      <span class=\"token keyword\">var</span> _0xade831 <span class=\"token operator\">=</span> _0xa991eb<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">462</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">461</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">454</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0xa991eb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>          _0x202fb0 <span class=\"token operator\">=</span> _0x503491<span class=\"token punctuation\">[</span>_0x2e6262<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>          _0x33f2a4 <span class=\"token operator\">=</span> _0xb55846<span class=\"token punctuation\">[</span>_0x202fb0<span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> _0xade831<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>      _0xade831<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">445</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _0xa991eb<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">454</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0xa991eb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> _0xade831<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">460</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _0x33f2a4<span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">460</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token function\">_0x442076</span><span class=\"token punctuation\">(</span><span class=\"token number\">454</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>_0x33f2a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> _0xb55846<span class=\"token punctuation\">[</span>_0x202fb0<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _0xade831<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>  <span class=\"token function\">_0x46ef64</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>  console<span class=\"token punctuation\">[</span><span class=\"token function\">_0x12b47a</span><span class=\"token punctuation\">(</span><span class=\"token number\">441</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token function\">_0x12b47a</span><span class=\"token punctuation\">(</span><span class=\"token number\">464</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre></pre></td></tr><tr><td data-num=\"96\"></td><td><pre><span class=\"token function\">hi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这里的数组移位和上述的还是有所不同的，这里是不断对函数里面的数组进行移位操作，所以在解密过程中，还需要从声明数组的函数中取出数组。</p>\n<p>接着我们就需要分析解密函数和加密函数。</p>\n<p>解密函数看到很直白，就是传入参数，将参数值进行一个减法操作，然后取出数组下标为该参数的值。</p>\n<p>接下来就看加密函数，我们很轻易的就能从最后一行中发现，该处应该是最后打印值的地方，那么上述一些步骤到底在做些什么呢？</p>\n<p>我们发现，其实该处只是调用了数组，我们只需要找到数组的声明位置即可。</p>\n<p>通过调试，可以发现，最后一句才是我们要的结果，通过解密函数可以直接打印出结果。</p>\n<p>如果混淆后的代码较短，我们就可以很轻易的分析出实际的逻辑。</p>\n<h4 id=\"实战某比赛第二题\"><a class=\"anchor\" href=\"#实战某比赛第二题\">#</a> 实战 (某比赛第二题)</h4>\n<p>将 js 代码放入 babel 网站解析，发现明显的分为四块：</p>\n<ol>\n<li>VariableDeclaration</li>\n<li>ExpressionStatement</li>\n<li>VariableDeclaration</li>\n<li>ExpressionStatement</li>\n</ol>\n<p>在经过上述分析后，我们可以把 Ob 大至抽象为如下四个阶段：</p>\n<ol>\n<li>定义大数组</li>\n<li>数组移位</li>\n<li>定义解密函数</li>\n<li>函数入口</li>\n</ol>\n<blockquote>\n<p>补充：AST 还原主要是为了让干扰项尽可能减少，让代码逻辑尽可能的变清晰，本身并不能达到秒杀的结果。</p>\n</blockquote>\n<h5 id=\"step1解密函数内存写入\"><a class=\"anchor\" href=\"#step1解密函数内存写入\">#</a> step1：解密函数内存写入</h5>\n<p>函数入口中的内容大部分都是由解密函数生成的，那么我们首先要做的就是将解密函数写入内存中。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 定义解密数组名称，与原函数对其</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">let</span> descrypt_arr_name <span class=\"token operator\">=</span> <span class=\"token string\">'$b'</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">let</span> descrypt_strfun_js <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;=</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// 加入代码</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    descrypt_strfun_js <span class=\"token operator\">+=</span> <span class=\"token function\">generator</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">.</span>program<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>compact<span class=\"token operator\">:</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>code</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">delete</span> ast_code<span class=\"token punctuation\">.</span>program<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// 写入内存</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>descrypt_strfun_js<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">// 此时就可以打印出结果</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>$b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"step2解密函数还原\"><a class=\"anchor\" href=\"#step2解密函数还原\">#</a> step2：解密函数还原</h5>\n<p>在内存中包含解数组后，我们就只需要将每一个调用解密数组的地方替换即可，不过在此之前还需要对整体的 ASCII 码类型进行还原，同时若是数组调用类型为 a ['1'+'2'] 这种形式也需要先还原成 a ['12'] 这种形式。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> ASCII_visitor <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// 对 ASCII 码进行还原</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">StringLiteral</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>extra<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>extra <span class=\"token operator\">=</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function\">NumericLiteral</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>extra<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>extra <span class=\"token operator\">=</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token function\">BinaryExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">// 二项式计算，都为字符类型，则直接相加</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">let</span> left <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">let</span> right <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>right<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">let</span> operator <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>operator<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token comment\">// 字符串相加</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isStringLiteral</span><span class=\"token punctuation\">(</span>left<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> types<span class=\"token punctuation\">.</span><span class=\"token function\">isStringLiteral</span><span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> operator <span class=\"token operator\">===</span> <span class=\"token string\">'+'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token comment\">//path.evaluate () 为节点计算，自动相加里面的 value, 得出三个参数：confident:true 为可相加，deopt: 暂时不清楚，value: 加后的值</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>value<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">,</span> ASCII_visitor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>arr_change_visitor <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token comment\">// 解密数组还原</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token function\">CallExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token comment\">// 调用数组名字与数组函数相同</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>name  <span class=\"token operator\">===</span> descrypt_arr_name <span class=\"token operator\">&amp;&amp;</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">valueToNode</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">,</span> arr_change_visitor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"step3对象置换与写入\"><a class=\"anchor\" href=\"#step3对象置换与写入\">#</a> step3：对象置换与写入</h5>\n<p>接下来就发现，存在对象声明以及对象写入，以如下形式表现：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>a<span class=\"token punctuation\">[</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'1'</span> <span class=\"token operator\">+</span> <span class=\"token string\">'2'</span> <span class=\"token operator\">+</span> <span class=\"token string\">'3'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>a<span class=\"token punctuation\">[</span><span class=\"token string\">'213'</span> <span class=\"token operator\">+</span> <span class=\"token string\">'231'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span>b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这里沿用上述思想，也将对象写入内存中，然后直接替换，由于 '1'+'2'+‘3 类似这种需要采用上述 ASCII_visitor 进一步还原，是为了防</p>\n<p>存入内存后，部分函数无法还原。同时，在此基础上还需要加上变量替换、无效代码去除的操作。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 变量替换</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>fun_use_visitor <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">const</span> func_name <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">let</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>binding<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">let</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span>init<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> _path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">isIdentifier</span><span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span>name<span class=\"token operator\">:</span>func_name<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            _path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">rename</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">// 无效代码去除</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>dead_visitor <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span>id<span class=\"token punctuation\">,</span>init<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>init<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> init<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">,</span> fun_use_visitor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;=</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">,</span> ASCII_visitor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">// 对象内存写入，y1 对应的解密函数的实际值，方便后续观察读写中哪里存在问题</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>y1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>memeory_visitor <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token function\">VariableDeclarator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>init <span class=\"token operator\">&amp;&amp;</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>init<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'ObjectExpression'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">const</span> func_name <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token comment\">// 打印当前变量名称'</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token comment\">// 对象内存替换，保证内存中的对象键值为 node 类型、</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>temp <span class=\"token keyword\">of</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>init<span class=\"token punctuation\">.</span>properties<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token keyword\">let</span> key <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token keyword\">let</span> binding <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">getBinding</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>binding<span class=\"token punctuation\">.</span>scope<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>            <span class=\"token function\">AssignmentExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                <span class=\"token comment\">// 筛选需要的对象。判断是否为对象类型</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">.</span>type  <span class=\"token operator\">!==</span> <span class=\"token string\">'MemberExpression'</span> <span class=\"token operator\">||</span> _path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> func_name <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                 <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>right<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>                 y1<span class=\"token punctuation\">[</span>_path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> _path<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                _path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>            path<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token comment\">// 内部调用对象，将键值对去掉</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>second_visitor <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token function\">MemberExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        <span class=\"token comment\">// 对于值为字符类型的进行替换</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        cur_name <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>global<span class=\"token punctuation\">[</span>cur_name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token comment\">// 如果存在内存中</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>cur_name <span class=\"token operator\">&amp;&amp;</span> cur_name <span class=\"token keyword\">in</span> global<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>cur_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>cur_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>property <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>cur_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span><span class=\"token string\">'StringLiteral'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            <span class=\"token comment\">// 替换节点</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>            path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">stringLiteral</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>cur_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>cur_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'StringLiteral'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>                <span class=\"token comment\">// console.log(eval(cur_name)[path.node.property.value]);</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>                path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">stringLiteral</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>cur_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    <span class=\"token function\">CallExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>        <span class=\"token comment\">// 对值为函数类型的进行替换</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>type <span class=\"token operator\">!==</span> <span class=\"token string\">'MemberExpression'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token comment\">// 定义调用对象的名称</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        <span class=\"token keyword\">var</span> func_name <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        <span class=\"token comment\">// 只调用存在内存中的对象</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>global<span class=\"token punctuation\">[</span>func_name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>func_name <span class=\"token operator\">&amp;&amp;</span> func_name <span class=\"token keyword\">in</span> global <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'FunctionExpression'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'BinaryExpression'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>                <span class=\"token keyword\">const</span> operator <span class=\"token operator\">=</span> <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">.</span>operator<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>                <span class=\"token comment\">// console.log(path.node.arguments[0]);</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>                path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">binaryExpression</span><span class=\"token punctuation\">(</span>operator<span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'CallExpression'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>                <span class=\"token comment\">// console.log(eval(func_name)[path.node.callee.property.value].body.body[0].argument.arguments.length);</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>                    <span class=\"token comment\">// 内存函数替换，形如 a () 调用转换</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>                    <span class=\"token keyword\">var</span> temp_func <span class=\"token operator\">=</span> <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>                    temp_func<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>                    path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>                    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>                <span class=\"token keyword\">const</span> call_name <span class=\"token operator\">=</span> <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>call_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>                <span class=\"token keyword\">var</span> arr <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>                <span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> arr<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span> item<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!=</span> call_name<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>                <span class=\"token comment\">// 对参数进行切片，第一个为对应的函数名，其余的为参数</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>                path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">callExpression</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre></pre></td></tr><tr><td data-num=\"116\"></td><td><pre><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">,</span> memeory_visitor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">,</span> second_visitor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>third_visitor <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>    <span class=\"token function\">CallExpression</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>        <span class=\"token comment\">// 如果函数对应的部分也为函数调用式</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>        cur_node <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>cur_node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>        <span class=\"token keyword\">var</span> func_name <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>global<span class=\"token punctuation\">[</span>func_name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>            <span class=\"token comment\">// console.log(eval(func_name)[path.node.callee.property.value]);</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>body <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>func_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>argument<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'CallExpression'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>            <span class=\"token keyword\">const</span> arg <span class=\"token operator\">=</span> cur_node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>            path<span class=\"token punctuation\">.</span><span class=\"token function\">replaceInline</span><span class=\"token punctuation\">(</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">callExpression</span><span class=\"token punctuation\">(</span>cur_node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> arg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre></pre></td></tr><tr><td data-num=\"134\"></td><td><pre><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">,</span> third_visitor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre><span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>ast_code<span class=\"token punctuation\">,</span> dead_visitor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre><span class=\"token comment\">// 可判断对象内存写入是否存在问题。</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre><span class=\"token comment\">// console.log(y1);</span></pre></td></tr></table></figure><h5 id=\"step4扫尾工作\"><a class=\"anchor\" href=\"#step4扫尾工作\">#</a> step4：扫尾工作</h5>\n<p>经过上述步骤，代码已经压缩成了 240 行，代码 (如下) 的逻辑已经清晰可见，控制流也不是很复杂，暂时没必要用到还原，其中有个 BUG 处：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">$c</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">k</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">var</span> <span class=\"token function-variable function\">B</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">Y</span> <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token keyword\">var</span> a1 <span class=\"token operator\">=</span> <span class=\"token constant\">Y</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>          <span class=\"token keyword\">var</span> a2 <span class=\"token operator\">=</span> a0<span class=\"token punctuation\">[</span><span class=\"token string\">\"apply\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>          a0 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>          <span class=\"token keyword\">return</span> a2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token constant\">Y</span> <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token keyword\">return</span> a1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">var</span> a0 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">65535</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">65535</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span> <span class=\"token operator\">>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>a0 <span class=\"token operator\">>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">16</span> <span class=\"token operator\">|</span> <span class=\"token number\">65535</span> <span class=\"token operator\">&amp;</span> a0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">D</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">Y</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">|</span> <span class=\"token constant\">Y</span> <span class=\"token operator\">>>></span> <span class=\"token number\">32</span> <span class=\"token operator\">-</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">E</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span><span class=\"token constant\">D</span><span class=\"token punctuation\">(</span><span class=\"token constant\">C</span><span class=\"token punctuation\">(</span><span class=\"token constant\">C</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">E</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">&amp;</span> a0 <span class=\"token operator\">|</span> <span class=\"token operator\">~</span><span class=\"token constant\">Z</span> <span class=\"token operator\">&amp;</span> a1<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">E</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">&amp;</span> a1 <span class=\"token operator\">|</span> a0 <span class=\"token operator\">&amp;</span> <span class=\"token operator\">~</span>a1<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">H</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">let</span> a0 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">let</span> a1 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> a2 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a2 <span class=\"token operator\">&lt;</span> a0<span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> a2<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>      a1 <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">[</span><span class=\"token string\">\"fromCharCode\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>a0<span class=\"token punctuation\">[</span>a2<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">return</span> a1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">E</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">^</span> a0 <span class=\"token operator\">^</span> a1<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">E</span><span class=\"token punctuation\">(</span>a0 <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">|</span> <span class=\"token operator\">~</span>a1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">K</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">H</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">L</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">let</span> a0 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> a1 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a1 <span class=\"token operator\">&lt;</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> a1<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>      a0 <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">[</span><span class=\"token string\">\"fromCharCode\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token keyword\">return</span> a0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">M</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    <span class=\"token keyword\">var</span> a0 <span class=\"token operator\">=</span> <span class=\"token string\">\"6|1|2|5|0|4|3\"</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"split\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"|\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token keyword\">var</span> a1 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>      <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>a0<span class=\"token punctuation\">[</span>a1<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"0\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>          qz <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">119</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">98</span><span class=\"token punctuation\">,</span> <span class=\"token number\">106</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">102</span><span class=\"token punctuation\">,</span> <span class=\"token number\">117</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">119</span><span class=\"token punctuation\">,</span> <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">102</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">59</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">59</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">112</span><span class=\"token punctuation\">,</span> <span class=\"token number\">117</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">91</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">98</span><span class=\"token punctuation\">,</span> <span class=\"token number\">106</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">98</span><span class=\"token punctuation\">,</span> <span class=\"token number\">106</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">93</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">402</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">91</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">118</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">93</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>          <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"1\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>          <span class=\"token keyword\">var</span> a2 <span class=\"token operator\">=</span> <span class=\"token constant\">B</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>            <span class=\"token keyword\">var</span> <span class=\"token function-variable function\">a5</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>              <span class=\"token keyword\">var</span> a6 <span class=\"token operator\">=</span> a5<span class=\"token punctuation\">[</span><span class=\"token string\">\"constructor\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ZKLFz\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"compile\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"^([^ ]+( +[^ ]+)+)+[^ ]&#125;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>              <span class=\"token keyword\">return</span> <span class=\"token operator\">!</span>a6<span class=\"token punctuation\">[</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>a2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token function\">a5</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>          <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"2\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>          <span class=\"token function\">a2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>          <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"3\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>          <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>global<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>              console<span class=\"token punctuation\">[</span><span class=\"token string\">\"log\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\u4EBA\\u751F\\u82E6\\u77ED\\uFF0C\\u4F55\\u5FC5python\\uFF1F\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>              <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>                console<span class=\"token punctuation\">[</span><span class=\"token string\">\"log\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\u4EBA\\u751F\\u82E6\\u77ED\\uFF0C\\u4F55\\u5FC5python\\uFF1F\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>                <span class=\"token keyword\">debugger</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>              <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>            <span class=\"token keyword\">return</span> navigator<span class=\"token punctuation\">[</span><span class=\"token string\">\"vendorSub\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>          <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"4\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>          <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token constant\">L</span><span class=\"token punctuation\">(</span>qz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>          <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"5\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>          <span class=\"token constant\">K</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>          <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"6\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>          <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>  <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token constant\">M</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">N</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>    <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token constant\">Z</span> <span class=\"token operator\">>></span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|=</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">%</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token number\">14</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">+</span> <span class=\"token number\">64</span> <span class=\"token operator\">>>></span> <span class=\"token number\">9</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>qz<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>      <span class=\"token keyword\">var</span> a0<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>          a1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>          a2<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>          a3<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>          a4<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>          a5 <span class=\"token operator\">=</span> <span class=\"token number\">1732584193</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>          a6 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">271733879</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>          a7 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1732584194</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>          a8 <span class=\"token operator\">=</span> <span class=\"token number\">271733878</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>      <span class=\"token keyword\">var</span> a0<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>          a1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>          a2<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>          a3<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>          a4<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>          a5 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>          a6 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>          a7 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>          a8 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>a0 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a0 <span class=\"token operator\">&lt;</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> a0 <span class=\"token operator\">+=</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> a1 <span class=\"token operator\">=</span> a5<span class=\"token punctuation\">,</span> a2 <span class=\"token operator\">=</span> a6<span class=\"token punctuation\">,</span> a3 <span class=\"token operator\">=</span> a7<span class=\"token punctuation\">,</span> a4 <span class=\"token operator\">=</span> a8<span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">680876936</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">389564586</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">606105819</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1044525330</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">176418897</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1200080426</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1473231341</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">45705983</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1770010416</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1958414417</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">42063</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1990404162</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1804603682</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40341101</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1502882290</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1236535329</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">165796510</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1069501632</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">643717713</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">373897302</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">701558691</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">38016083</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">660478335</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">405537848</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">568446438</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1019803690</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">187363961</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1163531501</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1444681467</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">51403784</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1735328473</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1926607734</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">378558</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2022574463</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1839030562</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">35309556</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1530992060</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1272893353</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">155497632</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1094730640</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">681279174</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">358537222</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">722521979</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">76029189</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">640364487</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">421815835</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">530742520</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">995338651</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">198630844</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1126891415</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1416354905</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">57434055</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1700485571</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1894986606</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1051523</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2054922799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1873313359</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">30611744</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1560198380</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1309151649</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">145523070</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1120210379</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">718787259</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">343485441</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>        a0 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>        a1 <span class=\"token operator\">=</span> <span class=\"token number\">32</span> <span class=\"token operator\">*</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">&lt;</span> a1<span class=\"token punctuation\">;</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">+=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> a0 <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">[</span><span class=\"token string\">\"fromCharCode\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token constant\">Z</span> <span class=\"token operator\">>></span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>>></span> <span class=\"token constant\">Z</span> <span class=\"token operator\">%</span> <span class=\"token number\">32</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>    <span class=\"token keyword\">return</span> a0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">P</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"0|1|4|2|3\"</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"split\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"|\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>    <span class=\"token keyword\">var</span> a0 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>      <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">[</span>a0<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"0\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>          <span class=\"token keyword\">var</span> a1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>              a2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>          <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"1\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>          <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>a2<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">void</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> a1 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a1 <span class=\"token operator\">&lt;</span> a2<span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> a1 <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> a2<span class=\"token punctuation\">[</span>a1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre></pre></td></tr><tr><td data-num=\"188\"></td><td><pre>          <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"2\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>          <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>a1 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a1 <span class=\"token operator\">&lt;</span> a3<span class=\"token punctuation\">;</span> a1 <span class=\"token operator\">+=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> a2<span class=\"token punctuation\">[</span>a1 <span class=\"token operator\">>></span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">255</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"charCodeAt\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>a1 <span class=\"token operator\">/</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> a1 <span class=\"token operator\">%</span> <span class=\"token number\">32</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>          <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"3\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>          <span class=\"token keyword\">return</span> a2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token string\">\"4\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>          <span class=\"token keyword\">var</span> a3 <span class=\"token operator\">=</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>          <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">Q</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">(</span><span class=\"token constant\">N</span><span class=\"token punctuation\">(</span><span class=\"token constant\">P</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"209\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre></pre></td></tr><tr><td data-num=\"211\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">R</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre>        a0<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre>        a1 <span class=\"token operator\">=</span> <span class=\"token string\">\"0123456789abcdef\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>        a2 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>a0 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a0 <span class=\"token operator\">&lt;</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> a0 <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">=</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"charCodeAt\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>a0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a2 <span class=\"token operator\">+=</span> a1<span class=\"token punctuation\">[</span><span class=\"token string\">\"charAt\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">>>></span> <span class=\"token number\">4</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token string\">\"charAt\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>    <span class=\"token keyword\">return</span> a2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">S</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token function\">unescape</span><span class=\"token punctuation\">(</span><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"225\"></td><td><pre></pre></td></tr><tr><td data-num=\"226\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"227\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">Q</span><span class=\"token punctuation\">(</span><span class=\"token constant\">S</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"229\"></td><td><pre></pre></td></tr><tr><td data-num=\"230\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">U</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"231\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">R</span><span class=\"token punctuation\">(</span><span class=\"token constant\">T</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"232\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"233\"></td><td><pre></pre></td></tr><tr><td data-num=\"234\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">V</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"235\"></td><td><pre>    <span class=\"token constant\">M</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"236\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">?</span> a0 <span class=\"token operator\">?</span> <span class=\"token constant\">H</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> a0 <span class=\"token operator\">?</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token constant\">U</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"237\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"238\"></td><td><pre></pre></td></tr><tr><td data-num=\"239\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">W</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"240\"></td><td><pre>    document<span class=\"token punctuation\">[</span><span class=\"token string\">\"cookie\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"m\"</span> <span class=\"token operator\">+</span> <span class=\"token constant\">M</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"=\"</span> <span class=\"token operator\">+</span> <span class=\"token constant\">V</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> <span class=\"token constant\">Y</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"; path=/\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"241\"></td><td><pre>    location<span class=\"token punctuation\">[</span><span class=\"token string\">\"reload\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"242\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre></pre></td></tr><tr><td data-num=\"244\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token constant\">X</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"245\"></td><td><pre>    <span class=\"token keyword\">return</span> Date<span class=\"token punctuation\">[</span><span class=\"token string\">\"parse\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"246\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"247\"></td><td><pre></pre></td></tr><tr><td data-num=\"248\"></td><td><pre>  <span class=\"token constant\">W</span><span class=\"token punctuation\">(</span><span class=\"token constant\">X</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"249\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>PS: 运行会报 ZKLFz 处的错误，可能是由于对 'y [&quot;ZKLFz&quot;] = &quot;return /\\&quot; + this + \\&quot;/&quot;' 这个还原的时候出现了一点小问题，通过分析该处代码，很明显这里是在对什么东西进行一个检测，然后返回的一个是 boolean 型变量，将代码修改即可结束。</p>\n</blockquote>\n<p>最后将其中的环境检测补掉，最后即破解结束。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 修改后完整代码如下</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 提取 hook 一个 console.log;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>console_hk <span class=\"token operator\">=</span> console<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">B</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">Y</span> <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">var</span> a1 <span class=\"token operator\">=</span> <span class=\"token constant\">Y</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token keyword\">var</span> a2 <span class=\"token operator\">=</span> a0<span class=\"token punctuation\">[</span><span class=\"token string\">\"apply\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                a0 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token keyword\">return</span> a2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token constant\">Y</span> <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">return</span> a1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">var</span> a0 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">65535</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">65535</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span> <span class=\"token operator\">>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>a0 <span class=\"token operator\">>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">16</span> <span class=\"token operator\">|</span> <span class=\"token number\">65535</span> <span class=\"token operator\">&amp;</span> a0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">D</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">Y</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">|</span> <span class=\"token constant\">Y</span> <span class=\"token operator\">>>></span> <span class=\"token number\">32</span> <span class=\"token operator\">-</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">E</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span><span class=\"token constant\">D</span><span class=\"token punctuation\">(</span><span class=\"token constant\">C</span><span class=\"token punctuation\">(</span><span class=\"token constant\">C</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">E</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">&amp;</span> a0 <span class=\"token operator\">|</span> <span class=\"token operator\">~</span><span class=\"token constant\">Z</span> <span class=\"token operator\">&amp;</span> a1<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">E</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">&amp;</span> a1 <span class=\"token operator\">|</span> a0 <span class=\"token operator\">&amp;</span> <span class=\"token operator\">~</span>a1<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">H</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">let</span> a0 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">let</span> a1 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> a2 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a2 <span class=\"token operator\">&lt;</span> a0<span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> a2<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        a1 <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">[</span><span class=\"token string\">\"fromCharCode\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>a0<span class=\"token punctuation\">[</span>a2<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">return</span> a1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">E</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">^</span> a0 <span class=\"token operator\">^</span> a1<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">E</span><span class=\"token punctuation\">(</span>a0 <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">|</span> <span class=\"token operator\">~</span>a1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">,</span> a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">K</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">H</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">L</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token keyword\">let</span> a0 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> a1 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a1 <span class=\"token operator\">&lt;</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> a1<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>        a0 <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">[</span><span class=\"token string\">\"fromCharCode\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    <span class=\"token keyword\">return</span> a0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">M</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token keyword\">var</span> a0 <span class=\"token operator\">=</span> <span class=\"token string\">\"6|1|2|5|0|4|3\"</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"split\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"|\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token keyword\">var</span> a1 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>a0<span class=\"token punctuation\">[</span>a1<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"0\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>                qz <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">119</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">98</span><span class=\"token punctuation\">,</span> <span class=\"token number\">106</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">102</span><span class=\"token punctuation\">,</span> <span class=\"token number\">117</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">119</span><span class=\"token punctuation\">,</span> <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">102</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">59</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">59</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">112</span><span class=\"token punctuation\">,</span> <span class=\"token number\">117</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">91</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">98</span><span class=\"token punctuation\">,</span> <span class=\"token number\">106</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">98</span><span class=\"token punctuation\">,</span> <span class=\"token number\">106</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">93</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">402</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">91</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">118</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">93</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"1\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>                <span class=\"token keyword\">var</span> a2 <span class=\"token operator\">=</span> <span class=\"token constant\">B</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>                    <span class=\"token keyword\">var</span> <span class=\"token function-variable function\">a5</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>                        <span class=\"token comment\">//var a6 = a5[\"constructor\"](\"ZKLFz\")()[\"compile\"](\"^([^ ]+( +[^ ]+)+)+[^ ]&#125;\");</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>\t\t\t\t\t\t<span class=\"token comment\">//return !a6 [\"test\"](a2); 浏览器里为 true 直接替换</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>                        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>                    <span class=\"token keyword\">return</span> <span class=\"token function\">a5</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"2\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>                <span class=\"token function\">a2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"3\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>                <span class=\"token comment\">// 去掉无线 debugger;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>                <span class=\"token comment\">// try &#123;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>                <span class=\"token comment\">// 这里对 node 的 global 进行了一个检测</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>                <span class=\"token comment\">//     if (global) &#123;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>                <span class=\"token comment\">//         console[\"log\"](\"\\u4EBA\\u751F\\u82E6\\u77ED\\uFF0C\\u4F55\\u5FC5python\\uFF1F\");</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>                <span class=\"token comment\">//     &#125; else &#123;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>                <span class=\"token comment\">//         while (1) &#123;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>                <span class=\"token comment\">//             console[\"log\"](\"\\u4EBA\\u751F\\u82E6\\u77ED\\uFF0C\\u4F55\\u5FC5python\\uFF1F\");</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>                <span class=\"token comment\">//             debugger;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>                <span class=\"token comment\">//         &#125;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>                <span class=\"token comment\">//     &#125;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>                <span class=\"token comment\">// &#125; catch (a5) &#123;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>                <span class=\"token comment\">//     return navigator[\"vendorSub\"];</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>                <span class=\"token comment\">// &#125;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>                <span class=\"token comment\">//navigator [\"vendorSub\"] 这个在浏览器里面就为 '' 所以直接返回这个。</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>                    <span class=\"token keyword\">return</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"4\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>                <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token constant\">L</span><span class=\"token punctuation\">(</span>qz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"5\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>                <span class=\"token constant\">K</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"6\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>                <span class=\"token keyword\">var</span> a3 <span class=\"token operator\">=</span> a3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre></pre></td></tr><tr><td data-num=\"140\"></td><td><pre><span class=\"token comment\">// setInterval(M(), 500);</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre></pre></td></tr><tr><td data-num=\"142\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">N</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>    <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token constant\">Z</span> <span class=\"token operator\">>></span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|=</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">%</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token number\">14</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">+</span> <span class=\"token number\">64</span> <span class=\"token operator\">>>></span> <span class=\"token number\">9</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>qz<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>        <span class=\"token keyword\">var</span> a0<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>            a1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>            a2<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>            a3<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>            a4<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>            a5 <span class=\"token operator\">=</span> <span class=\"token number\">1732584193</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>            a6 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">271733879</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>            a7 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1732584194</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>            a8 <span class=\"token operator\">=</span> <span class=\"token number\">271733878</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>        <span class=\"token keyword\">var</span> a0<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>            a1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>            a2<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>            a3<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>            a4<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>            a5 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>            a6 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>            a7 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>            a8 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>a0 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a0 <span class=\"token operator\">&lt;</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> a0 <span class=\"token operator\">+=</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> a1 <span class=\"token operator\">=</span> a5<span class=\"token punctuation\">,</span> a2 <span class=\"token operator\">=</span> a6<span class=\"token punctuation\">,</span> a3 <span class=\"token operator\">=</span> a7<span class=\"token punctuation\">,</span> a4 <span class=\"token operator\">=</span> a8<span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">680876936</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">389564586</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">606105819</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1044525330</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">176418897</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1200080426</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1473231341</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">45705983</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1770010416</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1958414417</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">42063</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1990404162</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1804603682</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40341101</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1502882290</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1236535329</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">165796510</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1069501632</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">643717713</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">373897302</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">701558691</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">38016083</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">660478335</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">405537848</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">568446438</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1019803690</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">187363961</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1163531501</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1444681467</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">51403784</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1735328473</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">G</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1926607734</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">378558</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2022574463</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1839030562</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">35309556</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1530992060</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1272893353</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">155497632</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1094730640</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">681279174</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">358537222</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">722521979</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">76029189</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">640364487</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">421815835</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">530742520</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">I</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">995338651</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">198630844</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1126891415</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1416354905</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">57434055</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1700485571</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1894986606</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1051523</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2054922799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1873313359</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">30611744</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1560198380</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1309151649</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">145523070</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1120210379</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">718787259</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">J</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">,</span> a5<span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span>a0 <span class=\"token operator\">+</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">343485441</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a5 <span class=\"token operator\">=</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span>a5<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a6 <span class=\"token operator\">=</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span>a6<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a7 <span class=\"token operator\">=</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span>a7<span class=\"token punctuation\">,</span> a3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a8 <span class=\"token operator\">=</span> <span class=\"token constant\">C</span><span class=\"token punctuation\">(</span>a8<span class=\"token punctuation\">,</span> a4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>a5<span class=\"token punctuation\">,</span> a6<span class=\"token punctuation\">,</span> a7<span class=\"token punctuation\">,</span> a8<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre></pre></td></tr><tr><td data-num=\"172\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>        a0 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>        a1 <span class=\"token operator\">=</span> <span class=\"token number\">32</span> <span class=\"token operator\">*</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">&lt;</span> a1<span class=\"token punctuation\">;</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">+=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> a0 <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">[</span><span class=\"token string\">\"fromCharCode\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token constant\">Z</span> <span class=\"token operator\">>></span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>>></span> <span class=\"token constant\">Z</span> <span class=\"token operator\">%</span> <span class=\"token number\">32</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>    <span class=\"token keyword\">return</span> a0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre></pre></td></tr><tr><td data-num=\"182\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">P</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"0|1|4|2|3\"</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"split\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"|\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>    <span class=\"token keyword\">var</span> a0 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">[</span>a0<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"0\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>                <span class=\"token keyword\">var</span> a1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>                    a2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"1\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>a2<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">void</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> a1 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a1 <span class=\"token operator\">&lt;</span> a2<span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> a1 <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> a2<span class=\"token punctuation\">[</span>a1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"2\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>a1 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a1 <span class=\"token operator\">&lt;</span> a3<span class=\"token punctuation\">;</span> a1 <span class=\"token operator\">+=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> a2<span class=\"token punctuation\">[</span>a1 <span class=\"token operator\">>></span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">255</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"charCodeAt\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>a1 <span class=\"token operator\">/</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> a1 <span class=\"token operator\">%</span> <span class=\"token number\">32</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"3\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>                <span class=\"token keyword\">return</span> a2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre></pre></td></tr><tr><td data-num=\"206\"></td><td><pre>            <span class=\"token keyword\">case</span> <span class=\"token string\">\"4\"</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>                <span class=\"token keyword\">var</span> a3 <span class=\"token operator\">=</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"209\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre></pre></td></tr><tr><td data-num=\"211\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre></pre></td></tr><tr><td data-num=\"215\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">Q</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">(</span><span class=\"token constant\">N</span><span class=\"token punctuation\">(</span><span class=\"token constant\">P</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre></pre></td></tr><tr><td data-num=\"219\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">R</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre>    <span class=\"token keyword\">var</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre>        a0<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>        a1 <span class=\"token operator\">=</span> <span class=\"token string\">\"0123456789abcdef\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>        a2 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre></pre></td></tr><tr><td data-num=\"225\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>a0 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> a0 <span class=\"token operator\">&lt;</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"length\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> a0 <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">=</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"charCodeAt\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>a0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> a2 <span class=\"token operator\">+=</span> a1<span class=\"token punctuation\">[</span><span class=\"token string\">\"charAt\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span> <span class=\"token operator\">>>></span> <span class=\"token number\">4</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token string\">\"charAt\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"226\"></td><td><pre></pre></td></tr><tr><td data-num=\"227\"></td><td><pre>    <span class=\"token keyword\">return</span> a2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"229\"></td><td><pre></pre></td></tr><tr><td data-num=\"230\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">S</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"231\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token function\">unescape</span><span class=\"token punctuation\">(</span><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"232\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"233\"></td><td><pre></pre></td></tr><tr><td data-num=\"234\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"235\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">Q</span><span class=\"token punctuation\">(</span><span class=\"token constant\">S</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"236\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"237\"></td><td><pre></pre></td></tr><tr><td data-num=\"238\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">U</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"239\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">R</span><span class=\"token punctuation\">(</span><span class=\"token constant\">T</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"240\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"241\"></td><td><pre></pre></td></tr><tr><td data-num=\"242\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">V</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> a0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre>    <span class=\"token constant\">M</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"244\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">?</span> a0 <span class=\"token operator\">?</span> <span class=\"token constant\">H</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Z</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> a0 <span class=\"token operator\">?</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token constant\">U</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"245\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"246\"></td><td><pre></pre></td></tr><tr><td data-num=\"247\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">W</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"248\"></td><td><pre>    <span class=\"token keyword\">var</span> cookie <span class=\"token operator\">=</span> <span class=\"token string\">\"m\"</span> <span class=\"token operator\">+</span> <span class=\"token constant\">M</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"=\"</span> <span class=\"token operator\">+</span> <span class=\"token constant\">V</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Y</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> <span class=\"token constant\">Y</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"; path=/\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"249\"></td><td><pre>    <span class=\"token function\">console_hk</span><span class=\"token punctuation\">(</span>cookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"250\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"251\"></td><td><pre></pre></td></tr><tr><td data-num=\"252\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token constant\">X</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">Y</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Z</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"253\"></td><td><pre>    <span class=\"token keyword\">return</span> Date<span class=\"token punctuation\">[</span><span class=\"token string\">\"parse\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"254\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"255\"></td><td><pre></pre></td></tr><tr><td data-num=\"256\"></td><td><pre><span class=\"token constant\">W</span><span class=\"token punctuation\">(</span><span class=\"token constant\">X</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>补充：上述只是对简单的 ob 进行了一个还原，由于其控制流不是很复杂，所以没必要进一步还原控制流，同时，在解密函数这部分，有的是解密数组，有的是解密函数，灵活变通即可。</p>\n</blockquote>\n<h3 id=\"实战\"><a class=\"anchor\" href=\"#实战\">#</a> 实战</h3>\n<h4 id=\"某验\"><a class=\"anchor\" href=\"#某验\">#</a> 某验</h4>\n<h5 id=\"代码分析\"><a class=\"anchor\" href=\"#代码分析\">#</a> 代码分析</h5>\n<p>受害者地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ2VldGVzdC5jb20vZGVtby9zbGlkZS1iaW5kLmh0bWw=\">https://www.geetest.com/demo/slide-bind.html</span></p>\n<p>将代码放入在线网站解析，我们可以</p>\n",
            "tags": [
                "ast"
            ]
        },
        {
            "id": "http://yida506.github.io/2021/11/14/js%E9%80%86%E5%90%91/",
            "url": "http://yida506.github.io/2021/11/14/js%E9%80%86%E5%90%91/",
            "title": "js逆向",
            "date_published": "2021-11-14T06:00:27.000Z",
            "content_html": "<h4 id=\"1xhr请求\"><a class=\"anchor\" href=\"#1xhr请求\">#</a> 1.XHR 请求</h4>\n<p>在理解逆向时，首先要明白数据是如何产生的，现在大部分数据都采用异步加载的方式，也有少量数据直接写在网页上，直接在网页上的静态数据在此不做阐述。</p>\n<p>以目前的情况来看，我们想要获得的数据主要都是异步产生的，异步与同步的差别主要在于，同步需要执行完所有的过程数据才显示，异步就是可以中途显示数据，要使中途显示数据有很多种方法，例如和函数绑定，这样就可以实现翻页，页面的数据改变。</p>\n<p>在类似翻页过程中，我们实际上是用鼠标点击了页面页码、下一页等操作，该位置通常绑定了 click 事件，这样我们在点击时，就会运行 click 函数， 然后向服务器传递了请求，服务器给我们返回了对应的数据。</p>\n<figure class=\"highlight flow\"><figcaption data-lang=\"flow\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>startID<span class=\"token operator\">=></span>start<span class=\"token operator\">:</span> <span class=\"token function\">点击事件</span><span class=\"token punctuation\">(</span>携带参数<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>operation1<span class=\"token operator\">=></span>operation<span class=\"token operator\">:</span> 回调函数</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>operation2<span class=\"token operator\">=></span>operation<span class=\"token operator\">:</span> 调用ajax</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>operation3<span class=\"token operator\">=></span>operation<span class=\"token operator\">:</span> 返回数据</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>endID<span class=\"token operator\">=></span>end<span class=\"token operator\">:</span> 浏览器渲染数据</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>startID<span class=\"token operator\">-</span><span class=\"token operator\">></span>operation1<span class=\"token operator\">-</span><span class=\"token operator\">></span>operation2<span class=\"token operator\">-</span><span class=\"token operator\">></span>operation3<span class=\"token operator\">-</span><span class=\"token operator\">></span>endID</pre></td></tr></table></figure><p>从实际来看，我们从点击翻页到页面数据渲染只发生了取值，发送，返回，渲染四大步骤。</p>\n<h5 id=\"2反爬\"><a class=\"anchor\" href=\"#2反爬\">#</a> 2. 反爬</h5>\n<p>而所谓的反爬，就是在上述 XHR 请求的各个流程中添加措施，从而达到反爬虫的作用。</p>\n<p>而反爬可以具体分为如下几种：</p>\n<ul>\n<li>参数加密</li>\n</ul>\n<h6 id=\"1参数加密\"><a class=\"anchor\" href=\"#1参数加密\">#</a> 1. 参数加密</h6>\n<p>我们知道，在与服务器交互的过程中，交互的过程实际上就是参数传递的过程，比如，我们可以把一开始携带的页码，在上传到服务器前，对其进行加密，同时在服务端根据其上传的参数进行校验，这样就达到了参数加密的效果。</p>\n<h6 id=\"2字体加密\"><a class=\"anchor\" href=\"#2字体加密\">#</a> 2. 字体加密</h6>\n<p>CSS 加密：所谓 css 加密就是给与一个字体字典，然后在浏览器渲染数据之前，用给定的字典对于返回的数据包解码，这样即可以保证用户看得到实际的数据，爬虫获取的数据是为解码的。而 CSS 加密按照其类别又可以分为静态 CSS 加密、动态 CSS 加密。</p>\n<p>静态 CSS 加密：对于静态 CSS 加密，往往可以忽略加载的字体文件，因为它里面的内容是一一对应的，我们可以手动构建字典，然后达到还原的目的。</p>\n<p>动态 CSS 加密：对于动态 CSS 加密，我们发现每次加载的字体文件都不一样，但是返回的参数却是一样的，那么我们就需要进入到字体文件里面进行分析。</p>\n<p>font 文件解析：</p>\n<ul>\n<li>&lt;GlyphOrder&gt;  待解析的序号和 unicode 编码</li>\n<li>&lt;TTGLyph&gt; unicode 编码解析后的图片</li>\n<li>&lt;cmap&gt; unicode 编码和 ASCII 码的映射表</li>\n</ul>\n<p>总结：对于字体加密类型，首先就是需要将其字体文件下下来，然后根据其中的内容，以及网页返回的内容判断其属于静态还是动态，针对静态的，若混销量不大，可考虑手动建立字典的方式还原，若为动态的，就需要对其字体文件进行分析，然后构建自动化还原表，以达到还原的目的。</p>\n<p>雪碧图加密：</p>\n<p>雪碧图加密是以图的形式对文件进行上传，然后再根据顺序调用的原理，将其渲染到页面上，以达到降低开销的目的。</p>\n<h6 id=\"hook\"><a class=\"anchor\" href=\"#hook\">#</a> HOOK</h6>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>document<span class=\"token punctuation\">.</span>cookie_bk <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>cookie<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Object<span class=\"token punctuation\">.</span><span class=\"token function\">defineProperty</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">,</span><span class=\"token string\">'cookie'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function-variable function\">get</span><span class=\"token operator\">:</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    \t<span class=\"token keyword\">debugger</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    \t<span class=\"token keyword\">return</span> document<span class=\"token punctuation\">.</span>cookie_bk</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "http://yida506.github.io/2021/09/02/Feadper/",
            "url": "http://yida506.github.io/2021/09/02/Feadper/",
            "title": "Feapder",
            "date_published": "2021-09-02T15:19:36.000Z",
            "content_html": "<h2 id=\"源码解读\"><a class=\"anchor\" href=\"#源码解读\">#</a> 源码解读</h2>\n<h3 id=\"spider\"><a class=\"anchor\" href=\"#spider\">#</a> Spider</h3>\n<p>分布式爬虫</p>\n<p>Spider 继承 BaseParser, Scheduler</p>\n<h4 id=\"运行流程\"><a class=\"anchor\" href=\"#运行流程\">#</a> 运行流程</h4>\n<ol>\n<li>初始化 Spider (传入 rediskey), 此时会初始化 Spider 中的参数，以及 Scheduler 中的参数，调用多线程中的 start 方法</li>\n<li>在 start 方法中，将当前 Spider 对象存入 self._parsers 中，然后调用 Scheduler 中的_start 方法</li>\n<li>在_start 方法中，调用初始化后的 request_buffer,item_buffer,collector 的 start 方法</li>\n<li>接着根据线程数及进程数，开启多个 parser_control (主要是处理 collector)</li>\n</ol>\n<h4 id=\"spider内置方法\"><a class=\"anchor\" href=\"#spider内置方法\">#</a> Spider 内置方法</h4>\n<h6 id=\"方法\"><a class=\"anchor\" href=\"#方法\">#</a> 方法</h6>\n<ul>\n<li>start_monitor_task 开始监控 常驻：主要涉及 redis 数量任务监控以及下发任务</li>\n<li>distribute_task 分发任务，由于继承了 Scheduler, 所以会初始化 parser 列表</li>\n<li>run 运行线程 然后调用 Scheduler 中的_start () 方法 启动 request_buffer,item_buffer,collector (均继承多线程，用 start () 常驻)</li>\n<li>parser_control</li>\n</ul>\n<h4 id=\"组件介绍\"><a class=\"anchor\" href=\"#组件介绍\">#</a> 组件介绍</h4>\n<h5 id=\"scheduler\"><a class=\"anchor\" href=\"#scheduler\">#</a> Scheduler</h5>\n<p><strong>调度器</strong></p>\n<blockquote>\n<p>决定爬虫的执行顺序，以及批次爬虫的调度逻辑</p>\n</blockquote>\n<h6 id=\"init\"><a class=\"anchor\" href=\"#init\">#</a> init</h6>\n<ul>\n<li>self._request_buffer 根据 redis_key 初始化的 request_buffer</li>\n<li>self._item_buffer 根据 redis_key 初始化的 item_buffer</li>\n<li>self._collector 根据 redis_key 初始化的 collector</li>\n<li>self._parsers 数组，用于存放 Spider 对象本身</li>\n<li>self._parser_controls 数组</li>\n<li>self._parser_control_obj  PaserControl 组件 (从 collector 中获取任务 处理 request)</li>\n</ul>\n<h5 id=\"request_buffer\"><a class=\"anchor\" href=\"#request_buffer\">#</a> request_buffer</h5>\n<ul>\n<li>init 初始化 requests 队列，del_requests 队列</li>\n<li>run: 只要未结束，就不断的往 redis 中添加任务</li>\n<li>__add_request_to_db: 将内存队列的中的任务添加至 redis 中</li>\n</ul>\n<h5 id=\"item_buffer\"><a class=\"anchor\" href=\"#item_buffer\">#</a> item_buffer</h5>\n<h5 id=\"collector\"><a class=\"anchor\" href=\"#collector\">#</a> collector</h5>\n<h5 id=\"request\"><a class=\"anchor\" href=\"#request\">#</a> Request</h5>\n<p>封装了 request<br>\n 缓存配置 (用于 debug 爬虫)</p>\n<h5 id=\"pasercontrol\"><a class=\"anchor\" href=\"#pasercontrol\">#</a> PaserControl</h5>\n<h6 id=\"run\"><a class=\"anchor\" href=\"#run\">#</a> run</h6>\n<p>从内存队列中取 request, 对其数量进行判断，然后处理中间件，获取返回后的结果</p>\n",
            "tags": []
        }
    ]
}